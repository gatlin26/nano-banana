(()=>{var a={};a.id=175,a.ids=[175],a.modules={261:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/app-paths")},846:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},3033:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3295:a=>{"use strict";a.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3578:(a,b,c)=>{"use strict";let d,e,f;c.r(b),c.d(b,{handler:()=>hZ,patchFetch:()=>hY,routeModule:()=>hU,serverHooks:()=>hX,workAsyncStorage:()=>hV,workUnitAsyncStorage:()=>hW});var g={};c.r(g),c.d(g,{POST:()=>hT});var h=c(6559),i=c(8088),j=c(7719),k=c(6191),l=c(1289),m=c(261),n=c(2603),o=c(9893),p=c(4823),q=c(7220),r=c(6946),s=c(7912),t=c(9786),u=c(6143),v=c(6439),w=c(3365),x=c(2190);let y=Symbol.for("drizzle:entityKind");function z(a,b){if(!a||"object"!=typeof a)return!1;if(a instanceof b)return!0;if(!Object.prototype.hasOwnProperty.call(b,y))throw Error(`Class "${b.name??"<unknown>"}" doesn't look like a Drizzle entity. If this is incorrect and the class is provided by Drizzle, please report this as a bug.`);let c=Object.getPrototypeOf(a).constructor;if(c)for(;c;){if(y in c&&c[y]===b[y])return!0;c=Object.getPrototypeOf(c)}return!1}Symbol.for("drizzle:hasOwnEntityKind");class A{static [y]="ColumnBuilder";config;constructor(a,b,c){this.config={name:a,keyAsName:""===a,notNull:!1,default:void 0,hasDefault:!1,primaryKey:!1,isUnique:!1,uniqueName:void 0,uniqueType:void 0,dataType:b,columnType:c,generated:void 0}}$type(){return this}notNull(){return this.config.notNull=!0,this}default(a){return this.config.default=a,this.config.hasDefault=!0,this}$defaultFn(a){return this.config.defaultFn=a,this.config.hasDefault=!0,this}$default=this.$defaultFn;$onUpdateFn(a){return this.config.onUpdateFn=a,this.config.hasDefault=!0,this}$onUpdate=this.$onUpdateFn;primaryKey(){return this.config.primaryKey=!0,this.config.notNull=!0,this}setName(a){""===this.config.name&&(this.config.name=a)}}class B{constructor(a,b){this.table=a,this.config=b,this.name=b.name,this.keyAsName=b.keyAsName,this.notNull=b.notNull,this.default=b.default,this.defaultFn=b.defaultFn,this.onUpdateFn=b.onUpdateFn,this.hasDefault=b.hasDefault,this.primary=b.primaryKey,this.isUnique=b.isUnique,this.uniqueName=b.uniqueName,this.uniqueType=b.uniqueType,this.dataType=b.dataType,this.columnType=b.columnType,this.generated=b.generated,this.generatedIdentity=b.generatedIdentity}static [y]="Column";name;keyAsName;primary;notNull;default;defaultFn;onUpdateFn;hasDefault;isUnique;uniqueName;uniqueType;dataType;columnType;enumValues=void 0;generated=void 0;generatedIdentity=void 0;config;mapFromDriverValue(a){return a}mapToDriverValue(a){return a}shouldDisableInsert(){return void 0!==this.config.generated&&"byDefault"!==this.config.generated.type}}let C=Symbol.for("drizzle:Name");class D{static [y]="PgForeignKeyBuilder";reference;_onUpdate="no action";_onDelete="no action";constructor(a,b){this.reference=()=>{let{name:b,columns:c,foreignColumns:d}=a();return{name:b,columns:c,foreignTable:d[0].table,foreignColumns:d}},b&&(this._onUpdate=b.onUpdate,this._onDelete=b.onDelete)}onUpdate(a){return this._onUpdate=void 0===a?"no action":a,this}onDelete(a){return this._onDelete=void 0===a?"no action":a,this}build(a){return new E(a,this)}}class E{constructor(a,b){this.table=a,this.reference=b.reference,this.onUpdate=b._onUpdate,this.onDelete=b._onDelete}static [y]="PgForeignKey";reference;onUpdate;onDelete;getName(){let{name:a,columns:b,foreignColumns:c}=this.reference(),d=b.map(a=>a.name),e=c.map(a=>a.name),f=[this.table[C],...d,c[0].table[C],...e];return a??`${f.join("_")}_fk`}}function F(a,...b){return a(...b)}function G(a,b){return`${a[C]}_${b.join("_")}_unique`}class H{constructor(a,b){this.name=b,this.columns=a}static [y]=null;columns;nullsNotDistinctConfig=!1;nullsNotDistinct(){return this.nullsNotDistinctConfig=!0,this}build(a){return new J(a,this.columns,this.nullsNotDistinctConfig,this.name)}}class I{static [y]=null;name;constructor(a){this.name=a}on(...a){return new H(a,this.name)}}class J{constructor(a,b,c,d){this.table=a,this.columns=b,this.name=d??G(this.table,this.columns.map(a=>a.name)),this.nullsNotDistinct=c}static [y]=null;columns;name;nullsNotDistinct=!1;getName(){return this.name}}function K(a,b,c){for(let d=b;d<a.length;d++){let e=a[d];if("\\"===e){d++;continue}if('"'===e)return[a.slice(b,d).replace(/\\/g,""),d+1];if(!c&&(","===e||"}"===e))return[a.slice(b,d).replace(/\\/g,""),d]}return[a.slice(b).replace(/\\/g,""),a.length]}class L extends A{foreignKeyConfigs=[];static [y]="PgColumnBuilder";array(a){return new P(this.config.name,this,a)}references(a,b={}){return this.foreignKeyConfigs.push({ref:a,actions:b}),this}unique(a,b){return this.config.isUnique=!0,this.config.uniqueName=a,this.config.uniqueType=b?.nulls,this}generatedAlwaysAs(a){return this.config.generated={as:a,type:"always",mode:"stored"},this}buildForeignKeys(a,b){return this.foreignKeyConfigs.map(({ref:c,actions:d})=>F((c,d)=>{let e=new D(()=>({columns:[a],foreignColumns:[c()]}));return d.onUpdate&&e.onUpdate(d.onUpdate),d.onDelete&&e.onDelete(d.onDelete),e.build(b)},c,d))}buildExtraConfigColumn(a){return new N(a,this.config)}}class M extends B{constructor(a,b){b.uniqueName||(b.uniqueName=G(a,[b.name])),super(a,b),this.table=a}static [y]="PgColumn"}class N extends M{static [y]="ExtraConfigColumn";getSQLType(){return this.getSQLType()}indexConfig={order:this.config.order??"asc",nulls:this.config.nulls??"last",opClass:this.config.opClass};defaultConfig={order:"asc",nulls:"last",opClass:void 0};asc(){return this.indexConfig.order="asc",this}desc(){return this.indexConfig.order="desc",this}nullsFirst(){return this.indexConfig.nulls="first",this}nullsLast(){return this.indexConfig.nulls="last",this}op(a){return this.indexConfig.opClass=a,this}}class O{static [y]=null;constructor(a,b,c,d){this.name=a,this.keyAsName=b,this.type=c,this.indexConfig=d}name;keyAsName;type;indexConfig}class P extends L{static [y]="PgArrayBuilder";constructor(a,b,c){super(a,"array","PgArray"),this.config.baseBuilder=b,this.config.size=c}build(a){let b=this.config.baseBuilder.build(a);return new Q(a,this.config,b)}}class Q extends M{constructor(a,b,c,d){super(a,b),this.baseColumn=c,this.range=d,this.size=b.size}size;static [y]="PgArray";getSQLType(){return`${this.baseColumn.getSQLType()}[${"number"==typeof this.size?this.size:""}]`}mapFromDriverValue(a){return"string"==typeof a&&(a=function(a){let[b]=function a(b,c=0){let d=[],e=c,f=!1;for(;e<b.length;){let g=b[e];if(","===g){(f||e===c)&&d.push(""),f=!0,e++;continue}if(f=!1,"\\"===g){e+=2;continue}if('"'===g){let[a,c]=K(b,e+1,!0);d.push(a),e=c;continue}if("}"===g)return[d,e+1];if("{"===g){let[c,f]=a(b,e+1);d.push(c),e=f;continue}let[h,i]=K(b,e,!1);d.push(h),e=i}return[d,e]}(a,1);return b}(a)),a.map(a=>this.baseColumn.mapFromDriverValue(a))}mapToDriverValue(a,b=!1){let c=a.map(a=>null===a?null:z(this.baseColumn,Q)?this.baseColumn.mapToDriverValue(a,!0):this.baseColumn.mapToDriverValue(a));return b?c:function a(b){return`{${b.map(b=>Array.isArray(b)?a(b):"string"==typeof b?`"${b.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`:`${b}`).join(",")}}`}(c)}}let R=Symbol.for("drizzle:isPgEnum");class S extends L{static [y]="PgEnumColumnBuilder";constructor(a,b){super(a,"string","PgEnumColumn"),this.config.enum=b}build(a){return new T(a,this.config)}}class T extends M{static [y]="PgEnumColumn";enum=this.config.enum;enumValues=this.config.enum.enumValues;constructor(a,b){super(a,b),this.enum=b.enum}getSQLType(){return this.enum.enumName}}class U{static [y]="Subquery";constructor(a,b,c,d=!1){this._={brand:"Subquery",sql:a,selectedFields:b,alias:c,isWith:d}}}class V extends U{static [y]="WithSubquery"}let W={startActiveSpan:(a,b)=>d?(e||(e=d.trace.getTracer("drizzle-orm","0.39.1")),F((c,d)=>d.startActiveSpan(a,a=>{try{return b(a)}catch(b){throw a.setStatus({code:c.SpanStatusCode.ERROR,message:b instanceof Error?b.message:"Unknown error"}),b}finally{a.end()}}),d,e)):b()},X=Symbol.for("drizzle:ViewBaseConfig"),Y=Symbol.for("drizzle:Schema"),Z=Symbol.for("drizzle:Columns"),$=Symbol.for("drizzle:ExtraConfigColumns"),_=Symbol.for("drizzle:OriginalName"),aa=Symbol.for("drizzle:BaseName"),ab=Symbol.for("drizzle:IsAlias"),ac=Symbol.for("drizzle:ExtraConfigBuilder"),ad=Symbol.for("drizzle:IsDrizzleTable");class ae{static [y]="Table";static Symbol={Name:C,Schema:Y,OriginalName:_,Columns:Z,ExtraConfigColumns:$,BaseName:aa,IsAlias:ab,ExtraConfigBuilder:ac};[C];[_];[Y];[Z];[$];[aa];[ab]=!1;[ad]=!0;[ac]=void 0;constructor(a,b,c){this[C]=this[_]=a,this[Y]=b,this[aa]=c}}function af(a){return"object"==typeof a&&null!==a&&ad in a}function ag(a){return`${a[Y]??"public"}.${a[C]}`}class ah{static [y]=null}function ai(a){return null!=a&&"function"==typeof a.getSQL}class aj{static [y]="StringChunk";value;constructor(a){this.value=Array.isArray(a)?a:[a]}getSQL(){return new ak([this])}}class ak{constructor(a){this.queryChunks=a}static [y]="SQL";decoder=am;shouldInlineParams=!1;append(a){return this.queryChunks.push(...a.queryChunks),this}toQuery(a){return W.startActiveSpan("drizzle.buildSQL",b=>{let c=this.buildQueryFromSourceParams(this.queryChunks,a);return b?.setAttributes({"drizzle.query.text":c.sql,"drizzle.query.params":JSON.stringify(c.params)}),c})}buildQueryFromSourceParams(a,b){let c=Object.assign({},b,{inlineParams:b.inlineParams||this.shouldInlineParams,paramStartIndex:b.paramStartIndex||{value:0}}),{casing:d,escapeName:e,escapeParam:f,prepareTyping:g,inlineParams:h,paramStartIndex:i}=c;var j=a.map(a=>{if(z(a,aj))return{sql:a.value.join(""),params:[]};if(z(a,al))return{sql:e(a.value),params:[]};if(void 0===a)return{sql:"",params:[]};if(Array.isArray(a)){let b=[new aj("(")];for(let[c,d]of a.entries())b.push(d),c<a.length-1&&b.push(new aj(", "));return b.push(new aj(")")),this.buildQueryFromSourceParams(b,c)}if(z(a,ak))return this.buildQueryFromSourceParams(a.queryChunks,{...c,inlineParams:h||a.shouldInlineParams});if(z(a,ae)){let b=a[ae.Symbol.Schema],c=a[ae.Symbol.Name];return{sql:void 0===b||a[ab]?e(c):e(b)+"."+e(c),params:[]}}if(z(a,B)){let c=d.getColumnCasing(a);if("indexes"===b.invokeSource)return{sql:e(c),params:[]};let f=a.table[ae.Symbol.Schema];return{sql:a.table[ab]||void 0===f?e(a.table[ae.Symbol.Name])+"."+e(c):e(f)+"."+e(a.table[ae.Symbol.Name])+"."+e(c),params:[]}}if(z(a,at)){let b=a[X].schema,c=a[X].name;return{sql:void 0===b||a[X].isAlias?e(c):e(b)+"."+e(c),params:[]}}if(z(a,ao)){if(z(a.value,aq))return{sql:f(i.value++,a),params:[a],typings:["none"]};let b=null===a.value?null:a.encoder.mapToDriverValue(a.value);if(z(b,ak))return this.buildQueryFromSourceParams([b],c);if(h)return{sql:this.mapInlineParam(b,c),params:[]};let d=["none"];return g&&(d=[g(a.encoder)]),{sql:f(i.value++,b),params:[b],typings:d}}return z(a,aq)?{sql:f(i.value++,a),params:[a],typings:["none"]}:z(a,ak.Aliased)&&void 0!==a.fieldAlias?{sql:e(a.fieldAlias),params:[]}:z(a,U)?a._.isWith?{sql:e(a._.alias),params:[]}:this.buildQueryFromSourceParams([new aj("("),a._.sql,new aj(") "),new al(a._.alias)],c):a&&"function"==typeof a&&R in a&&!0===a[R]?a.schema?{sql:e(a.schema)+"."+e(a.enumName),params:[]}:{sql:e(a.enumName),params:[]}:ai(a)?a.shouldOmitSQLParens?.()?this.buildQueryFromSourceParams([a.getSQL()],c):this.buildQueryFromSourceParams([new aj("("),a.getSQL(),new aj(")")],c):h?{sql:this.mapInlineParam(a,c),params:[]}:{sql:f(i.value++,a),params:[a],typings:["none"]}});let k={sql:"",params:[]};for(let a of j)k.sql+=a.sql,k.params.push(...a.params),a.typings?.length&&(k.typings||(k.typings=[]),k.typings.push(...a.typings));return k}mapInlineParam(a,{escapeString:b}){if(null===a)return"null";if("number"==typeof a||"boolean"==typeof a)return a.toString();if("string"==typeof a)return b(a);if("object"==typeof a){let c=a.toString();return"[object Object]"===c?b(JSON.stringify(a)):b(c)}throw Error("Unexpected param value: "+a)}getSQL(){return this}as(a){return void 0===a?this:new ak.Aliased(this,a)}mapWith(a){return this.decoder="function"==typeof a?{mapFromDriverValue:a}:a,this}inlineParams(){return this.shouldInlineParams=!0,this}if(a){return a?this:void 0}}class al{constructor(a){this.value=a}static [y]="Name";brand;getSQL(){return new ak([this])}}let am={mapFromDriverValue:a=>a},an={mapToDriverValue:a=>a};({...am,...an});class ao{constructor(a,b=an){this.value=a,this.encoder=b}static [y]="Param";brand;getSQL(){return new ak([this])}}function ap(a,...b){let c=[];for(let[d,e]of((b.length>0||a.length>0&&""!==a[0])&&c.push(new aj(a[0])),b.entries()))c.push(e,new aj(a[d+1]));return new ak(c)}(a=>{a.empty=function(){return new ak([])},a.fromList=function(a){return new ak(a)},a.raw=function(a){return new ak([new aj(a)])},a.join=function(a,b){let c=[];for(let[d,e]of a.entries())d>0&&void 0!==b&&c.push(b),c.push(e);return new ak(c)},a.identifier=function(a){return new al(a)},a.placeholder=function(a){return new aq(a)},a.param=function(a,b){return new ao(a,b)}})(ap||(ap={})),(a=>{class b{constructor(a,b){this.sql=a,this.fieldAlias=b}static [y]="SQL.Aliased";isSelectionField=!1;getSQL(){return this.sql}clone(){return new b(this.sql,this.fieldAlias)}}a.Aliased=b})(ak||(ak={}));class aq{constructor(a){this.name=a}static [y]="Placeholder";getSQL(){return new ak([this])}}function ar(a,b){return a.map(a=>{if(z(a,aq)){if(!(a.name in b))throw Error(`No value for placeholder "${a.name}" was provided`);return b[a.name]}if(z(a,ao)&&z(a.value,aq)){if(!(a.value.name in b))throw Error(`No value for placeholder "${a.value.name}" was provided`);return a.encoder.mapToDriverValue(b[a.value.name])}return a})}let as=Symbol.for("drizzle:IsDrizzleView");class at{static [y]="View";[X];[as]=!0;constructor({name:a,schema:b,selectedFields:c,query:d}){this[X]={name:a,originalName:a,schema:b,selectedFields:c,query:d,isExisting:!d,isAlias:!1}}getSQL(){return new ak([this])}}function au(a,b){return Object.entries(a).reduce((a,[c,d])=>{if("string"!=typeof c)return a;let e=b?[...b,c]:[c];return z(d,B)||z(d,ak)||z(d,ak.Aliased)?a.push({path:e,field:d}):z(d,ae)?a.push(...au(d[ae.Symbol.Columns],e)):a.push(...au(d,e)),a},[])}function av(a,b){let c=Object.keys(a),d=Object.keys(b);if(c.length!==d.length)return!1;for(let[a,b]of c.entries())if(b!==d[a])return!1;return!0}function aw(a,b){let c=Object.entries(b).filter(([,a])=>void 0!==a).map(([b,c])=>z(c,ak)||z(c,B)?[b,c]:[b,new ao(c,a[ae.Symbol.Columns][b])]);if(0===c.length)throw Error("No values to set");return Object.fromEntries(c)}function ax(a){return a[ae.Symbol.Columns]}function ay(a){return z(a,U)?a._.alias:z(a,at)?a[X].name:z(a,ak)?void 0:a[ae.Symbol.IsAlias]?a[ae.Symbol.Name]:a[ae.Symbol.BaseName]}function az(a,b){return{name:"string"==typeof a&&a.length>0?a:"",config:"object"==typeof a?a:b}}B.prototype.getSQL=function(){return new ak([this])},ae.prototype.getSQL=function(){return new ak([this])},U.prototype.getSQL=function(){return new ak([this])};class aA extends L{static [y]="PgIntColumnBaseBuilder";generatedAlwaysAsIdentity(a){if(a){let{name:b,...c}=a;this.config.generatedIdentity={type:"always",sequenceName:b,sequenceOptions:c}}else this.config.generatedIdentity={type:"always"};return this.config.hasDefault=!0,this.config.notNull=!0,this}generatedByDefaultAsIdentity(a){if(a){let{name:b,...c}=a;this.config.generatedIdentity={type:"byDefault",sequenceName:b,sequenceOptions:c}}else this.config.generatedIdentity={type:"byDefault"};return this.config.hasDefault=!0,this.config.notNull=!0,this}}class aB extends aA{static [y]="PgBigInt53Builder";constructor(a){super(a,"number","PgBigInt53")}build(a){return new aC(a,this.config)}}class aC extends M{static [y]="PgBigInt53";getSQLType(){return"bigint"}mapFromDriverValue(a){return"number"==typeof a?a:Number(a)}}class aD extends aA{static [y]="PgBigInt64Builder";constructor(a){super(a,"bigint","PgBigInt64")}build(a){return new aE(a,this.config)}}class aE extends M{static [y]="PgBigInt64";getSQLType(){return"bigint"}mapFromDriverValue(a){return BigInt(a)}}function aF(a,b){let{name:c,config:d}=az(a,b);return"number"===d.mode?new aB(c):new aD(c)}class aG extends L{static [y]="PgBigSerial53Builder";constructor(a){super(a,"number","PgBigSerial53"),this.config.hasDefault=!0,this.config.notNull=!0}build(a){return new aH(a,this.config)}}class aH extends M{static [y]="PgBigSerial53";getSQLType(){return"bigserial"}mapFromDriverValue(a){return"number"==typeof a?a:Number(a)}}class aI extends L{static [y]="PgBigSerial64Builder";constructor(a){super(a,"bigint","PgBigSerial64"),this.config.hasDefault=!0}build(a){return new aJ(a,this.config)}}class aJ extends M{static [y]="PgBigSerial64";getSQLType(){return"bigserial"}mapFromDriverValue(a){return BigInt(a)}}function aK(a,b){let{name:c,config:d}=az(a,b);return"number"===d.mode?new aG(c):new aI(c)}class aL extends L{static [y]="PgBooleanBuilder";constructor(a){super(a,"boolean","PgBoolean")}build(a){return new aM(a,this.config)}}class aM extends M{static [y]="PgBoolean";getSQLType(){return"boolean"}}function aN(a){return new aL(a??"")}class aO extends L{static [y]="PgCharBuilder";constructor(a,b){super(a,"string","PgChar"),this.config.length=b.length,this.config.enumValues=b.enum}build(a){return new aP(a,this.config)}}class aP extends M{static [y]="PgChar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return void 0===this.length?"char":`char(${this.length})`}}function aQ(a,b={}){let{name:c,config:d}=az(a,b);return new aO(c,d)}class aR extends L{static [y]="PgCidrBuilder";constructor(a){super(a,"string","PgCidr")}build(a){return new aS(a,this.config)}}class aS extends M{static [y]="PgCidr";getSQLType(){return"cidr"}}function aT(a){return new aR(a??"")}class aU extends L{static [y]="PgCustomColumnBuilder";constructor(a,b,c){super(a,"custom","PgCustomColumn"),this.config.fieldConfig=b,this.config.customTypeParams=c}build(a){return new aV(a,this.config)}}class aV extends M{static [y]="PgCustomColumn";sqlName;mapTo;mapFrom;constructor(a,b){super(a,b),this.sqlName=b.customTypeParams.dataType(b.fieldConfig),this.mapTo=b.customTypeParams.toDriver,this.mapFrom=b.customTypeParams.fromDriver}getSQLType(){return this.sqlName}mapFromDriverValue(a){return"function"==typeof this.mapFrom?this.mapFrom(a):a}mapToDriverValue(a){return"function"==typeof this.mapTo?this.mapTo(a):a}}function aW(a){return(b,c)=>{let{name:d,config:e}=az(b,c);return new aU(d,e,a)}}class aX extends L{static [y]="PgDateColumnBaseBuilder";defaultNow(){return this.default(ap`now()`)}}class aY extends aX{static [y]="PgDateBuilder";constructor(a){super(a,"date","PgDate")}build(a){return new aZ(a,this.config)}}class aZ extends M{static [y]="PgDate";getSQLType(){return"date"}mapFromDriverValue(a){return new Date(a)}mapToDriverValue(a){return a.toISOString()}}class a$ extends aX{static [y]="PgDateStringBuilder";constructor(a){super(a,"string","PgDateString")}build(a){return new a_(a,this.config)}}class a_ extends M{static [y]="PgDateString";getSQLType(){return"date"}}function a0(a,b){let{name:c,config:d}=az(a,b);return d?.mode==="date"?new aY(c):new a$(c)}class a1 extends L{static [y]="PgDoublePrecisionBuilder";constructor(a){super(a,"number","PgDoublePrecision")}build(a){return new a2(a,this.config)}}class a2 extends M{static [y]="PgDoublePrecision";getSQLType(){return"double precision"}mapFromDriverValue(a){return"string"==typeof a?Number.parseFloat(a):a}}function a3(a){return new a1(a??"")}class a4 extends L{static [y]="PgInetBuilder";constructor(a){super(a,"string","PgInet")}build(a){return new a5(a,this.config)}}class a5 extends M{static [y]="PgInet";getSQLType(){return"inet"}}function a6(a){return new a4(a??"")}class a7 extends aA{static [y]="PgIntegerBuilder";constructor(a){super(a,"number","PgInteger")}build(a){return new a8(a,this.config)}}class a8 extends M{static [y]="PgInteger";getSQLType(){return"integer"}mapFromDriverValue(a){return"string"==typeof a?Number.parseInt(a):a}}function a9(a){return new a7(a??"")}class ba extends L{static [y]="PgIntervalBuilder";constructor(a,b){super(a,"string","PgInterval"),this.config.intervalConfig=b}build(a){return new bb(a,this.config)}}class bb extends M{static [y]="PgInterval";fields=this.config.intervalConfig.fields;precision=this.config.intervalConfig.precision;getSQLType(){let a=this.fields?` ${this.fields}`:"",b=this.precision?`(${this.precision})`:"";return`interval${a}${b}`}}function bc(a,b={}){let{name:c,config:d}=az(a,b);return new ba(c,d)}class bd extends L{static [y]="PgJsonBuilder";constructor(a){super(a,"json","PgJson")}build(a){return new be(a,this.config)}}class be extends M{static [y]="PgJson";constructor(a,b){super(a,b)}getSQLType(){return"json"}mapToDriverValue(a){return JSON.stringify(a)}mapFromDriverValue(a){if("string"==typeof a)try{return JSON.parse(a)}catch{}return a}}function bf(a){return new bd(a??"")}class bg extends L{static [y]="PgJsonbBuilder";constructor(a){super(a,"json","PgJsonb")}build(a){return new bh(a,this.config)}}class bh extends M{static [y]="PgJsonb";constructor(a,b){super(a,b)}getSQLType(){return"jsonb"}mapToDriverValue(a){return JSON.stringify(a)}mapFromDriverValue(a){if("string"==typeof a)try{return JSON.parse(a)}catch{}return a}}function bi(a){return new bg(a??"")}class bj extends L{static [y]="PgLineBuilder";constructor(a){super(a,"array","PgLine")}build(a){return new bk(a,this.config)}}class bk extends M{static [y]="PgLine";getSQLType(){return"line"}mapFromDriverValue(a){let[b,c,d]=a.slice(1,-1).split(",");return[Number.parseFloat(b),Number.parseFloat(c),Number.parseFloat(d)]}mapToDriverValue(a){return`{${a[0]},${a[1]},${a[2]}}`}}class bl extends L{static [y]="PgLineABCBuilder";constructor(a){super(a,"json","PgLineABC")}build(a){return new bm(a,this.config)}}class bm extends M{static [y]="PgLineABC";getSQLType(){return"line"}mapFromDriverValue(a){let[b,c,d]=a.slice(1,-1).split(",");return{a:Number.parseFloat(b),b:Number.parseFloat(c),c:Number.parseFloat(d)}}mapToDriverValue(a){return`{${a.a},${a.b},${a.c}}`}}function bn(a,b){let{name:c,config:d}=az(a,b);return d?.mode&&"tuple"!==d.mode?new bl(c):new bj(c)}class bo extends L{static [y]="PgMacaddrBuilder";constructor(a){super(a,"string","PgMacaddr")}build(a){return new bp(a,this.config)}}class bp extends M{static [y]="PgMacaddr";getSQLType(){return"macaddr"}}function bq(a){return new bo(a??"")}class br extends L{static [y]="PgMacaddr8Builder";constructor(a){super(a,"string","PgMacaddr8")}build(a){return new bs(a,this.config)}}class bs extends M{static [y]="PgMacaddr8";getSQLType(){return"macaddr8"}}function bt(a){return new br(a??"")}class bu extends L{static [y]="PgNumericBuilder";constructor(a,b,c){super(a,"string","PgNumeric"),this.config.precision=b,this.config.scale=c}build(a){return new bv(a,this.config)}}class bv extends M{static [y]="PgNumeric";precision;scale;constructor(a,b){super(a,b),this.precision=b.precision,this.scale=b.scale}getSQLType(){return void 0!==this.precision&&void 0!==this.scale?`numeric(${this.precision}, ${this.scale})`:void 0===this.precision?"numeric":`numeric(${this.precision})`}}function bw(a,b){let{name:c,config:d}=az(a,b);return new bu(c,d?.precision,d?.scale)}class bx extends L{static [y]="PgPointTupleBuilder";constructor(a){super(a,"array","PgPointTuple")}build(a){return new by(a,this.config)}}class by extends M{static [y]="PgPointTuple";getSQLType(){return"point"}mapFromDriverValue(a){if("string"==typeof a){let[b,c]=a.slice(1,-1).split(",");return[Number.parseFloat(b),Number.parseFloat(c)]}return[a.x,a.y]}mapToDriverValue(a){return`(${a[0]},${a[1]})`}}class bz extends L{static [y]="PgPointObjectBuilder";constructor(a){super(a,"json","PgPointObject")}build(a){return new bA(a,this.config)}}class bA extends M{static [y]="PgPointObject";getSQLType(){return"point"}mapFromDriverValue(a){if("string"==typeof a){let[b,c]=a.slice(1,-1).split(",");return{x:Number.parseFloat(b),y:Number.parseFloat(c)}}return a}mapToDriverValue(a){return`(${a.x},${a.y})`}}function bB(a,b){let{name:c,config:d}=az(a,b);return d?.mode&&"tuple"!==d.mode?new bz(c):new bx(c)}function bC(a,b){let c=new DataView(new ArrayBuffer(8));for(let d=0;d<8;d++)c.setUint8(d,a[b+d]);return c.getFloat64(0,!0)}function bD(a){let b=function(a){let b=[];for(let c=0;c<a.length;c+=2)b.push(Number.parseInt(a.slice(c,c+2),16));return new Uint8Array(b)}(a),c=0,d=b[0];c+=1;let e=new DataView(b.buffer),f=e.getUint32(c,1===d);if(c+=4,0x20000000&f&&(e.getUint32(c,1===d),c+=4),(65535&f)==1){let a=bC(b,c),d=bC(b,c+=8);return c+=8,[a,d]}throw Error("Unsupported geometry type")}class bE extends L{static [y]="PgGeometryBuilder";constructor(a){super(a,"array","PgGeometry")}build(a){return new bF(a,this.config)}}class bF extends M{static [y]="PgGeometry";getSQLType(){return"geometry(point)"}mapFromDriverValue(a){return bD(a)}mapToDriverValue(a){return`point(${a[0]} ${a[1]})`}}class bG extends L{static [y]="PgGeometryObjectBuilder";constructor(a){super(a,"json","PgGeometryObject")}build(a){return new bH(a,this.config)}}class bH extends M{static [y]="PgGeometryObject";getSQLType(){return"geometry(point)"}mapFromDriverValue(a){let b=bD(a);return{x:b[0],y:b[1]}}mapToDriverValue(a){return`point(${a.x} ${a.y})`}}function bI(a,b){let{name:c,config:d}=az(a,b);return d?.mode&&"tuple"!==d.mode?new bG(c):new bE(c)}class bJ extends L{static [y]="PgRealBuilder";constructor(a,b){super(a,"number","PgReal"),this.config.length=b}build(a){return new bK(a,this.config)}}class bK extends M{static [y]="PgReal";constructor(a,b){super(a,b)}getSQLType(){return"real"}mapFromDriverValue=a=>"string"==typeof a?Number.parseFloat(a):a}function bL(a){return new bJ(a??"")}class bM extends L{static [y]="PgSerialBuilder";constructor(a){super(a,"number","PgSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(a){return new bN(a,this.config)}}class bN extends M{static [y]="PgSerial";getSQLType(){return"serial"}}function bO(a){return new bM(a??"")}class bP extends aA{static [y]="PgSmallIntBuilder";constructor(a){super(a,"number","PgSmallInt")}build(a){return new bQ(a,this.config)}}class bQ extends M{static [y]="PgSmallInt";getSQLType(){return"smallint"}mapFromDriverValue=a=>"string"==typeof a?Number(a):a}function bR(a){return new bP(a??"")}class bS extends L{static [y]="PgSmallSerialBuilder";constructor(a){super(a,"number","PgSmallSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(a){return new bT(a,this.config)}}class bT extends M{static [y]="PgSmallSerial";getSQLType(){return"smallserial"}}function bU(a){return new bS(a??"")}class bV extends L{static [y]="PgTextBuilder";constructor(a,b){super(a,"string","PgText"),this.config.enumValues=b.enum}build(a){return new bW(a,this.config)}}class bW extends M{static [y]="PgText";enumValues=this.config.enumValues;getSQLType(){return"text"}}function bX(a,b={}){let{name:c,config:d}=az(a,b);return new bV(c,d)}class bY extends aX{constructor(a,b,c){super(a,"string","PgTime"),this.withTimezone=b,this.precision=c,this.config.withTimezone=b,this.config.precision=c}static [y]="PgTimeBuilder";build(a){return new bZ(a,this.config)}}class bZ extends M{static [y]="PgTime";withTimezone;precision;constructor(a,b){super(a,b),this.withTimezone=b.withTimezone,this.precision=b.precision}getSQLType(){let a=void 0===this.precision?"":`(${this.precision})`;return`time${a}${this.withTimezone?" with time zone":""}`}}function b$(a,b={}){let{name:c,config:d}=az(a,b);return new bY(c,d.withTimezone??!1,d.precision)}class b_ extends aX{static [y]="PgTimestampBuilder";constructor(a,b,c){super(a,"date","PgTimestamp"),this.config.withTimezone=b,this.config.precision=c}build(a){return new b0(a,this.config)}}class b0 extends M{static [y]="PgTimestamp";withTimezone;precision;constructor(a,b){super(a,b),this.withTimezone=b.withTimezone,this.precision=b.precision}getSQLType(){let a=void 0===this.precision?"":` (${this.precision})`;return`timestamp${a}${this.withTimezone?" with time zone":""}`}mapFromDriverValue=a=>new Date(this.withTimezone?a:a+"+0000");mapToDriverValue=a=>a.toISOString()}class b1 extends aX{static [y]="PgTimestampStringBuilder";constructor(a,b,c){super(a,"string","PgTimestampString"),this.config.withTimezone=b,this.config.precision=c}build(a){return new b2(a,this.config)}}class b2 extends M{static [y]="PgTimestampString";withTimezone;precision;constructor(a,b){super(a,b),this.withTimezone=b.withTimezone,this.precision=b.precision}getSQLType(){let a=void 0===this.precision?"":`(${this.precision})`;return`timestamp${a}${this.withTimezone?" with time zone":""}`}}function b3(a,b={}){let{name:c,config:d}=az(a,b);return d?.mode==="string"?new b1(c,d.withTimezone??!1,d.precision):new b_(c,d?.withTimezone??!1,d?.precision)}class b4 extends L{static [y]="PgUUIDBuilder";constructor(a){super(a,"string","PgUUID")}defaultRandom(){return this.default(ap`gen_random_uuid()`)}build(a){return new b5(a,this.config)}}class b5 extends M{static [y]="PgUUID";getSQLType(){return"uuid"}}function b6(a){return new b4(a??"")}class b7 extends L{static [y]="PgVarcharBuilder";constructor(a,b){super(a,"string","PgVarchar"),this.config.length=b.length,this.config.enumValues=b.enum}build(a){return new b8(a,this.config)}}class b8 extends M{static [y]="PgVarchar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return void 0===this.length?"varchar":`varchar(${this.length})`}}function b9(a,b={}){let{name:c,config:d}=az(a,b);return new b7(c,d)}class ca extends L{static [y]="PgBinaryVectorBuilder";constructor(a,b){super(a,"string","PgBinaryVector"),this.config.dimensions=b.dimensions}build(a){return new cb(a,this.config)}}class cb extends M{static [y]="PgBinaryVector";dimensions=this.config.dimensions;getSQLType(){return`bit(${this.dimensions})`}}function cc(a,b){let{name:c,config:d}=az(a,b);return new ca(c,d)}class cd extends L{static [y]="PgHalfVectorBuilder";constructor(a,b){super(a,"array","PgHalfVector"),this.config.dimensions=b.dimensions}build(a){return new ce(a,this.config)}}class ce extends M{static [y]="PgHalfVector";dimensions=this.config.dimensions;getSQLType(){return`halfvec(${this.dimensions})`}mapToDriverValue(a){return JSON.stringify(a)}mapFromDriverValue(a){return a.slice(1,-1).split(",").map(a=>Number.parseFloat(a))}}function cf(a,b){let{name:c,config:d}=az(a,b);return new cd(c,d)}class cg extends L{static [y]="PgSparseVectorBuilder";constructor(a,b){super(a,"string","PgSparseVector"),this.config.dimensions=b.dimensions}build(a){return new ch(a,this.config)}}class ch extends M{static [y]="PgSparseVector";dimensions=this.config.dimensions;getSQLType(){return`sparsevec(${this.dimensions})`}}function ci(a,b){let{name:c,config:d}=az(a,b);return new cg(c,d)}class cj extends L{static [y]="PgVectorBuilder";constructor(a,b){super(a,"array","PgVector"),this.config.dimensions=b.dimensions}build(a){return new ck(a,this.config)}}class ck extends M{static [y]="PgVector";dimensions=this.config.dimensions;getSQLType(){return`vector(${this.dimensions})`}mapToDriverValue(a){return JSON.stringify(a)}mapFromDriverValue(a){return a.slice(1,-1).split(",").map(a=>Number.parseFloat(a))}}function cl(a,b){let{name:c,config:d}=az(a,b);return new cj(c,d)}let cm=Symbol.for("drizzle:PgInlineForeignKeys"),cn=Symbol.for("drizzle:EnableRLS");class co extends ae{static [y]="PgTable";static Symbol=Object.assign({},ae.Symbol,{InlineForeignKeys:cm,EnableRLS:cn});[cm]=[];[cn]=!1;[ae.Symbol.ExtraConfigBuilder]=void 0}let cp=(a,b,c)=>(function(a,b,c,d,e=a){let f=new co(a,d,e),g="function"==typeof b?b({bigint:aF,bigserial:aK,boolean:aN,char:aQ,cidr:aT,customType:aW,date:a0,doublePrecision:a3,inet:a6,integer:a9,interval:bc,json:bf,jsonb:bi,line:bn,macaddr:bq,macaddr8:bt,numeric:bw,point:bB,geometry:bI,real:bL,serial:bO,smallint:bR,smallserial:bU,text:bX,time:b$,timestamp:b3,uuid:b6,varchar:b9,bit:cc,halfvec:cf,sparsevec:ci,vector:cl}):b,h=Object.fromEntries(Object.entries(g).map(([a,b])=>{b.setName(a);let c=b.build(f);return f[cm].push(...b.buildForeignKeys(c,f)),[a,c]})),i=Object.fromEntries(Object.entries(g).map(([a,b])=>(b.setName(a),[a,b.buildExtraConfigColumn(f)]))),j=Object.assign(f,h);return j[ae.Symbol.Columns]=h,j[ae.Symbol.ExtraConfigColumns]=i,c&&(j[co.Symbol.ExtraConfigBuilder]=c),Object.assign(j,{enableRLS:()=>(j[co.Symbol.EnableRLS]=!0,j)})})(a,b,c,void 0);!function(a){a.assertEqual=a=>a,a.assertIs=function(a){},a.assertNever=function(a){throw Error()},a.arrayToEnum=a=>{let b={};for(let c of a)b[c]=c;return b},a.getValidEnumValues=b=>{let c=a.objectKeys(b).filter(a=>"number"!=typeof b[b[a]]),d={};for(let a of c)d[a]=b[a];return a.objectValues(d)},a.objectValues=b=>a.objectKeys(b).map(function(a){return b[a]}),a.objectKeys="function"==typeof Object.keys?a=>Object.keys(a):a=>{let b=[];for(let c in a)Object.prototype.hasOwnProperty.call(a,c)&&b.push(c);return b},a.find=(a,b)=>{for(let c of a)if(b(c))return c},a.isInteger="function"==typeof Number.isInteger?a=>Number.isInteger(a):a=>"number"==typeof a&&isFinite(a)&&Math.floor(a)===a,a.joinValues=function(a,b=" | "){return a.map(a=>"string"==typeof a?`'${a}'`:a).join(b)},a.jsonStringifyReplacer=(a,b)=>"bigint"==typeof b?b.toString():b}(es||(es={})),(et||(et={})).mergeShapes=(a,b)=>({...a,...b});let cq=es.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),cr=a=>{switch(typeof a){case"undefined":return cq.undefined;case"string":return cq.string;case"number":return isNaN(a)?cq.nan:cq.number;case"boolean":return cq.boolean;case"function":return cq.function;case"bigint":return cq.bigint;case"symbol":return cq.symbol;case"object":if(Array.isArray(a))return cq.array;if(null===a)return cq.null;if(a.then&&"function"==typeof a.then&&a.catch&&"function"==typeof a.catch)return cq.promise;if("undefined"!=typeof Map&&a instanceof Map)return cq.map;if("undefined"!=typeof Set&&a instanceof Set)return cq.set;if("undefined"!=typeof Date&&a instanceof Date)return cq.date;return cq.object;default:return cq.unknown}},cs=es.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class ct extends Error{get errors(){return this.issues}constructor(a){super(),this.issues=[],this.addIssue=a=>{this.issues=[...this.issues,a]},this.addIssues=(a=[])=>{this.issues=[...this.issues,...a]};let b=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,b):this.__proto__=b,this.name="ZodError",this.issues=a}format(a){let b=a||function(a){return a.message},c={_errors:[]},d=a=>{for(let e of a.issues)if("invalid_union"===e.code)e.unionErrors.map(d);else if("invalid_return_type"===e.code)d(e.returnTypeError);else if("invalid_arguments"===e.code)d(e.argumentsError);else if(0===e.path.length)c._errors.push(b(e));else{let a=c,d=0;for(;d<e.path.length;){let c=e.path[d];d===e.path.length-1?(a[c]=a[c]||{_errors:[]},a[c]._errors.push(b(e))):a[c]=a[c]||{_errors:[]},a=a[c],d++}}};return d(this),c}static assert(a){if(!(a instanceof ct))throw Error(`Not a ZodError: ${a}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,es.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(a=a=>a.message){let b={},c=[];for(let d of this.issues)d.path.length>0?(b[d.path[0]]=b[d.path[0]]||[],b[d.path[0]].push(a(d))):c.push(a(d));return{formErrors:c,fieldErrors:b}}get formErrors(){return this.flatten()}}ct.create=a=>new ct(a);let cu=(a,b)=>{let c;switch(a.code){case cs.invalid_type:c=a.received===cq.undefined?"Required":`Expected ${a.expected}, received ${a.received}`;break;case cs.invalid_literal:c=`Invalid literal value, expected ${JSON.stringify(a.expected,es.jsonStringifyReplacer)}`;break;case cs.unrecognized_keys:c=`Unrecognized key(s) in object: ${es.joinValues(a.keys,", ")}`;break;case cs.invalid_union:c="Invalid input";break;case cs.invalid_union_discriminator:c=`Invalid discriminator value. Expected ${es.joinValues(a.options)}`;break;case cs.invalid_enum_value:c=`Invalid enum value. Expected ${es.joinValues(a.options)}, received '${a.received}'`;break;case cs.invalid_arguments:c="Invalid function arguments";break;case cs.invalid_return_type:c="Invalid function return type";break;case cs.invalid_date:c="Invalid date";break;case cs.invalid_string:"object"==typeof a.validation?"includes"in a.validation?(c=`Invalid input: must include "${a.validation.includes}"`,"number"==typeof a.validation.position&&(c=`${c} at one or more positions greater than or equal to ${a.validation.position}`)):"startsWith"in a.validation?c=`Invalid input: must start with "${a.validation.startsWith}"`:"endsWith"in a.validation?c=`Invalid input: must end with "${a.validation.endsWith}"`:es.assertNever(a.validation):c="regex"!==a.validation?`Invalid ${a.validation}`:"Invalid";break;case cs.too_small:c="array"===a.type?`Array must contain ${a.exact?"exactly":a.inclusive?"at least":"more than"} ${a.minimum} element(s)`:"string"===a.type?`String must contain ${a.exact?"exactly":a.inclusive?"at least":"over"} ${a.minimum} character(s)`:"number"===a.type?`Number must be ${a.exact?"exactly equal to ":a.inclusive?"greater than or equal to ":"greater than "}${a.minimum}`:"date"===a.type?`Date must be ${a.exact?"exactly equal to ":a.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(a.minimum))}`:"Invalid input";break;case cs.too_big:c="array"===a.type?`Array must contain ${a.exact?"exactly":a.inclusive?"at most":"less than"} ${a.maximum} element(s)`:"string"===a.type?`String must contain ${a.exact?"exactly":a.inclusive?"at most":"under"} ${a.maximum} character(s)`:"number"===a.type?`Number must be ${a.exact?"exactly":a.inclusive?"less than or equal to":"less than"} ${a.maximum}`:"bigint"===a.type?`BigInt must be ${a.exact?"exactly":a.inclusive?"less than or equal to":"less than"} ${a.maximum}`:"date"===a.type?`Date must be ${a.exact?"exactly":a.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(a.maximum))}`:"Invalid input";break;case cs.custom:c="Invalid input";break;case cs.invalid_intersection_types:c="Intersection results could not be merged";break;case cs.not_multiple_of:c=`Number must be a multiple of ${a.multipleOf}`;break;case cs.not_finite:c="Number must be finite";break;default:c=b.defaultError,es.assertNever(a)}return{message:c}},cv=cu;function cw(){return cv}let cx=a=>{let{data:b,path:c,errorMaps:d,issueData:e}=a,f=[...c,...e.path||[]],g={...e,path:f};if(void 0!==e.message)return{...e,path:f,message:e.message};let h="";for(let a of d.filter(a=>!!a).slice().reverse())h=a(g,{data:b,defaultError:h}).message;return{...e,path:f,message:h}};function cy(a,b){let c=cw(),d=cx({issueData:b,data:a.data,path:a.path,errorMaps:[a.common.contextualErrorMap,a.schemaErrorMap,c,c===cu?void 0:cu].filter(a=>!!a)});a.common.issues.push(d)}class cz{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(a,b){let c=[];for(let d of b){if("aborted"===d.status)return cA;"dirty"===d.status&&a.dirty(),c.push(d.value)}return{status:a.value,value:c}}static async mergeObjectAsync(a,b){let c=[];for(let a of b){let b=await a.key,d=await a.value;c.push({key:b,value:d})}return cz.mergeObjectSync(a,c)}static mergeObjectSync(a,b){let c={};for(let d of b){let{key:b,value:e}=d;if("aborted"===b.status||"aborted"===e.status)return cA;"dirty"===b.status&&a.dirty(),"dirty"===e.status&&a.dirty(),"__proto__"!==b.value&&(void 0!==e.value||d.alwaysSet)&&(c[b.value]=e.value)}return{status:a.value,value:c}}}let cA=Object.freeze({status:"aborted"}),cB=a=>({status:"dirty",value:a}),cC=a=>({status:"valid",value:a}),cD=a=>"aborted"===a.status,cE=a=>"dirty"===a.status,cF=a=>"valid"===a.status,cG=a=>"undefined"!=typeof Promise&&a instanceof Promise;function cH(a,b,c,d){if("a"===c&&!d)throw TypeError("Private accessor was defined without a getter");if("function"==typeof b?a!==b||!d:!b.has(a))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===c?d:"a"===c?d.call(a):d?d.value:b.get(a)}function cI(a,b,c,d,e){if("m"===d)throw TypeError("Private method is not writable");if("a"===d&&!e)throw TypeError("Private accessor was defined without a setter");if("function"==typeof b?a!==b||!e:!b.has(a))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===d?e.call(a,c):e?e.value=c:b.set(a,c),c}"function"==typeof SuppressedError&&SuppressedError,function(a){a.errToObj=a=>"string"==typeof a?{message:a}:a||{},a.toString=a=>"string"==typeof a?a:null==a?void 0:a.message}(eu||(eu={}));class cJ{constructor(a,b,c,d){this._cachedPath=[],this.parent=a,this.data=b,this._path=c,this._key=d}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}let cK=(a,b)=>{if(cF(b))return{success:!0,data:b.value};if(!a.common.issues.length)throw Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let b=new ct(a.common.issues);return this._error=b,this._error}}};function cL(a){if(!a)return{};let{errorMap:b,invalid_type_error:c,required_error:d,description:e}=a;if(b&&(c||d))throw Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');return b?{errorMap:b,description:e}:{errorMap:(b,e)=>{var f,g;let{message:h}=a;return"invalid_enum_value"===b.code?{message:null!=h?h:e.defaultError}:void 0===e.data?{message:null!=(f=null!=h?h:d)?f:e.defaultError}:"invalid_type"!==b.code?{message:e.defaultError}:{message:null!=(g=null!=h?h:c)?g:e.defaultError}},description:e}}class cM{get description(){return this._def.description}_getType(a){return cr(a.data)}_getOrReturnCtx(a,b){return b||{common:a.parent.common,data:a.data,parsedType:cr(a.data),schemaErrorMap:this._def.errorMap,path:a.path,parent:a.parent}}_processInputParams(a){return{status:new cz,ctx:{common:a.parent.common,data:a.data,parsedType:cr(a.data),schemaErrorMap:this._def.errorMap,path:a.path,parent:a.parent}}}_parseSync(a){let b=this._parse(a);if(cG(b))throw Error("Synchronous parse encountered promise.");return b}_parseAsync(a){return Promise.resolve(this._parse(a))}parse(a,b){let c=this.safeParse(a,b);if(c.success)return c.data;throw c.error}safeParse(a,b){var c;let d={common:{issues:[],async:null!=(c=null==b?void 0:b.async)&&c,contextualErrorMap:null==b?void 0:b.errorMap},path:(null==b?void 0:b.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:a,parsedType:cr(a)},e=this._parseSync({data:a,path:d.path,parent:d});return cK(d,e)}"~validate"(a){var b,c;let d={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:a,parsedType:cr(a)};if(!this["~standard"].async)try{let b=this._parseSync({data:a,path:[],parent:d});return cF(b)?{value:b.value}:{issues:d.common.issues}}catch(a){(null==(c=null==(b=null==a?void 0:a.message)?void 0:b.toLowerCase())?void 0:c.includes("encountered"))&&(this["~standard"].async=!0),d.common={issues:[],async:!0}}return this._parseAsync({data:a,path:[],parent:d}).then(a=>cF(a)?{value:a.value}:{issues:d.common.issues})}async parseAsync(a,b){let c=await this.safeParseAsync(a,b);if(c.success)return c.data;throw c.error}async safeParseAsync(a,b){let c={common:{issues:[],contextualErrorMap:null==b?void 0:b.errorMap,async:!0},path:(null==b?void 0:b.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:a,parsedType:cr(a)},d=this._parse({data:a,path:c.path,parent:c});return cK(c,await (cG(d)?d:Promise.resolve(d)))}refine(a,b){return this._refinement((c,d)=>{let e=a(c),f=()=>d.addIssue({code:cs.custom,..."string"==typeof b||void 0===b?{message:b}:"function"==typeof b?b(c):b});return"undefined"!=typeof Promise&&e instanceof Promise?e.then(a=>!!a||(f(),!1)):!!e||(f(),!1)})}refinement(a,b){return this._refinement((c,d)=>!!a(c)||(d.addIssue("function"==typeof b?b(c,d):b),!1))}_refinement(a){return new dx({schema:this,typeName:ex.ZodEffects,effect:{type:"refinement",refinement:a}})}superRefine(a){return this._refinement(a)}constructor(a){this.spa=this.safeParseAsync,this._def=a,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:a=>this["~validate"](a)}}optional(){return dy.create(this,this._def)}nullable(){return dz.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return df.create(this)}promise(){return dw.create(this,this._def)}or(a){return dh.create([this,a],this._def)}and(a){return dk.create(this,a,this._def)}transform(a){return new dx({...cL(this._def),schema:this,typeName:ex.ZodEffects,effect:{type:"transform",transform:a}})}default(a){return new dA({...cL(this._def),innerType:this,defaultValue:"function"==typeof a?a:()=>a,typeName:ex.ZodDefault})}brand(){return new dE({typeName:ex.ZodBranded,type:this,...cL(this._def)})}catch(a){return new dB({...cL(this._def),innerType:this,catchValue:"function"==typeof a?a:()=>a,typeName:ex.ZodCatch})}describe(a){return new this.constructor({...this._def,description:a})}pipe(a){return dF.create(this,a)}readonly(){return dG.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}let cN=/^c[^\s-]{8,}$/i,cO=/^[0-9a-z]+$/,cP=/^[0-9A-HJKMNP-TV-Z]{26}$/i,cQ=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,cR=/^[a-z0-9_-]{21}$/i,cS=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,cT=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,cU=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,cV=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,cW=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,cX=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,cY=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,cZ=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,c$=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,c_="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",c0=RegExp(`^${c_}$`);function c1(a){let b="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return a.precision?b=`${b}\\.\\d{${a.precision}}`:null==a.precision&&(b=`${b}(\\.\\d+)?`),b}function c2(a){let b=`${c_}T${c1(a)}`,c=[];return c.push(a.local?"Z?":"Z"),a.offset&&c.push("([+-]\\d{2}:?\\d{2})"),b=`${b}(${c.join("|")})`,RegExp(`^${b}$`)}class c3 extends cM{_parse(a){var b,c,d,e;let g;if(this._def.coerce&&(a.data=String(a.data)),this._getType(a)!==cq.string){let b=this._getOrReturnCtx(a);return cy(b,{code:cs.invalid_type,expected:cq.string,received:b.parsedType}),cA}let h=new cz;for(let i of this._def.checks)if("min"===i.kind)a.data.length<i.value&&(cy(g=this._getOrReturnCtx(a,g),{code:cs.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),h.dirty());else if("max"===i.kind)a.data.length>i.value&&(cy(g=this._getOrReturnCtx(a,g),{code:cs.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),h.dirty());else if("length"===i.kind){let b=a.data.length>i.value,c=a.data.length<i.value;(b||c)&&(g=this._getOrReturnCtx(a,g),b?cy(g,{code:cs.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):c&&cy(g,{code:cs.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),h.dirty())}else if("email"===i.kind)cU.test(a.data)||(cy(g=this._getOrReturnCtx(a,g),{validation:"email",code:cs.invalid_string,message:i.message}),h.dirty());else if("emoji"===i.kind)f||(f=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),f.test(a.data)||(cy(g=this._getOrReturnCtx(a,g),{validation:"emoji",code:cs.invalid_string,message:i.message}),h.dirty());else if("uuid"===i.kind)cQ.test(a.data)||(cy(g=this._getOrReturnCtx(a,g),{validation:"uuid",code:cs.invalid_string,message:i.message}),h.dirty());else if("nanoid"===i.kind)cR.test(a.data)||(cy(g=this._getOrReturnCtx(a,g),{validation:"nanoid",code:cs.invalid_string,message:i.message}),h.dirty());else if("cuid"===i.kind)cN.test(a.data)||(cy(g=this._getOrReturnCtx(a,g),{validation:"cuid",code:cs.invalid_string,message:i.message}),h.dirty());else if("cuid2"===i.kind)cO.test(a.data)||(cy(g=this._getOrReturnCtx(a,g),{validation:"cuid2",code:cs.invalid_string,message:i.message}),h.dirty());else if("ulid"===i.kind)cP.test(a.data)||(cy(g=this._getOrReturnCtx(a,g),{validation:"ulid",code:cs.invalid_string,message:i.message}),h.dirty());else if("url"===i.kind)try{new URL(a.data)}catch(b){cy(g=this._getOrReturnCtx(a,g),{validation:"url",code:cs.invalid_string,message:i.message}),h.dirty()}else"regex"===i.kind?(i.regex.lastIndex=0,i.regex.test(a.data)||(cy(g=this._getOrReturnCtx(a,g),{validation:"regex",code:cs.invalid_string,message:i.message}),h.dirty())):"trim"===i.kind?a.data=a.data.trim():"includes"===i.kind?a.data.includes(i.value,i.position)||(cy(g=this._getOrReturnCtx(a,g),{code:cs.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),h.dirty()):"toLowerCase"===i.kind?a.data=a.data.toLowerCase():"toUpperCase"===i.kind?a.data=a.data.toUpperCase():"startsWith"===i.kind?a.data.startsWith(i.value)||(cy(g=this._getOrReturnCtx(a,g),{code:cs.invalid_string,validation:{startsWith:i.value},message:i.message}),h.dirty()):"endsWith"===i.kind?a.data.endsWith(i.value)||(cy(g=this._getOrReturnCtx(a,g),{code:cs.invalid_string,validation:{endsWith:i.value},message:i.message}),h.dirty()):"datetime"===i.kind?c2(i).test(a.data)||(cy(g=this._getOrReturnCtx(a,g),{code:cs.invalid_string,validation:"datetime",message:i.message}),h.dirty()):"date"===i.kind?c0.test(a.data)||(cy(g=this._getOrReturnCtx(a,g),{code:cs.invalid_string,validation:"date",message:i.message}),h.dirty()):"time"===i.kind?RegExp(`^${c1(i)}$`).test(a.data)||(cy(g=this._getOrReturnCtx(a,g),{code:cs.invalid_string,validation:"time",message:i.message}),h.dirty()):"duration"===i.kind?cT.test(a.data)||(cy(g=this._getOrReturnCtx(a,g),{validation:"duration",code:cs.invalid_string,message:i.message}),h.dirty()):"ip"===i.kind?(b=a.data,!(("v4"===(c=i.version)||!c)&&cV.test(b)||("v6"===c||!c)&&cX.test(b))&&1&&(cy(g=this._getOrReturnCtx(a,g),{validation:"ip",code:cs.invalid_string,message:i.message}),h.dirty())):"jwt"===i.kind?!function(a,b){if(!cS.test(a))return!1;try{let[c]=a.split("."),d=c.replace(/-/g,"+").replace(/_/g,"/").padEnd(c.length+(4-c.length%4)%4,"="),e=JSON.parse(atob(d));if("object"!=typeof e||null===e||!e.typ||!e.alg||b&&e.alg!==b)return!1;return!0}catch(a){return!1}}(a.data,i.alg)&&(cy(g=this._getOrReturnCtx(a,g),{validation:"jwt",code:cs.invalid_string,message:i.message}),h.dirty()):"cidr"===i.kind?(d=a.data,!(("v4"===(e=i.version)||!e)&&cW.test(d)||("v6"===e||!e)&&cY.test(d))&&1&&(cy(g=this._getOrReturnCtx(a,g),{validation:"cidr",code:cs.invalid_string,message:i.message}),h.dirty())):"base64"===i.kind?cZ.test(a.data)||(cy(g=this._getOrReturnCtx(a,g),{validation:"base64",code:cs.invalid_string,message:i.message}),h.dirty()):"base64url"===i.kind?c$.test(a.data)||(cy(g=this._getOrReturnCtx(a,g),{validation:"base64url",code:cs.invalid_string,message:i.message}),h.dirty()):es.assertNever(i);return{status:h.value,value:a.data}}_regex(a,b,c){return this.refinement(b=>a.test(b),{validation:b,code:cs.invalid_string,...eu.errToObj(c)})}_addCheck(a){return new c3({...this._def,checks:[...this._def.checks,a]})}email(a){return this._addCheck({kind:"email",...eu.errToObj(a)})}url(a){return this._addCheck({kind:"url",...eu.errToObj(a)})}emoji(a){return this._addCheck({kind:"emoji",...eu.errToObj(a)})}uuid(a){return this._addCheck({kind:"uuid",...eu.errToObj(a)})}nanoid(a){return this._addCheck({kind:"nanoid",...eu.errToObj(a)})}cuid(a){return this._addCheck({kind:"cuid",...eu.errToObj(a)})}cuid2(a){return this._addCheck({kind:"cuid2",...eu.errToObj(a)})}ulid(a){return this._addCheck({kind:"ulid",...eu.errToObj(a)})}base64(a){return this._addCheck({kind:"base64",...eu.errToObj(a)})}base64url(a){return this._addCheck({kind:"base64url",...eu.errToObj(a)})}jwt(a){return this._addCheck({kind:"jwt",...eu.errToObj(a)})}ip(a){return this._addCheck({kind:"ip",...eu.errToObj(a)})}cidr(a){return this._addCheck({kind:"cidr",...eu.errToObj(a)})}datetime(a){var b,c;return"string"==typeof a?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:a}):this._addCheck({kind:"datetime",precision:void 0===(null==a?void 0:a.precision)?null:null==a?void 0:a.precision,offset:null!=(b=null==a?void 0:a.offset)&&b,local:null!=(c=null==a?void 0:a.local)&&c,...eu.errToObj(null==a?void 0:a.message)})}date(a){return this._addCheck({kind:"date",message:a})}time(a){return"string"==typeof a?this._addCheck({kind:"time",precision:null,message:a}):this._addCheck({kind:"time",precision:void 0===(null==a?void 0:a.precision)?null:null==a?void 0:a.precision,...eu.errToObj(null==a?void 0:a.message)})}duration(a){return this._addCheck({kind:"duration",...eu.errToObj(a)})}regex(a,b){return this._addCheck({kind:"regex",regex:a,...eu.errToObj(b)})}includes(a,b){return this._addCheck({kind:"includes",value:a,position:null==b?void 0:b.position,...eu.errToObj(null==b?void 0:b.message)})}startsWith(a,b){return this._addCheck({kind:"startsWith",value:a,...eu.errToObj(b)})}endsWith(a,b){return this._addCheck({kind:"endsWith",value:a,...eu.errToObj(b)})}min(a,b){return this._addCheck({kind:"min",value:a,...eu.errToObj(b)})}max(a,b){return this._addCheck({kind:"max",value:a,...eu.errToObj(b)})}length(a,b){return this._addCheck({kind:"length",value:a,...eu.errToObj(b)})}nonempty(a){return this.min(1,eu.errToObj(a))}trim(){return new c3({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new c3({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new c3({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(a=>"datetime"===a.kind)}get isDate(){return!!this._def.checks.find(a=>"date"===a.kind)}get isTime(){return!!this._def.checks.find(a=>"time"===a.kind)}get isDuration(){return!!this._def.checks.find(a=>"duration"===a.kind)}get isEmail(){return!!this._def.checks.find(a=>"email"===a.kind)}get isURL(){return!!this._def.checks.find(a=>"url"===a.kind)}get isEmoji(){return!!this._def.checks.find(a=>"emoji"===a.kind)}get isUUID(){return!!this._def.checks.find(a=>"uuid"===a.kind)}get isNANOID(){return!!this._def.checks.find(a=>"nanoid"===a.kind)}get isCUID(){return!!this._def.checks.find(a=>"cuid"===a.kind)}get isCUID2(){return!!this._def.checks.find(a=>"cuid2"===a.kind)}get isULID(){return!!this._def.checks.find(a=>"ulid"===a.kind)}get isIP(){return!!this._def.checks.find(a=>"ip"===a.kind)}get isCIDR(){return!!this._def.checks.find(a=>"cidr"===a.kind)}get isBase64(){return!!this._def.checks.find(a=>"base64"===a.kind)}get isBase64url(){return!!this._def.checks.find(a=>"base64url"===a.kind)}get minLength(){let a=null;for(let b of this._def.checks)"min"===b.kind&&(null===a||b.value>a)&&(a=b.value);return a}get maxLength(){let a=null;for(let b of this._def.checks)"max"===b.kind&&(null===a||b.value<a)&&(a=b.value);return a}}c3.create=a=>{var b;return new c3({checks:[],typeName:ex.ZodString,coerce:null!=(b=null==a?void 0:a.coerce)&&b,...cL(a)})};class c4 extends cM{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(a){let b;if(this._def.coerce&&(a.data=Number(a.data)),this._getType(a)!==cq.number){let b=this._getOrReturnCtx(a);return cy(b,{code:cs.invalid_type,expected:cq.number,received:b.parsedType}),cA}let c=new cz;for(let d of this._def.checks)"int"===d.kind?es.isInteger(a.data)||(cy(b=this._getOrReturnCtx(a,b),{code:cs.invalid_type,expected:"integer",received:"float",message:d.message}),c.dirty()):"min"===d.kind?(d.inclusive?a.data<d.value:a.data<=d.value)&&(cy(b=this._getOrReturnCtx(a,b),{code:cs.too_small,minimum:d.value,type:"number",inclusive:d.inclusive,exact:!1,message:d.message}),c.dirty()):"max"===d.kind?(d.inclusive?a.data>d.value:a.data>=d.value)&&(cy(b=this._getOrReturnCtx(a,b),{code:cs.too_big,maximum:d.value,type:"number",inclusive:d.inclusive,exact:!1,message:d.message}),c.dirty()):"multipleOf"===d.kind?0!==function(a,b){let c=(a.toString().split(".")[1]||"").length,d=(b.toString().split(".")[1]||"").length,e=c>d?c:d;return parseInt(a.toFixed(e).replace(".",""))%parseInt(b.toFixed(e).replace(".",""))/Math.pow(10,e)}(a.data,d.value)&&(cy(b=this._getOrReturnCtx(a,b),{code:cs.not_multiple_of,multipleOf:d.value,message:d.message}),c.dirty()):"finite"===d.kind?Number.isFinite(a.data)||(cy(b=this._getOrReturnCtx(a,b),{code:cs.not_finite,message:d.message}),c.dirty()):es.assertNever(d);return{status:c.value,value:a.data}}gte(a,b){return this.setLimit("min",a,!0,eu.toString(b))}gt(a,b){return this.setLimit("min",a,!1,eu.toString(b))}lte(a,b){return this.setLimit("max",a,!0,eu.toString(b))}lt(a,b){return this.setLimit("max",a,!1,eu.toString(b))}setLimit(a,b,c,d){return new c4({...this._def,checks:[...this._def.checks,{kind:a,value:b,inclusive:c,message:eu.toString(d)}]})}_addCheck(a){return new c4({...this._def,checks:[...this._def.checks,a]})}int(a){return this._addCheck({kind:"int",message:eu.toString(a)})}positive(a){return this._addCheck({kind:"min",value:0,inclusive:!1,message:eu.toString(a)})}negative(a){return this._addCheck({kind:"max",value:0,inclusive:!1,message:eu.toString(a)})}nonpositive(a){return this._addCheck({kind:"max",value:0,inclusive:!0,message:eu.toString(a)})}nonnegative(a){return this._addCheck({kind:"min",value:0,inclusive:!0,message:eu.toString(a)})}multipleOf(a,b){return this._addCheck({kind:"multipleOf",value:a,message:eu.toString(b)})}finite(a){return this._addCheck({kind:"finite",message:eu.toString(a)})}safe(a){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:eu.toString(a)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:eu.toString(a)})}get minValue(){let a=null;for(let b of this._def.checks)"min"===b.kind&&(null===a||b.value>a)&&(a=b.value);return a}get maxValue(){let a=null;for(let b of this._def.checks)"max"===b.kind&&(null===a||b.value<a)&&(a=b.value);return a}get isInt(){return!!this._def.checks.find(a=>"int"===a.kind||"multipleOf"===a.kind&&es.isInteger(a.value))}get isFinite(){let a=null,b=null;for(let c of this._def.checks)if("finite"===c.kind||"int"===c.kind||"multipleOf"===c.kind)return!0;else"min"===c.kind?(null===b||c.value>b)&&(b=c.value):"max"===c.kind&&(null===a||c.value<a)&&(a=c.value);return Number.isFinite(b)&&Number.isFinite(a)}}c4.create=a=>new c4({checks:[],typeName:ex.ZodNumber,coerce:(null==a?void 0:a.coerce)||!1,...cL(a)});class c5 extends cM{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(a){let b;if(this._def.coerce)try{a.data=BigInt(a.data)}catch(b){return this._getInvalidInput(a)}if(this._getType(a)!==cq.bigint)return this._getInvalidInput(a);let c=new cz;for(let d of this._def.checks)"min"===d.kind?(d.inclusive?a.data<d.value:a.data<=d.value)&&(cy(b=this._getOrReturnCtx(a,b),{code:cs.too_small,type:"bigint",minimum:d.value,inclusive:d.inclusive,message:d.message}),c.dirty()):"max"===d.kind?(d.inclusive?a.data>d.value:a.data>=d.value)&&(cy(b=this._getOrReturnCtx(a,b),{code:cs.too_big,type:"bigint",maximum:d.value,inclusive:d.inclusive,message:d.message}),c.dirty()):"multipleOf"===d.kind?a.data%d.value!==BigInt(0)&&(cy(b=this._getOrReturnCtx(a,b),{code:cs.not_multiple_of,multipleOf:d.value,message:d.message}),c.dirty()):es.assertNever(d);return{status:c.value,value:a.data}}_getInvalidInput(a){let b=this._getOrReturnCtx(a);return cy(b,{code:cs.invalid_type,expected:cq.bigint,received:b.parsedType}),cA}gte(a,b){return this.setLimit("min",a,!0,eu.toString(b))}gt(a,b){return this.setLimit("min",a,!1,eu.toString(b))}lte(a,b){return this.setLimit("max",a,!0,eu.toString(b))}lt(a,b){return this.setLimit("max",a,!1,eu.toString(b))}setLimit(a,b,c,d){return new c5({...this._def,checks:[...this._def.checks,{kind:a,value:b,inclusive:c,message:eu.toString(d)}]})}_addCheck(a){return new c5({...this._def,checks:[...this._def.checks,a]})}positive(a){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:eu.toString(a)})}negative(a){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:eu.toString(a)})}nonpositive(a){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:eu.toString(a)})}nonnegative(a){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:eu.toString(a)})}multipleOf(a,b){return this._addCheck({kind:"multipleOf",value:a,message:eu.toString(b)})}get minValue(){let a=null;for(let b of this._def.checks)"min"===b.kind&&(null===a||b.value>a)&&(a=b.value);return a}get maxValue(){let a=null;for(let b of this._def.checks)"max"===b.kind&&(null===a||b.value<a)&&(a=b.value);return a}}c5.create=a=>{var b;return new c5({checks:[],typeName:ex.ZodBigInt,coerce:null!=(b=null==a?void 0:a.coerce)&&b,...cL(a)})};class c6 extends cM{_parse(a){if(this._def.coerce&&(a.data=!!a.data),this._getType(a)!==cq.boolean){let b=this._getOrReturnCtx(a);return cy(b,{code:cs.invalid_type,expected:cq.boolean,received:b.parsedType}),cA}return cC(a.data)}}c6.create=a=>new c6({typeName:ex.ZodBoolean,coerce:(null==a?void 0:a.coerce)||!1,...cL(a)});class c7 extends cM{_parse(a){let b;if(this._def.coerce&&(a.data=new Date(a.data)),this._getType(a)!==cq.date){let b=this._getOrReturnCtx(a);return cy(b,{code:cs.invalid_type,expected:cq.date,received:b.parsedType}),cA}if(isNaN(a.data.getTime()))return cy(this._getOrReturnCtx(a),{code:cs.invalid_date}),cA;let c=new cz;for(let d of this._def.checks)"min"===d.kind?a.data.getTime()<d.value&&(cy(b=this._getOrReturnCtx(a,b),{code:cs.too_small,message:d.message,inclusive:!0,exact:!1,minimum:d.value,type:"date"}),c.dirty()):"max"===d.kind?a.data.getTime()>d.value&&(cy(b=this._getOrReturnCtx(a,b),{code:cs.too_big,message:d.message,inclusive:!0,exact:!1,maximum:d.value,type:"date"}),c.dirty()):es.assertNever(d);return{status:c.value,value:new Date(a.data.getTime())}}_addCheck(a){return new c7({...this._def,checks:[...this._def.checks,a]})}min(a,b){return this._addCheck({kind:"min",value:a.getTime(),message:eu.toString(b)})}max(a,b){return this._addCheck({kind:"max",value:a.getTime(),message:eu.toString(b)})}get minDate(){let a=null;for(let b of this._def.checks)"min"===b.kind&&(null===a||b.value>a)&&(a=b.value);return null!=a?new Date(a):null}get maxDate(){let a=null;for(let b of this._def.checks)"max"===b.kind&&(null===a||b.value<a)&&(a=b.value);return null!=a?new Date(a):null}}c7.create=a=>new c7({checks:[],coerce:(null==a?void 0:a.coerce)||!1,typeName:ex.ZodDate,...cL(a)});class c8 extends cM{_parse(a){if(this._getType(a)!==cq.symbol){let b=this._getOrReturnCtx(a);return cy(b,{code:cs.invalid_type,expected:cq.symbol,received:b.parsedType}),cA}return cC(a.data)}}c8.create=a=>new c8({typeName:ex.ZodSymbol,...cL(a)});class c9 extends cM{_parse(a){if(this._getType(a)!==cq.undefined){let b=this._getOrReturnCtx(a);return cy(b,{code:cs.invalid_type,expected:cq.undefined,received:b.parsedType}),cA}return cC(a.data)}}c9.create=a=>new c9({typeName:ex.ZodUndefined,...cL(a)});class da extends cM{_parse(a){if(this._getType(a)!==cq.null){let b=this._getOrReturnCtx(a);return cy(b,{code:cs.invalid_type,expected:cq.null,received:b.parsedType}),cA}return cC(a.data)}}da.create=a=>new da({typeName:ex.ZodNull,...cL(a)});class db extends cM{constructor(){super(...arguments),this._any=!0}_parse(a){return cC(a.data)}}db.create=a=>new db({typeName:ex.ZodAny,...cL(a)});class dc extends cM{constructor(){super(...arguments),this._unknown=!0}_parse(a){return cC(a.data)}}dc.create=a=>new dc({typeName:ex.ZodUnknown,...cL(a)});class dd extends cM{_parse(a){let b=this._getOrReturnCtx(a);return cy(b,{code:cs.invalid_type,expected:cq.never,received:b.parsedType}),cA}}dd.create=a=>new dd({typeName:ex.ZodNever,...cL(a)});class de extends cM{_parse(a){if(this._getType(a)!==cq.undefined){let b=this._getOrReturnCtx(a);return cy(b,{code:cs.invalid_type,expected:cq.void,received:b.parsedType}),cA}return cC(a.data)}}de.create=a=>new de({typeName:ex.ZodVoid,...cL(a)});class df extends cM{_parse(a){let{ctx:b,status:c}=this._processInputParams(a),d=this._def;if(b.parsedType!==cq.array)return cy(b,{code:cs.invalid_type,expected:cq.array,received:b.parsedType}),cA;if(null!==d.exactLength){let a=b.data.length>d.exactLength.value,e=b.data.length<d.exactLength.value;(a||e)&&(cy(b,{code:a?cs.too_big:cs.too_small,minimum:e?d.exactLength.value:void 0,maximum:a?d.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:d.exactLength.message}),c.dirty())}if(null!==d.minLength&&b.data.length<d.minLength.value&&(cy(b,{code:cs.too_small,minimum:d.minLength.value,type:"array",inclusive:!0,exact:!1,message:d.minLength.message}),c.dirty()),null!==d.maxLength&&b.data.length>d.maxLength.value&&(cy(b,{code:cs.too_big,maximum:d.maxLength.value,type:"array",inclusive:!0,exact:!1,message:d.maxLength.message}),c.dirty()),b.common.async)return Promise.all([...b.data].map((a,c)=>d.type._parseAsync(new cJ(b,a,b.path,c)))).then(a=>cz.mergeArray(c,a));let e=[...b.data].map((a,c)=>d.type._parseSync(new cJ(b,a,b.path,c)));return cz.mergeArray(c,e)}get element(){return this._def.type}min(a,b){return new df({...this._def,minLength:{value:a,message:eu.toString(b)}})}max(a,b){return new df({...this._def,maxLength:{value:a,message:eu.toString(b)}})}length(a,b){return new df({...this._def,exactLength:{value:a,message:eu.toString(b)}})}nonempty(a){return this.min(1,a)}}df.create=(a,b)=>new df({type:a,minLength:null,maxLength:null,exactLength:null,typeName:ex.ZodArray,...cL(b)});class dg extends cM{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;let a=this._def.shape(),b=es.objectKeys(a);return this._cached={shape:a,keys:b}}_parse(a){if(this._getType(a)!==cq.object){let b=this._getOrReturnCtx(a);return cy(b,{code:cs.invalid_type,expected:cq.object,received:b.parsedType}),cA}let{status:b,ctx:c}=this._processInputParams(a),{shape:d,keys:e}=this._getCached(),f=[];if(!(this._def.catchall instanceof dd&&"strip"===this._def.unknownKeys))for(let a in c.data)e.includes(a)||f.push(a);let g=[];for(let a of e){let b=d[a],e=c.data[a];g.push({key:{status:"valid",value:a},value:b._parse(new cJ(c,e,c.path,a)),alwaysSet:a in c.data})}if(this._def.catchall instanceof dd){let a=this._def.unknownKeys;if("passthrough"===a)for(let a of f)g.push({key:{status:"valid",value:a},value:{status:"valid",value:c.data[a]}});else if("strict"===a)f.length>0&&(cy(c,{code:cs.unrecognized_keys,keys:f}),b.dirty());else if("strip"===a);else throw Error("Internal ZodObject error: invalid unknownKeys value.")}else{let a=this._def.catchall;for(let b of f){let d=c.data[b];g.push({key:{status:"valid",value:b},value:a._parse(new cJ(c,d,c.path,b)),alwaysSet:b in c.data})}}return c.common.async?Promise.resolve().then(async()=>{let a=[];for(let b of g){let c=await b.key,d=await b.value;a.push({key:c,value:d,alwaysSet:b.alwaysSet})}return a}).then(a=>cz.mergeObjectSync(b,a)):cz.mergeObjectSync(b,g)}get shape(){return this._def.shape()}strict(a){return eu.errToObj,new dg({...this._def,unknownKeys:"strict",...void 0!==a?{errorMap:(b,c)=>{var d,e,f,g;let h=null!=(f=null==(e=(d=this._def).errorMap)?void 0:e.call(d,b,c).message)?f:c.defaultError;return"unrecognized_keys"===b.code?{message:null!=(g=eu.errToObj(a).message)?g:h}:{message:h}}}:{}})}strip(){return new dg({...this._def,unknownKeys:"strip"})}passthrough(){return new dg({...this._def,unknownKeys:"passthrough"})}extend(a){return new dg({...this._def,shape:()=>({...this._def.shape(),...a})})}merge(a){return new dg({unknownKeys:a._def.unknownKeys,catchall:a._def.catchall,shape:()=>({...this._def.shape(),...a._def.shape()}),typeName:ex.ZodObject})}setKey(a,b){return this.augment({[a]:b})}catchall(a){return new dg({...this._def,catchall:a})}pick(a){let b={};return es.objectKeys(a).forEach(c=>{a[c]&&this.shape[c]&&(b[c]=this.shape[c])}),new dg({...this._def,shape:()=>b})}omit(a){let b={};return es.objectKeys(this.shape).forEach(c=>{a[c]||(b[c]=this.shape[c])}),new dg({...this._def,shape:()=>b})}deepPartial(){return function a(b){if(b instanceof dg){let c={};for(let d in b.shape){let e=b.shape[d];c[d]=dy.create(a(e))}return new dg({...b._def,shape:()=>c})}if(b instanceof df)return new df({...b._def,type:a(b.element)});if(b instanceof dy)return dy.create(a(b.unwrap()));if(b instanceof dz)return dz.create(a(b.unwrap()));if(b instanceof dl)return dl.create(b.items.map(b=>a(b)));else return b}(this)}partial(a){let b={};return es.objectKeys(this.shape).forEach(c=>{let d=this.shape[c];a&&!a[c]?b[c]=d:b[c]=d.optional()}),new dg({...this._def,shape:()=>b})}required(a){let b={};return es.objectKeys(this.shape).forEach(c=>{if(a&&!a[c])b[c]=this.shape[c];else{let a=this.shape[c];for(;a instanceof dy;)a=a._def.innerType;b[c]=a}}),new dg({...this._def,shape:()=>b})}keyof(){return dt(es.objectKeys(this.shape))}}dg.create=(a,b)=>new dg({shape:()=>a,unknownKeys:"strip",catchall:dd.create(),typeName:ex.ZodObject,...cL(b)}),dg.strictCreate=(a,b)=>new dg({shape:()=>a,unknownKeys:"strict",catchall:dd.create(),typeName:ex.ZodObject,...cL(b)}),dg.lazycreate=(a,b)=>new dg({shape:a,unknownKeys:"strip",catchall:dd.create(),typeName:ex.ZodObject,...cL(b)});class dh extends cM{_parse(a){let{ctx:b}=this._processInputParams(a),c=this._def.options;if(b.common.async)return Promise.all(c.map(async a=>{let c={...b,common:{...b.common,issues:[]},parent:null};return{result:await a._parseAsync({data:b.data,path:b.path,parent:c}),ctx:c}})).then(function(a){for(let b of a)if("valid"===b.result.status)return b.result;for(let c of a)if("dirty"===c.result.status)return b.common.issues.push(...c.ctx.common.issues),c.result;let c=a.map(a=>new ct(a.ctx.common.issues));return cy(b,{code:cs.invalid_union,unionErrors:c}),cA});{let a,d=[];for(let e of c){let c={...b,common:{...b.common,issues:[]},parent:null},f=e._parseSync({data:b.data,path:b.path,parent:c});if("valid"===f.status)return f;"dirty"!==f.status||a||(a={result:f,ctx:c}),c.common.issues.length&&d.push(c.common.issues)}if(a)return b.common.issues.push(...a.ctx.common.issues),a.result;let e=d.map(a=>new ct(a));return cy(b,{code:cs.invalid_union,unionErrors:e}),cA}}get options(){return this._def.options}}dh.create=(a,b)=>new dh({options:a,typeName:ex.ZodUnion,...cL(b)});let di=a=>{if(a instanceof dr)return di(a.schema);if(a instanceof dx)return di(a.innerType());if(a instanceof ds)return[a.value];if(a instanceof du)return a.options;if(a instanceof dv)return es.objectValues(a.enum);else if(a instanceof dA)return di(a._def.innerType);else if(a instanceof c9)return[void 0];else if(a instanceof da)return[null];else if(a instanceof dy)return[void 0,...di(a.unwrap())];else if(a instanceof dz)return[null,...di(a.unwrap())];else if(a instanceof dE)return di(a.unwrap());else if(a instanceof dG)return di(a.unwrap());else if(a instanceof dB)return di(a._def.innerType);else return[]};class dj extends cM{_parse(a){let{ctx:b}=this._processInputParams(a);if(b.parsedType!==cq.object)return cy(b,{code:cs.invalid_type,expected:cq.object,received:b.parsedType}),cA;let c=this.discriminator,d=b.data[c],e=this.optionsMap.get(d);return e?b.common.async?e._parseAsync({data:b.data,path:b.path,parent:b}):e._parseSync({data:b.data,path:b.path,parent:b}):(cy(b,{code:cs.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[c]}),cA)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(a,b,c){let d=new Map;for(let c of b){let b=di(c.shape[a]);if(!b.length)throw Error(`A discriminator value for key \`${a}\` could not be extracted from all schema options`);for(let e of b){if(d.has(e))throw Error(`Discriminator property ${String(a)} has duplicate value ${String(e)}`);d.set(e,c)}}return new dj({typeName:ex.ZodDiscriminatedUnion,discriminator:a,options:b,optionsMap:d,...cL(c)})}}class dk extends cM{_parse(a){let{status:b,ctx:c}=this._processInputParams(a),d=(a,d)=>{if(cD(a)||cD(d))return cA;let e=function a(b,c){let d=cr(b),e=cr(c);if(b===c)return{valid:!0,data:b};if(d===cq.object&&e===cq.object){let d=es.objectKeys(c),e=es.objectKeys(b).filter(a=>-1!==d.indexOf(a)),f={...b,...c};for(let d of e){let e=a(b[d],c[d]);if(!e.valid)return{valid:!1};f[d]=e.data}return{valid:!0,data:f}}if(d===cq.array&&e===cq.array){if(b.length!==c.length)return{valid:!1};let d=[];for(let e=0;e<b.length;e++){let f=a(b[e],c[e]);if(!f.valid)return{valid:!1};d.push(f.data)}return{valid:!0,data:d}}if(d===cq.date&&e===cq.date&&+b==+c)return{valid:!0,data:b};return{valid:!1}}(a.value,d.value);return e.valid?((cE(a)||cE(d))&&b.dirty(),{status:b.value,value:e.data}):(cy(c,{code:cs.invalid_intersection_types}),cA)};return c.common.async?Promise.all([this._def.left._parseAsync({data:c.data,path:c.path,parent:c}),this._def.right._parseAsync({data:c.data,path:c.path,parent:c})]).then(([a,b])=>d(a,b)):d(this._def.left._parseSync({data:c.data,path:c.path,parent:c}),this._def.right._parseSync({data:c.data,path:c.path,parent:c}))}}dk.create=(a,b,c)=>new dk({left:a,right:b,typeName:ex.ZodIntersection,...cL(c)});class dl extends cM{_parse(a){let{status:b,ctx:c}=this._processInputParams(a);if(c.parsedType!==cq.array)return cy(c,{code:cs.invalid_type,expected:cq.array,received:c.parsedType}),cA;if(c.data.length<this._def.items.length)return cy(c,{code:cs.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),cA;!this._def.rest&&c.data.length>this._def.items.length&&(cy(c,{code:cs.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),b.dirty());let d=[...c.data].map((a,b)=>{let d=this._def.items[b]||this._def.rest;return d?d._parse(new cJ(c,a,c.path,b)):null}).filter(a=>!!a);return c.common.async?Promise.all(d).then(a=>cz.mergeArray(b,a)):cz.mergeArray(b,d)}get items(){return this._def.items}rest(a){return new dl({...this._def,rest:a})}}dl.create=(a,b)=>{if(!Array.isArray(a))throw Error("You must pass an array of schemas to z.tuple([ ... ])");return new dl({items:a,typeName:ex.ZodTuple,rest:null,...cL(b)})};class dm extends cM{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(a){let{status:b,ctx:c}=this._processInputParams(a);if(c.parsedType!==cq.object)return cy(c,{code:cs.invalid_type,expected:cq.object,received:c.parsedType}),cA;let d=[],e=this._def.keyType,f=this._def.valueType;for(let a in c.data)d.push({key:e._parse(new cJ(c,a,c.path,a)),value:f._parse(new cJ(c,c.data[a],c.path,a)),alwaysSet:a in c.data});return c.common.async?cz.mergeObjectAsync(b,d):cz.mergeObjectSync(b,d)}get element(){return this._def.valueType}static create(a,b,c){return new dm(b instanceof cM?{keyType:a,valueType:b,typeName:ex.ZodRecord,...cL(c)}:{keyType:c3.create(),valueType:a,typeName:ex.ZodRecord,...cL(b)})}}class dn extends cM{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(a){let{status:b,ctx:c}=this._processInputParams(a);if(c.parsedType!==cq.map)return cy(c,{code:cs.invalid_type,expected:cq.map,received:c.parsedType}),cA;let d=this._def.keyType,e=this._def.valueType,f=[...c.data.entries()].map(([a,b],f)=>({key:d._parse(new cJ(c,a,c.path,[f,"key"])),value:e._parse(new cJ(c,b,c.path,[f,"value"]))}));if(c.common.async){let a=new Map;return Promise.resolve().then(async()=>{for(let c of f){let d=await c.key,e=await c.value;if("aborted"===d.status||"aborted"===e.status)return cA;("dirty"===d.status||"dirty"===e.status)&&b.dirty(),a.set(d.value,e.value)}return{status:b.value,value:a}})}{let a=new Map;for(let c of f){let d=c.key,e=c.value;if("aborted"===d.status||"aborted"===e.status)return cA;("dirty"===d.status||"dirty"===e.status)&&b.dirty(),a.set(d.value,e.value)}return{status:b.value,value:a}}}}dn.create=(a,b,c)=>new dn({valueType:b,keyType:a,typeName:ex.ZodMap,...cL(c)});class dp extends cM{_parse(a){let{status:b,ctx:c}=this._processInputParams(a);if(c.parsedType!==cq.set)return cy(c,{code:cs.invalid_type,expected:cq.set,received:c.parsedType}),cA;let d=this._def;null!==d.minSize&&c.data.size<d.minSize.value&&(cy(c,{code:cs.too_small,minimum:d.minSize.value,type:"set",inclusive:!0,exact:!1,message:d.minSize.message}),b.dirty()),null!==d.maxSize&&c.data.size>d.maxSize.value&&(cy(c,{code:cs.too_big,maximum:d.maxSize.value,type:"set",inclusive:!0,exact:!1,message:d.maxSize.message}),b.dirty());let e=this._def.valueType;function f(a){let c=new Set;for(let d of a){if("aborted"===d.status)return cA;"dirty"===d.status&&b.dirty(),c.add(d.value)}return{status:b.value,value:c}}let g=[...c.data.values()].map((a,b)=>e._parse(new cJ(c,a,c.path,b)));return c.common.async?Promise.all(g).then(a=>f(a)):f(g)}min(a,b){return new dp({...this._def,minSize:{value:a,message:eu.toString(b)}})}max(a,b){return new dp({...this._def,maxSize:{value:a,message:eu.toString(b)}})}size(a,b){return this.min(a,b).max(a,b)}nonempty(a){return this.min(1,a)}}dp.create=(a,b)=>new dp({valueType:a,minSize:null,maxSize:null,typeName:ex.ZodSet,...cL(b)});class dq extends cM{constructor(){super(...arguments),this.validate=this.implement}_parse(a){let{ctx:b}=this._processInputParams(a);if(b.parsedType!==cq.function)return cy(b,{code:cs.invalid_type,expected:cq.function,received:b.parsedType}),cA;function c(a,c){return cx({data:a,path:b.path,errorMaps:[b.common.contextualErrorMap,b.schemaErrorMap,cw(),cu].filter(a=>!!a),issueData:{code:cs.invalid_arguments,argumentsError:c}})}function d(a,c){return cx({data:a,path:b.path,errorMaps:[b.common.contextualErrorMap,b.schemaErrorMap,cw(),cu].filter(a=>!!a),issueData:{code:cs.invalid_return_type,returnTypeError:c}})}let e={errorMap:b.common.contextualErrorMap},f=b.data;if(this._def.returns instanceof dw){let a=this;return cC(async function(...b){let g=new ct([]),h=await a._def.args.parseAsync(b,e).catch(a=>{throw g.addIssue(c(b,a)),g}),i=await Reflect.apply(f,this,h);return await a._def.returns._def.type.parseAsync(i,e).catch(a=>{throw g.addIssue(d(i,a)),g})})}{let a=this;return cC(function(...b){let g=a._def.args.safeParse(b,e);if(!g.success)throw new ct([c(b,g.error)]);let h=Reflect.apply(f,this,g.data),i=a._def.returns.safeParse(h,e);if(!i.success)throw new ct([d(h,i.error)]);return i.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...a){return new dq({...this._def,args:dl.create(a).rest(dc.create())})}returns(a){return new dq({...this._def,returns:a})}implement(a){return this.parse(a)}strictImplement(a){return this.parse(a)}static create(a,b,c){return new dq({args:a||dl.create([]).rest(dc.create()),returns:b||dc.create(),typeName:ex.ZodFunction,...cL(c)})}}class dr extends cM{get schema(){return this._def.getter()}_parse(a){let{ctx:b}=this._processInputParams(a);return this._def.getter()._parse({data:b.data,path:b.path,parent:b})}}dr.create=(a,b)=>new dr({getter:a,typeName:ex.ZodLazy,...cL(b)});class ds extends cM{_parse(a){if(a.data!==this._def.value){let b=this._getOrReturnCtx(a);return cy(b,{received:b.data,code:cs.invalid_literal,expected:this._def.value}),cA}return{status:"valid",value:a.data}}get value(){return this._def.value}}function dt(a,b){return new du({values:a,typeName:ex.ZodEnum,...cL(b)})}ds.create=(a,b)=>new ds({value:a,typeName:ex.ZodLiteral,...cL(b)});class du extends cM{constructor(){super(...arguments),ev.set(this,void 0)}_parse(a){if("string"!=typeof a.data){let b=this._getOrReturnCtx(a),c=this._def.values;return cy(b,{expected:es.joinValues(c),received:b.parsedType,code:cs.invalid_type}),cA}if(cH(this,ev,"f")||cI(this,ev,new Set(this._def.values),"f"),!cH(this,ev,"f").has(a.data)){let b=this._getOrReturnCtx(a),c=this._def.values;return cy(b,{received:b.data,code:cs.invalid_enum_value,options:c}),cA}return cC(a.data)}get options(){return this._def.values}get enum(){let a={};for(let b of this._def.values)a[b]=b;return a}get Values(){let a={};for(let b of this._def.values)a[b]=b;return a}get Enum(){let a={};for(let b of this._def.values)a[b]=b;return a}extract(a,b=this._def){return du.create(a,{...this._def,...b})}exclude(a,b=this._def){return du.create(this.options.filter(b=>!a.includes(b)),{...this._def,...b})}}ev=new WeakMap,du.create=dt;class dv extends cM{constructor(){super(...arguments),ew.set(this,void 0)}_parse(a){let b=es.getValidEnumValues(this._def.values),c=this._getOrReturnCtx(a);if(c.parsedType!==cq.string&&c.parsedType!==cq.number){let a=es.objectValues(b);return cy(c,{expected:es.joinValues(a),received:c.parsedType,code:cs.invalid_type}),cA}if(cH(this,ew,"f")||cI(this,ew,new Set(es.getValidEnumValues(this._def.values)),"f"),!cH(this,ew,"f").has(a.data)){let a=es.objectValues(b);return cy(c,{received:c.data,code:cs.invalid_enum_value,options:a}),cA}return cC(a.data)}get enum(){return this._def.values}}ew=new WeakMap,dv.create=(a,b)=>new dv({values:a,typeName:ex.ZodNativeEnum,...cL(b)});class dw extends cM{unwrap(){return this._def.type}_parse(a){let{ctx:b}=this._processInputParams(a);return b.parsedType!==cq.promise&&!1===b.common.async?(cy(b,{code:cs.invalid_type,expected:cq.promise,received:b.parsedType}),cA):cC((b.parsedType===cq.promise?b.data:Promise.resolve(b.data)).then(a=>this._def.type.parseAsync(a,{path:b.path,errorMap:b.common.contextualErrorMap})))}}dw.create=(a,b)=>new dw({type:a,typeName:ex.ZodPromise,...cL(b)});class dx extends cM{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===ex.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(a){let{status:b,ctx:c}=this._processInputParams(a),d=this._def.effect||null,e={addIssue:a=>{cy(c,a),a.fatal?b.abort():b.dirty()},get path(){return c.path}};if(e.addIssue=e.addIssue.bind(e),"preprocess"===d.type){let a=d.transform(c.data,e);if(c.common.async)return Promise.resolve(a).then(async a=>{if("aborted"===b.value)return cA;let d=await this._def.schema._parseAsync({data:a,path:c.path,parent:c});return"aborted"===d.status?cA:"dirty"===d.status||"dirty"===b.value?cB(d.value):d});{if("aborted"===b.value)return cA;let d=this._def.schema._parseSync({data:a,path:c.path,parent:c});return"aborted"===d.status?cA:"dirty"===d.status||"dirty"===b.value?cB(d.value):d}}if("refinement"===d.type){let a=a=>{let b=d.refinement(a,e);if(c.common.async)return Promise.resolve(b);if(b instanceof Promise)throw Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(!1!==c.common.async)return this._def.schema._parseAsync({data:c.data,path:c.path,parent:c}).then(c=>"aborted"===c.status?cA:("dirty"===c.status&&b.dirty(),a(c.value).then(()=>({status:b.value,value:c.value}))));{let d=this._def.schema._parseSync({data:c.data,path:c.path,parent:c});return"aborted"===d.status?cA:("dirty"===d.status&&b.dirty(),a(d.value),{status:b.value,value:d.value})}}if("transform"===d.type)if(!1!==c.common.async)return this._def.schema._parseAsync({data:c.data,path:c.path,parent:c}).then(a=>cF(a)?Promise.resolve(d.transform(a.value,e)).then(a=>({status:b.value,value:a})):a);else{let a=this._def.schema._parseSync({data:c.data,path:c.path,parent:c});if(!cF(a))return a;let f=d.transform(a.value,e);if(f instanceof Promise)throw Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:b.value,value:f}}es.assertNever(d)}}dx.create=(a,b,c)=>new dx({schema:a,typeName:ex.ZodEffects,effect:b,...cL(c)}),dx.createWithPreprocess=(a,b,c)=>new dx({schema:b,effect:{type:"preprocess",transform:a},typeName:ex.ZodEffects,...cL(c)});class dy extends cM{_parse(a){return this._getType(a)===cq.undefined?cC(void 0):this._def.innerType._parse(a)}unwrap(){return this._def.innerType}}dy.create=(a,b)=>new dy({innerType:a,typeName:ex.ZodOptional,...cL(b)});class dz extends cM{_parse(a){return this._getType(a)===cq.null?cC(null):this._def.innerType._parse(a)}unwrap(){return this._def.innerType}}dz.create=(a,b)=>new dz({innerType:a,typeName:ex.ZodNullable,...cL(b)});class dA extends cM{_parse(a){let{ctx:b}=this._processInputParams(a),c=b.data;return b.parsedType===cq.undefined&&(c=this._def.defaultValue()),this._def.innerType._parse({data:c,path:b.path,parent:b})}removeDefault(){return this._def.innerType}}dA.create=(a,b)=>new dA({innerType:a,typeName:ex.ZodDefault,defaultValue:"function"==typeof b.default?b.default:()=>b.default,...cL(b)});class dB extends cM{_parse(a){let{ctx:b}=this._processInputParams(a),c={...b,common:{...b.common,issues:[]}},d=this._def.innerType._parse({data:c.data,path:c.path,parent:{...c}});return cG(d)?d.then(a=>({status:"valid",value:"valid"===a.status?a.value:this._def.catchValue({get error(){return new ct(c.common.issues)},input:c.data})})):{status:"valid",value:"valid"===d.status?d.value:this._def.catchValue({get error(){return new ct(c.common.issues)},input:c.data})}}removeCatch(){return this._def.innerType}}dB.create=(a,b)=>new dB({innerType:a,typeName:ex.ZodCatch,catchValue:"function"==typeof b.catch?b.catch:()=>b.catch,...cL(b)});class dC extends cM{_parse(a){if(this._getType(a)!==cq.nan){let b=this._getOrReturnCtx(a);return cy(b,{code:cs.invalid_type,expected:cq.nan,received:b.parsedType}),cA}return{status:"valid",value:a.data}}}dC.create=a=>new dC({typeName:ex.ZodNaN,...cL(a)});let dD=Symbol("zod_brand");class dE extends cM{_parse(a){let{ctx:b}=this._processInputParams(a),c=b.data;return this._def.type._parse({data:c,path:b.path,parent:b})}unwrap(){return this._def.type}}class dF extends cM{_parse(a){let{status:b,ctx:c}=this._processInputParams(a);if(c.common.async)return(async()=>{let a=await this._def.in._parseAsync({data:c.data,path:c.path,parent:c});return"aborted"===a.status?cA:"dirty"===a.status?(b.dirty(),cB(a.value)):this._def.out._parseAsync({data:a.value,path:c.path,parent:c})})();{let a=this._def.in._parseSync({data:c.data,path:c.path,parent:c});return"aborted"===a.status?cA:"dirty"===a.status?(b.dirty(),{status:"dirty",value:a.value}):this._def.out._parseSync({data:a.value,path:c.path,parent:c})}}static create(a,b){return new dF({in:a,out:b,typeName:ex.ZodPipeline})}}class dG extends cM{_parse(a){let b=this._def.innerType._parse(a),c=a=>(cF(a)&&(a.value=Object.freeze(a.value)),a);return cG(b)?b.then(a=>c(a)):c(b)}unwrap(){return this._def.innerType}}function dH(a,b){let c="function"==typeof a?a(b):"string"==typeof a?{message:a}:a;return"string"==typeof c?{message:c}:c}function dI(a,b={},c){return a?db.create().superRefine((d,e)=>{var f,g;let h=a(d);if(h instanceof Promise)return h.then(a=>{var f,g;if(!a){let a=dH(b,d),h=null==(g=null!=(f=a.fatal)?f:c)||g;e.addIssue({code:"custom",...a,fatal:h})}});if(!h){let a=dH(b,d),h=null==(g=null!=(f=a.fatal)?f:c)||g;e.addIssue({code:"custom",...a,fatal:h})}}):db.create()}dG.create=(a,b)=>new dG({innerType:a,typeName:ex.ZodReadonly,...cL(b)});let dJ={object:dg.lazycreate};!function(a){a.ZodString="ZodString",a.ZodNumber="ZodNumber",a.ZodNaN="ZodNaN",a.ZodBigInt="ZodBigInt",a.ZodBoolean="ZodBoolean",a.ZodDate="ZodDate",a.ZodSymbol="ZodSymbol",a.ZodUndefined="ZodUndefined",a.ZodNull="ZodNull",a.ZodAny="ZodAny",a.ZodUnknown="ZodUnknown",a.ZodNever="ZodNever",a.ZodVoid="ZodVoid",a.ZodArray="ZodArray",a.ZodObject="ZodObject",a.ZodUnion="ZodUnion",a.ZodDiscriminatedUnion="ZodDiscriminatedUnion",a.ZodIntersection="ZodIntersection",a.ZodTuple="ZodTuple",a.ZodRecord="ZodRecord",a.ZodMap="ZodMap",a.ZodSet="ZodSet",a.ZodFunction="ZodFunction",a.ZodLazy="ZodLazy",a.ZodLiteral="ZodLiteral",a.ZodEnum="ZodEnum",a.ZodEffects="ZodEffects",a.ZodNativeEnum="ZodNativeEnum",a.ZodOptional="ZodOptional",a.ZodNullable="ZodNullable",a.ZodDefault="ZodDefault",a.ZodCatch="ZodCatch",a.ZodPromise="ZodPromise",a.ZodBranded="ZodBranded",a.ZodPipeline="ZodPipeline",a.ZodReadonly="ZodReadonly"}(ex||(ex={}));let dK=c3.create,dL=c4.create,dM=dC.create,dN=c5.create,dO=c6.create,dP=c7.create,dQ=c8.create,dR=c9.create,dS=da.create,dT=db.create,dU=dc.create,dV=dd.create,dW=de.create,dX=df.create,dY=dg.create,dZ=dg.strictCreate,d$=dh.create,d_=dj.create,d0=dk.create,d1=dl.create,d2=dm.create,d3=dn.create,d4=dp.create,d5=dq.create,d6=dr.create,d7=ds.create,d8=du.create,d9=dv.create,ea=dw.create,eb=dx.create,ec=dy.create,ed=dz.create,ee=dx.createWithPreprocess,ef=dF.create;var eg=Object.freeze({__proto__:null,defaultErrorMap:cu,setErrorMap:function(a){cv=a},getErrorMap:cw,makeIssue:cx,EMPTY_PATH:[],addIssueToContext:cy,ParseStatus:cz,INVALID:cA,DIRTY:cB,OK:cC,isAborted:cD,isDirty:cE,isValid:cF,isAsync:cG,get util(){return es},get objectUtil(){return et},ZodParsedType:cq,getParsedType:cr,ZodType:cM,datetimeRegex:c2,ZodString:c3,ZodNumber:c4,ZodBigInt:c5,ZodBoolean:c6,ZodDate:c7,ZodSymbol:c8,ZodUndefined:c9,ZodNull:da,ZodAny:db,ZodUnknown:dc,ZodNever:dd,ZodVoid:de,ZodArray:df,ZodObject:dg,ZodUnion:dh,ZodDiscriminatedUnion:dj,ZodIntersection:dk,ZodTuple:dl,ZodRecord:dm,ZodMap:dn,ZodSet:dp,ZodFunction:dq,ZodLazy:dr,ZodLiteral:ds,ZodEnum:du,ZodNativeEnum:dv,ZodPromise:dw,ZodEffects:dx,ZodTransformer:dx,ZodOptional:dy,ZodNullable:dz,ZodDefault:dA,ZodCatch:dB,ZodNaN:dC,BRAND:dD,ZodBranded:dE,ZodPipeline:dF,ZodReadonly:dG,custom:dI,Schema:cM,ZodSchema:cM,late:dJ,get ZodFirstPartyTypeKind(){return ex},coerce:{string:a=>c3.create({...a,coerce:!0}),number:a=>c4.create({...a,coerce:!0}),boolean:a=>c6.create({...a,coerce:!0}),bigint:a=>c5.create({...a,coerce:!0}),date:a=>c7.create({...a,coerce:!0})},any:dT,array:dX,bigint:dN,boolean:dO,date:dP,discriminatedUnion:d_,effect:eb,enum:d8,function:d5,instanceof:(a,b={message:`Input not instance of ${a.name}`})=>dI(b=>b instanceof a,b),intersection:d0,lazy:d6,literal:d7,map:d3,nan:dM,nativeEnum:d9,never:dV,null:dS,nullable:ed,number:dL,object:dY,oboolean:()=>dO().optional(),onumber:()=>dL().optional(),optional:ec,ostring:()=>dK().optional(),pipeline:ef,preprocess:ee,promise:ea,record:d2,set:d4,strictObject:dZ,string:dK,symbol:dQ,transformer:eb,tuple:d1,undefined:dR,union:d$,unknown:dU,void:dW,NEVER:cA,ZodIssueCode:cs,quotelessJson:a=>JSON.stringify(a,null,2).replace(/"([^"]+)":/g,"$1:"),ZodError:ct});let eh={INT8_MIN:-128,INT8_MAX:127,INT8_UNSIGNED_MAX:255,INT16_MIN:-32768,INT16_MAX:32767,INT16_UNSIGNED_MAX:65535,INT24_MIN:-8388608,INT24_MAX:8388607,INT24_UNSIGNED_MAX:0xffffff,INT32_MIN:-0x80000000,INT32_MAX:0x7fffffff,INT32_UNSIGNED_MAX:0xffffffff,INT48_MIN:-0x800000000000,INT48_MAX:0x7fffffffffff,INT48_UNSIGNED_MAX:0xffffffffffff,INT64_MIN:-0x8000000000000000n,INT64_MAX:0x7fffffffffffffffn,INT64_UNSIGNED_MAX:0xffffffffffffffffn};function ei(a,b){return b.includes(a.columnType)}let ej=eg.union([eg.string(),eg.number(),eg.boolean(),eg.null()]),ek=eg.union([ej,eg.record(eg.any()),eg.array(eg.any())]),el=eg.custom(a=>a instanceof Buffer);function em(a){return af(a)?ax(a):a[X].selectedFields}let en={never:a=>a?.generated?.type==="always"||a?.generatedIdentity?.type==="always",optional:a=>!a.notNull||a.notNull&&a.hasDefault,nullable:a=>!a.notNull},eo=(a,b)=>(function a(b,c,d,e){let f={};for(let[g,h]of Object.entries(b)){if(!z(h,B)&&!z(h,ak)&&!z(h,ak.Aliased)&&"object"==typeof h){let b=af(h)||"object"==typeof h&&null!==h&&as in h?em(h):h;f[g]=a(b,c[g]??{},d,e);continue}let b=c[g];if(void 0!==b&&"function"!=typeof b){f[g]=b;continue}let i=z(h,B)?h:void 0,j=i?function a(b,c){let d,e=c?.zodInstance??eg,f=c?.coerce??{};return"enumValues"in b&&Array.isArray(b.enumValues)&&b.enumValues.length>0&&(d=b.enumValues.length?e.enum(b.enumValues):e.string()),d||(ei(b,["PgGeometry","PgPointTuple"])?d=e.tuple([e.number(),e.number()]):ei(b,["PgGeometryObject","PgPointObject"])?d=e.object({x:e.number(),y:e.number()}):ei(b,["PgHalfVector","PgVector"])?(d=e.array(e.number()),d=b.dimensions?d.length(b.dimensions):d):ei(b,["PgLine"])?d=e.tuple([e.number(),e.number(),e.number()]):ei(b,["PgLineABC"])?d=e.object({a:e.number(),b:e.number(),c:e.number()}):ei(b,["PgArray"])?(d=e.array(a(b.baseColumn,e)),d=b.size?d.length(b.size):d):"array"===b.dataType?d=e.array(e.any()):"number"===b.dataType?d=function(a,b,c){let d,e,f=a.getSQLType().includes("unsigned"),g=!1;ei(a,["MySqlTinyInt","SingleStoreTinyInt"])?(d=f?0:eh.INT8_MIN,e=f?eh.INT8_UNSIGNED_MAX:eh.INT8_MAX,g=!0):ei(a,["PgSmallInt","PgSmallSerial","MySqlSmallInt","SingleStoreSmallInt"])?(d=f?0:eh.INT16_MIN,e=f?eh.INT16_UNSIGNED_MAX:eh.INT16_MAX,g=!0):ei(a,["PgReal","MySqlFloat","MySqlMediumInt","SingleStoreMediumInt","SingleStoreFloat"])?(d=f?0:eh.INT24_MIN,e=f?eh.INT24_UNSIGNED_MAX:eh.INT24_MAX,g=ei(a,["MySqlMediumInt","SingleStoreMediumInt"])):ei(a,["PgInteger","PgSerial","MySqlInt","SingleStoreInt"])?(d=f?0:eh.INT32_MIN,e=f?eh.INT32_UNSIGNED_MAX:eh.INT32_MAX,g=!0):ei(a,["PgDoublePrecision","MySqlReal","MySqlDouble","SingleStoreReal","SingleStoreDouble","SQLiteReal"])?(d=f?0:eh.INT48_MIN,e=f?eh.INT48_UNSIGNED_MAX:eh.INT48_MAX):ei(a,["PgBigInt53","PgBigSerial53","MySqlBigInt53","MySqlSerial","SingleStoreBigInt53","SingleStoreSerial","SQLiteInteger"])?(d=(f=f||ei(a,["MySqlSerial","SingleStoreSerial"]))?0:Number.MIN_SAFE_INTEGER,e=Number.MAX_SAFE_INTEGER,g=!0):ei(a,["MySqlYear","SingleStoreYear"])?(d=1901,e=2155,g=!0):(d=Number.MIN_SAFE_INTEGER,e=Number.MAX_SAFE_INTEGER);let h=!0===c||c?.number?b.coerce.number():b.number();return h=h.min(d).max(e),g?h.int():h}(b,e,f):"bigint"===b.dataType?d=function(a,b,c){let d=a.getSQLType().includes("unsigned"),e=d?0n:eh.INT64_MIN,f=d?eh.INT64_UNSIGNED_MAX:eh.INT64_MAX;return(!0===c||c?.bigint?b.coerce.bigint():b.bigint()).min(e).max(f)}(b,e,f):"boolean"===b.dataType?d=!0===f||f.boolean?e.coerce.boolean():e.boolean():"date"===b.dataType?d=!0===f||f.date?e.coerce.date():e.date():"string"===b.dataType?d=function(a,b,c){let d,e;if(ei(a,["PgUUID"]))return b.string().uuid();let f=!1;ei(a,["PgVarchar","SQLiteText"])?d=a.length:ei(a,["MySqlVarChar","SingleStoreVarChar"])?d=a.length??eh.INT16_UNSIGNED_MAX:ei(a,["MySqlText","SingleStoreText"])&&(d="longtext"===a.textType?eh.INT32_UNSIGNED_MAX:"mediumtext"===a.textType?eh.INT24_UNSIGNED_MAX:"text"===a.textType?eh.INT16_UNSIGNED_MAX:eh.INT8_UNSIGNED_MAX),ei(a,["PgChar","MySqlChar","SingleStoreChar"])&&(d=a.length,f=!0),ei(a,["PgBinaryVector"])&&(e=/^[01]+$/,d=a.dimensions);let g=!0===c||c?.string?b.coerce.string():b.string();return g=e?g.regex(e):g,d&&f?g.length(d):d?g.max(d):g}(b,e,f):"json"===b.dataType?d=ek:"custom"===b.dataType?d=e.any():"buffer"===b.dataType&&(d=el)),d||(d=e.any()),d}(i,e):eg.any(),k="function"==typeof b?b(j):j;!d.never(i)&&(f[g]=k,i&&(d.nullable(i)&&(f[g]=f[g].nullable()),d.optional(i)&&(f[g]=f[g].optional())))}return eg.object(f)})(em(a),b??{},en),ep=cp("users",{id:b9("id").primaryKey().default(ap`gen_random_uuid()`),username:bX("username").notNull().unique(),email:bX("email").notNull().unique(),createdAt:b3("created_at").defaultNow()}),eq=cp("image_generations",{id:b9("id").primaryKey().default(ap`gen_random_uuid()`),userId:b9("user_id").references(()=>ep.id),prompt:bX("prompt").notNull(),originalImageUrl:bX("original_image_url"),generatedImageUrl:bX("generated_image_url").notNull(),model:bX("model").notNull().default("nano-banana"),dimensions:bX("dimensions").notNull().default("1024x1024"),style:bX("style").notNull().default("realistic"),status:bX("status").notNull().default("pending"),metadata:bi("metadata"),createdAt:b3("created_at").defaultNow()});eo(ep).pick({username:!0,email:!0}),eo(eq).pick({prompt:!0,originalImageUrl:!0,model:!0,dimensions:!0,style:!0,metadata:!0});let er=eg.object({prompt:eg.string().min(1).max(500),originalImageUrl:eg.string().optional(),model:eg.string().default("nano-banana"),dimensions:eg.string().default("1024x1024"),style:eg.string().default("realistic")});var es,et,eu,ev,ew,ex,ey,ez,eA,eB,eC,eD=Object.create,eE=Object.defineProperty,eF=Object.getOwnPropertyDescriptor,eG=Object.getOwnPropertyNames,eH=Object.getPrototypeOf,eI=Object.prototype.hasOwnProperty,eJ=(a,b)=>eE(a,"name",{value:b,configurable:!0}),eK=(a,b)=>()=>(a&&(b=a(a=0)),b),eL=(a,b)=>()=>(b||a((b={exports:{}}).exports,b),b.exports),eM=(a,b)=>{for(var c in b)eE(a,c,{get:b[c],enumerable:!0})},eN=(a,b,c,d)=>{if(b&&"object"==typeof b||"function"==typeof b)for(let e of eG(b))eI.call(a,e)||e===c||eE(a,e,{get:()=>b[e],enumerable:!(d=eF(b,e))||d.enumerable});return a},eO=(a,b,c)=>(c=null!=a?eD(eH(a)):{},eN(!b&&a&&a.__esModule?c:eE(c,"default",{value:a,enumerable:!0}),a)),eP=a=>eN(eE({},"__esModule",{value:!0}),a),eQ=(a,b,c)=>((a,b,c)=>b in a?eE(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c)(a,"symbol"!=typeof b?b+"":b,c),eR=eL(a=>{eU(),a.byteLength=i,a.toByteArray=k,a.fromByteArray=n;var b,c,d=[],e=[],f="u">typeof Uint8Array?Uint8Array:Array,g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(b=0,c=g.length;b<c;++b)d[b]=g[b],e[g.charCodeAt(b)]=b;function h(a){var b=a.length;if(b%4>0)throw Error("Invalid string. Length must be a multiple of 4");var c=a.indexOf("=");-1===c&&(c=b);var d=c===b?0:4-c%4;return[c,d]}function i(a){var b=h(a),c=b[0],d=b[1];return(c+d)*3/4-d}function j(a,b,c){return(b+c)*3/4-c}function k(a){var b,c,d=h(a),g=d[0],i=d[1],k=new f(j(a,g,i)),l=0,m=i>0?g-4:g;for(c=0;c<m;c+=4)b=e[a.charCodeAt(c)]<<18|e[a.charCodeAt(c+1)]<<12|e[a.charCodeAt(c+2)]<<6|e[a.charCodeAt(c+3)],k[l++]=b>>16&255,k[l++]=b>>8&255,k[l++]=255&b;return 2===i&&(b=e[a.charCodeAt(c)]<<2|e[a.charCodeAt(c+1)]>>4,k[l++]=255&b),1===i&&(b=e[a.charCodeAt(c)]<<10|e[a.charCodeAt(c+1)]<<4|e[a.charCodeAt(c+2)]>>2,k[l++]=b>>8&255,k[l++]=255&b),k}function l(a){return d[a>>18&63]+d[a>>12&63]+d[a>>6&63]+d[63&a]}function m(a,b,c){for(var d=[],e=b;e<c;e+=3)d.push(l((a[e]<<16&0xff0000)+(a[e+1]<<8&65280)+(255&a[e+2])));return d.join("")}function n(a){for(var b,c=a.length,e=c%3,f=[],g=0,h=c-e;g<h;g+=16383)f.push(m(a,g,g+16383>h?h:g+16383));return 1===e?f.push(d[(b=a[c-1])>>2]+d[b<<4&63]+"=="):2===e&&f.push(d[(b=(a[c-2]<<8)+a[c-1])>>10]+d[b>>4&63]+d[b<<2&63]+"="),f.join("")}e[45]=62,e[95]=63,eJ(h,"getLens"),eJ(i,"byteLength"),eJ(j,"_byteLength"),eJ(k,"toByteArray"),eJ(l,"tripletToBase64"),eJ(m,"encodeChunk"),eJ(n,"fromByteArray")}),eS=eL(a=>{eU(),a.read=function(a,b,c,d,e){var f,g,h=8*e-d-1,i=(1<<h)-1,j=i>>1,k=-7,l=c?e-1:0,m=c?-1:1,n=a[b+l];for(l+=m,f=n&(1<<-k)-1,n>>=-k,k+=h;k>0;f=256*f+a[b+l],l+=m,k-=8);for(g=f&(1<<-k)-1,f>>=-k,k+=d;k>0;g=256*g+a[b+l],l+=m,k-=8);if(0===f)f=1-j;else{if(f===i)return g?NaN:1/0*(n?-1:1);g+=Math.pow(2,d),f-=j}return(n?-1:1)*g*Math.pow(2,f-d)},a.write=function(a,b,c,d,e,f){var g,h,i,j=8*f-e-1,k=(1<<j)-1,l=k>>1,m=5960464477539062e-23*(23===e),n=d?0:f-1,o=d?1:-1,p=+(b<0||0===b&&1/b<0);for(isNaN(b=Math.abs(b))||b===1/0?(h=+!!isNaN(b),g=k):(g=Math.floor(Math.log(b)/Math.LN2),b*(i=Math.pow(2,-g))<1&&(g--,i*=2),g+l>=1?b+=m/i:b+=m*Math.pow(2,1-l),b*i>=2&&(g++,i/=2),g+l>=k?(h=0,g=k):g+l>=1?(h=(b*i-1)*Math.pow(2,e),g+=l):(h=b*Math.pow(2,l-1)*Math.pow(2,e),g=0));e>=8;a[c+n]=255&h,n+=o,h/=256,e-=8);for(g=g<<e|h,j+=e;j>0;a[c+n]=255&g,n+=o,g/=256,j-=8);a[c+n-o]|=128*p}}),eT=eL(a=>{eU();var b=eR(),c=eS(),d="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;function e(){try{let a=new Uint8Array(1),b={foo:eJ(function(){return 42},"foo")};return Object.setPrototypeOf(b,Uint8Array.prototype),Object.setPrototypeOf(a,b),42===a.foo()}catch{return!1}}function f(a){if(a>0x7fffffff)throw RangeError('The value "'+a+'" is invalid for option "size"');let b=new Uint8Array(a);return Object.setPrototypeOf(b,g.prototype),b}function g(a,b,c){if("number"==typeof a){if("string"==typeof b)throw TypeError('The "string" argument must be of type string. Received type number');return k(a)}return h(a,b,c)}function h(a,b,c){if("string"==typeof a)return l(a,b);if(ArrayBuffer.isView(a))return n(a);if(null==a)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof a);if(ac(a,ArrayBuffer)||a&&ac(a.buffer,ArrayBuffer)||"u">typeof SharedArrayBuffer&&(ac(a,SharedArrayBuffer)||a&&ac(a.buffer,SharedArrayBuffer)))return o(a,b,c);if("number"==typeof a)throw TypeError('The "value" argument must not be of type number. Received type number');let d=a.valueOf&&a.valueOf();if(null!=d&&d!==a)return g.from(d,b,c);let e=p(a);if(e)return e;if("u">typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof a[Symbol.toPrimitive])return g.from(a[Symbol.toPrimitive]("string"),b,c);throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof a)}function i(a){if("number"!=typeof a)throw TypeError('"size" argument must be of type number');if(a<0)throw RangeError('The value "'+a+'" is invalid for option "size"')}function j(a,b,c){return i(a),a<=0?f(a):void 0!==b?"string"==typeof c?f(a).fill(b,c):f(a).fill(b):f(a)}function k(a){return i(a),f(a<0?0:0|q(a))}function l(a,b){if(("string"!=typeof b||""===b)&&(b="utf8"),!g.isEncoding(b))throw TypeError("Unknown encoding: "+b);let c=0|s(a,b),d=f(c),e=d.write(a,b);return e!==c&&(d=d.slice(0,e)),d}function m(a){let b=a.length<0?0:0|q(a.length),c=f(b);for(let d=0;d<b;d+=1)c[d]=255&a[d];return c}function n(a){if(ac(a,Uint8Array)){let b=new Uint8Array(a);return o(b.buffer,b.byteOffset,b.byteLength)}return m(a)}function o(a,b,c){let d;if(b<0||a.byteLength<b)throw RangeError('"offset" is outside of buffer bounds');if(a.byteLength<b+(c||0))throw RangeError('"length" is outside of buffer bounds');return Object.setPrototypeOf(d=void 0===b&&void 0===c?new Uint8Array(a):void 0===c?new Uint8Array(a,b):new Uint8Array(a,b,c),g.prototype),d}function p(a){if(g.isBuffer(a)){let b=0|q(a.length),c=f(b);return 0===c.length||a.copy(c,0,0,b),c}return void 0!==a.length?"number"!=typeof a.length||ad(a.length)?f(0):m(a):"Buffer"===a.type&&Array.isArray(a.data)?m(a.data):void 0}function q(a){if(a>=0x7fffffff)throw RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|a}function r(a){return+a!=a&&(a=0),g.alloc(+a)}function s(a,b){if(g.isBuffer(a))return a.length;if(ArrayBuffer.isView(a)||ac(a,ArrayBuffer))return a.byteLength;if("string"!=typeof a)throw TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof a);let c=a.length,d=arguments.length>2&&!0===arguments[2];if(!d&&0===c)return 0;let e=!1;for(;;)switch(b){case"ascii":case"latin1":case"binary":return c;case"utf8":case"utf-8":return Z(a).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*c;case"hex":return c>>>1;case"base64":return aa(a).length;default:if(e)return d?-1:Z(a).length;b=(""+b).toLowerCase(),e=!0}}function t(a,b,c){let d=!1;if((void 0===b||b<0)&&(b=0),b>this.length||((void 0===c||c>this.length)&&(c=this.length),c<=0)||(c>>>=0)<=(b>>>=0))return"";for(a||(a="utf8");;)switch(a){case"hex":return H(this,b,c);case"utf8":case"utf-8":return D(this,b,c);case"ascii":return F(this,b,c);case"latin1":case"binary":return G(this,b,c);case"base64":return C(this,b,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,b,c);default:if(d)throw TypeError("Unknown encoding: "+a);a=(a+"").toLowerCase(),d=!0}}function u(a,b,c){let d=a[b];a[b]=a[c],a[c]=d}function v(a,b,c,d,e){if(0===a.length)return -1;if("string"==typeof c?(d=c,c=0):c>0x7fffffff?c=0x7fffffff:c<-0x80000000&&(c=-0x80000000),ad(c*=1)&&(c=e?0:a.length-1),c<0&&(c=a.length+c),c>=a.length){if(e)return -1;c=a.length-1}else if(c<0)if(!e)return -1;else c=0;if("string"==typeof b&&(b=g.from(b,d)),g.isBuffer(b))return 0===b.length?-1:w(a,b,c,d,e);if("number"==typeof b)return b&=255,"function"==typeof Uint8Array.prototype.indexOf?e?Uint8Array.prototype.indexOf.call(a,b,c):Uint8Array.prototype.lastIndexOf.call(a,b,c):w(a,[b],c,d,e);throw TypeError("val must be string, number or Buffer")}function w(a,b,c,d,e){let f,g=1,h=a.length,i=b.length;if(void 0!==d&&("ucs2"===(d=String(d).toLowerCase())||"ucs-2"===d||"utf16le"===d||"utf-16le"===d)){if(a.length<2||b.length<2)return -1;g=2,h/=2,i/=2,c/=2}function j(a,b){return 1===g?a[b]:a.readUInt16BE(b*g)}if(eJ(j,"read"),e){let d=-1;for(f=c;f<h;f++)if(j(a,f)===j(b,-1===d?0:f-d)){if(-1===d&&(d=f),f-d+1===i)return d*g}else -1!==d&&(f-=f-d),d=-1}else for(c+i>h&&(c=h-i),f=c;f>=0;f--){let c=!0;for(let d=0;d<i;d++)if(j(a,f+d)!==j(b,d)){c=!1;break}if(c)return f}return -1}function x(a,b,c,d){let e;c=Number(c)||0;let f=a.length-c;d?(d=Number(d))>f&&(d=f):d=f;let g=b.length;for(d>g/2&&(d=g/2),e=0;e<d;++e){let d=parseInt(b.substr(2*e,2),16);if(ad(d))break;a[c+e]=d}return e}function y(a,b,c,d){return ab(Z(b,a.length-c),a,c,d)}function z(a,b,c,d){return ab($(b),a,c,d)}function A(a,b,c,d){return ab(aa(b),a,c,d)}function B(a,b,c,d){return ab(_(b,a.length-c),a,c,d)}function C(a,c,d){return 0===c&&d===a.length?b.fromByteArray(a):b.fromByteArray(a.slice(c,d))}function D(a,b,c){c=Math.min(a.length,c);let d=[],e=b;for(;e<c;){let b=a[e],f=null,g=b>239?4:b>223?3:b>191?2:1;if(e+g<=c){let c,d,h,i;switch(g){case 1:b<128&&(f=b);break;case 2:(192&(c=a[e+1]))==128&&(i=(31&b)<<6|63&c)>127&&(f=i);break;case 3:c=a[e+1],d=a[e+2],(192&c)==128&&(192&d)==128&&(i=(15&b)<<12|(63&c)<<6|63&d)>2047&&(i<55296||i>57343)&&(f=i);break;case 4:c=a[e+1],d=a[e+2],h=a[e+3],(192&c)==128&&(192&d)==128&&(192&h)==128&&(i=(15&b)<<18|(63&c)<<12|(63&d)<<6|63&h)>65535&&i<1114112&&(f=i)}}null===f?(f=65533,g=1):f>65535&&(f-=65536,d.push(f>>>10&1023|55296),f=56320|1023&f),d.push(f),e+=g}return E(d)}function E(a){let b=a.length;if(b<=4096)return String.fromCharCode.apply(String,a);let c="",d=0;for(;d<b;)c+=String.fromCharCode.apply(String,a.slice(d,d+=4096));return c}function F(a,b,c){let d="";c=Math.min(a.length,c);for(let e=b;e<c;++e)d+=String.fromCharCode(127&a[e]);return d}function G(a,b,c){let d="";c=Math.min(a.length,c);for(let e=b;e<c;++e)d+=String.fromCharCode(a[e]);return d}function H(a,b,c){let d=a.length;(!b||b<0)&&(b=0),(!c||c<0||c>d)&&(c=d);let e="";for(let d=b;d<c;++d)e+=ae[a[d]];return e}function I(a,b,c){let d=a.slice(b,c),e="";for(let a=0;a<d.length-1;a+=2)e+=String.fromCharCode(d[a]+256*d[a+1]);return e}function J(a,b,c){if(a%1!=0||a<0)throw RangeError("offset is not uint");if(a+b>c)throw RangeError("Trying to access beyond buffer length")}function K(a,b,c,d,e,f){if(!g.isBuffer(a))throw TypeError('"buffer" argument must be a Buffer instance');if(b>e||b<f)throw RangeError('"value" argument is out of bounds');if(c+d>a.length)throw RangeError("Index out of range")}function L(a,b,c,d,e){U(b,d,e,a,c,7);let f=Number(b&BigInt(0xffffffff));a[c++]=f,f>>=8,a[c++]=f,f>>=8,a[c++]=f,f>>=8,a[c++]=f;let g=Number(b>>BigInt(32)&BigInt(0xffffffff));return a[c++]=g,g>>=8,a[c++]=g,g>>=8,a[c++]=g,g>>=8,a[c++]=g,c}function M(a,b,c,d,e){U(b,d,e,a,c,7);let f=Number(b&BigInt(0xffffffff));a[c+7]=f,f>>=8,a[c+6]=f,f>>=8,a[c+5]=f,f>>=8,a[c+4]=f;let g=Number(b>>BigInt(32)&BigInt(0xffffffff));return a[c+3]=g,g>>=8,a[c+2]=g,g>>=8,a[c+1]=g,g>>=8,a[c]=g,c+8}function N(a,b,c,d,e,f){if(c+d>a.length||c<0)throw RangeError("Index out of range")}function O(a,b,d,e,f){return b*=1,d>>>=0,f||N(a,b,d,4,34028234663852886e22,-34028234663852886e22),c.write(a,b,d,e,23,4),d+4}function P(a,b,d,e,f){return b*=1,d>>>=0,f||N(a,b,d,8,17976931348623157e292,-17976931348623157e292),c.write(a,b,d,e,52,8),d+8}a.Buffer=g,a.SlowBuffer=r,a.INSPECT_MAX_BYTES=50,a.kMaxLength=0x7fffffff,g.TYPED_ARRAY_SUPPORT=e(),!g.TYPED_ARRAY_SUPPORT&&"u">typeof console&&"function"==typeof console.error&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),eJ(e,"typedArraySupport"),Object.defineProperty(g.prototype,"parent",{enumerable:!0,get:eJ(function(){if(g.isBuffer(this))return this.buffer},"get")}),Object.defineProperty(g.prototype,"offset",{enumerable:!0,get:eJ(function(){if(g.isBuffer(this))return this.byteOffset},"get")}),eJ(f,"createBuffer"),eJ(g,"Buffer"),g.poolSize=8192,eJ(h,"from"),g.from=function(a,b,c){return h(a,b,c)},Object.setPrototypeOf(g.prototype,Uint8Array.prototype),Object.setPrototypeOf(g,Uint8Array),eJ(i,"assertSize"),eJ(j,"alloc"),g.alloc=function(a,b,c){return j(a,b,c)},eJ(k,"allocUnsafe"),g.allocUnsafe=function(a){return k(a)},g.allocUnsafeSlow=function(a){return k(a)},eJ(l,"fromString"),eJ(m,"fromArrayLike"),eJ(n,"fromArrayView"),eJ(o,"fromArrayBuffer"),eJ(p,"fromObject"),eJ(q,"checked"),eJ(r,"SlowBuffer"),g.isBuffer=eJ(function(a){return null!=a&&!0===a._isBuffer&&a!==g.prototype},"isBuffer"),g.compare=eJ(function(a,b){if(ac(a,Uint8Array)&&(a=g.from(a,a.offset,a.byteLength)),ac(b,Uint8Array)&&(b=g.from(b,b.offset,b.byteLength)),!g.isBuffer(a)||!g.isBuffer(b))throw TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(a===b)return 0;let c=a.length,d=b.length;for(let e=0,f=Math.min(c,d);e<f;++e)if(a[e]!==b[e]){c=a[e],d=b[e];break}return c<d?-1:+(d<c)},"compare"),g.isEncoding=eJ(function(a){switch(String(a).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},"isEncoding"),g.concat=eJ(function(a,b){let c;if(!Array.isArray(a))throw TypeError('"list" argument must be an Array of Buffers');if(0===a.length)return g.alloc(0);if(void 0===b)for(b=0,c=0;c<a.length;++c)b+=a[c].length;let d=g.allocUnsafe(b),e=0;for(c=0;c<a.length;++c){let b=a[c];if(ac(b,Uint8Array))e+b.length>d.length?(g.isBuffer(b)||(b=g.from(b)),b.copy(d,e)):Uint8Array.prototype.set.call(d,b,e);else if(g.isBuffer(b))b.copy(d,e);else throw TypeError('"list" argument must be an Array of Buffers');e+=b.length}return d},"concat"),eJ(s,"byteLength"),g.byteLength=s,eJ(t,"slowToString"),g.prototype._isBuffer=!0,eJ(u,"swap"),g.prototype.swap16=eJ(function(){let a=this.length;if(a%2!=0)throw RangeError("Buffer size must be a multiple of 16-bits");for(let b=0;b<a;b+=2)u(this,b,b+1);return this},"swap16"),g.prototype.swap32=eJ(function(){let a=this.length;if(a%4!=0)throw RangeError("Buffer size must be a multiple of 32-bits");for(let b=0;b<a;b+=4)u(this,b,b+3),u(this,b+1,b+2);return this},"swap32"),g.prototype.swap64=eJ(function(){let a=this.length;if(a%8!=0)throw RangeError("Buffer size must be a multiple of 64-bits");for(let b=0;b<a;b+=8)u(this,b,b+7),u(this,b+1,b+6),u(this,b+2,b+5),u(this,b+3,b+4);return this},"swap64"),g.prototype.toString=eJ(function(){let a=this.length;return 0===a?"":0==arguments.length?D(this,0,a):t.apply(this,arguments)},"toString"),g.prototype.toLocaleString=g.prototype.toString,g.prototype.equals=eJ(function(a){if(!g.isBuffer(a))throw TypeError("Argument must be a Buffer");return this===a||0===g.compare(this,a)},"equals"),g.prototype.inspect=eJ(function(){let b="",c=a.INSPECT_MAX_BYTES;return b=this.toString("hex",0,c).replace(/(.{2})/g,"$1 ").trim(),this.length>c&&(b+=" ... "),"<Buffer "+b+">"},"inspect"),d&&(g.prototype[d]=g.prototype.inspect),g.prototype.compare=eJ(function(a,b,c,d,e){if(ac(a,Uint8Array)&&(a=g.from(a,a.offset,a.byteLength)),!g.isBuffer(a))throw TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof a);if(void 0===b&&(b=0),void 0===c&&(c=a?a.length:0),void 0===d&&(d=0),void 0===e&&(e=this.length),b<0||c>a.length||d<0||e>this.length)throw RangeError("out of range index");if(d>=e&&b>=c)return 0;if(d>=e)return -1;if(b>=c)return 1;if(b>>>=0,c>>>=0,d>>>=0,e>>>=0,this===a)return 0;let f=e-d,h=c-b,i=Math.min(f,h),j=this.slice(d,e),k=a.slice(b,c);for(let a=0;a<i;++a)if(j[a]!==k[a]){f=j[a],h=k[a];break}return f<h?-1:+(h<f)},"compare"),eJ(v,"bidirectionalIndexOf"),eJ(w,"arrayIndexOf"),g.prototype.includes=eJ(function(a,b,c){return -1!==this.indexOf(a,b,c)},"includes"),g.prototype.indexOf=eJ(function(a,b,c){return v(this,a,b,c,!0)},"indexOf"),g.prototype.lastIndexOf=eJ(function(a,b,c){return v(this,a,b,c,!1)},"lastIndexOf"),eJ(x,"hexWrite"),eJ(y,"utf8Write"),eJ(z,"asciiWrite"),eJ(A,"base64Write"),eJ(B,"ucs2Write"),g.prototype.write=eJ(function(a,b,c,d){if(void 0===b)d="utf8",c=this.length,b=0;else if(void 0===c&&"string"==typeof b)d=b,c=this.length,b=0;else if(isFinite(b))b>>>=0,isFinite(c)?(c>>>=0,void 0===d&&(d="utf8")):(d=c,c=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let e=this.length-b;if((void 0===c||c>e)&&(c=e),a.length>0&&(c<0||b<0)||b>this.length)throw RangeError("Attempt to write outside buffer bounds");d||(d="utf8");let f=!1;for(;;)switch(d){case"hex":return x(this,a,b,c);case"utf8":case"utf-8":return y(this,a,b,c);case"ascii":case"latin1":case"binary":return z(this,a,b,c);case"base64":return A(this,a,b,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return B(this,a,b,c);default:if(f)throw TypeError("Unknown encoding: "+d);d=(""+d).toLowerCase(),f=!0}},"write"),g.prototype.toJSON=eJ(function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},"toJSON"),eJ(C,"base64Slice"),eJ(D,"utf8Slice"),eJ(E,"decodeCodePointsArray"),eJ(F,"asciiSlice"),eJ(G,"latin1Slice"),eJ(H,"hexSlice"),eJ(I,"utf16leSlice"),g.prototype.slice=eJ(function(a,b){let c=this.length;a=~~a,b=void 0===b?c:~~b,a<0?(a+=c)<0&&(a=0):a>c&&(a=c),b<0?(b+=c)<0&&(b=0):b>c&&(b=c),b<a&&(b=a);let d=this.subarray(a,b);return Object.setPrototypeOf(d,g.prototype),d},"slice"),eJ(J,"checkOffset"),g.prototype.readUintLE=g.prototype.readUIntLE=eJ(function(a,b,c){a>>>=0,b>>>=0,c||J(a,b,this.length);let d=this[a],e=1,f=0;for(;++f<b&&(e*=256);)d+=this[a+f]*e;return d},"readUIntLE"),g.prototype.readUintBE=g.prototype.readUIntBE=eJ(function(a,b,c){a>>>=0,b>>>=0,c||J(a,b,this.length);let d=this[a+--b],e=1;for(;b>0&&(e*=256);)d+=this[a+--b]*e;return d},"readUIntBE"),g.prototype.readUint8=g.prototype.readUInt8=eJ(function(a,b){return a>>>=0,b||J(a,1,this.length),this[a]},"readUInt8"),g.prototype.readUint16LE=g.prototype.readUInt16LE=eJ(function(a,b){return a>>>=0,b||J(a,2,this.length),this[a]|this[a+1]<<8},"readUInt16LE"),g.prototype.readUint16BE=g.prototype.readUInt16BE=eJ(function(a,b){return a>>>=0,b||J(a,2,this.length),this[a]<<8|this[a+1]},"readUInt16BE"),g.prototype.readUint32LE=g.prototype.readUInt32LE=eJ(function(a,b){return a>>>=0,b||J(a,4,this.length),(this[a]|this[a+1]<<8|this[a+2]<<16)+0x1000000*this[a+3]},"readUInt32LE"),g.prototype.readUint32BE=g.prototype.readUInt32BE=eJ(function(a,b){return a>>>=0,b||J(a,4,this.length),0x1000000*this[a]+(this[a+1]<<16|this[a+2]<<8|this[a+3])},"readUInt32BE"),g.prototype.readBigUInt64LE=af(eJ(function(a){V(a>>>=0,"offset");let b=this[a],c=this[a+7];(void 0===b||void 0===c)&&W(a,this.length-8);let d=b+256*this[++a]+65536*this[++a]+0x1000000*this[++a],e=this[++a]+256*this[++a]+65536*this[++a]+0x1000000*c;return BigInt(d)+(BigInt(e)<<BigInt(32))},"readBigUInt64LE")),g.prototype.readBigUInt64BE=af(eJ(function(a){V(a>>>=0,"offset");let b=this[a],c=this[a+7];(void 0===b||void 0===c)&&W(a,this.length-8);let d=0x1000000*b+65536*this[++a]+256*this[++a]+this[++a],e=0x1000000*this[++a]+65536*this[++a]+256*this[++a]+c;return(BigInt(d)<<BigInt(32))+BigInt(e)},"readBigUInt64BE")),g.prototype.readIntLE=eJ(function(a,b,c){a>>>=0,b>>>=0,c||J(a,b,this.length);let d=this[a],e=1,f=0;for(;++f<b&&(e*=256);)d+=this[a+f]*e;return d>=(e*=128)&&(d-=Math.pow(2,8*b)),d},"readIntLE"),g.prototype.readIntBE=eJ(function(a,b,c){a>>>=0,b>>>=0,c||J(a,b,this.length);let d=b,e=1,f=this[a+--d];for(;d>0&&(e*=256);)f+=this[a+--d]*e;return f>=(e*=128)&&(f-=Math.pow(2,8*b)),f},"readIntBE"),g.prototype.readInt8=eJ(function(a,b){return a>>>=0,b||J(a,1,this.length),128&this[a]?-((255-this[a]+1)*1):this[a]},"readInt8"),g.prototype.readInt16LE=eJ(function(a,b){a>>>=0,b||J(a,2,this.length);let c=this[a]|this[a+1]<<8;return 32768&c?0xffff0000|c:c},"readInt16LE"),g.prototype.readInt16BE=eJ(function(a,b){a>>>=0,b||J(a,2,this.length);let c=this[a+1]|this[a]<<8;return 32768&c?0xffff0000|c:c},"readInt16BE"),g.prototype.readInt32LE=eJ(function(a,b){return a>>>=0,b||J(a,4,this.length),this[a]|this[a+1]<<8|this[a+2]<<16|this[a+3]<<24},"readInt32LE"),g.prototype.readInt32BE=eJ(function(a,b){return a>>>=0,b||J(a,4,this.length),this[a]<<24|this[a+1]<<16|this[a+2]<<8|this[a+3]},"readInt32BE"),g.prototype.readBigInt64LE=af(eJ(function(a){V(a>>>=0,"offset");let b=this[a],c=this[a+7];return(void 0===b||void 0===c)&&W(a,this.length-8),(BigInt(this[a+4]+256*this[a+5]+65536*this[a+6]+(c<<24))<<BigInt(32))+BigInt(b+256*this[++a]+65536*this[++a]+0x1000000*this[++a])},"readBigInt64LE")),g.prototype.readBigInt64BE=af(eJ(function(a){V(a>>>=0,"offset");let b=this[a],c=this[a+7];return(void 0===b||void 0===c)&&W(a,this.length-8),(BigInt((b<<24)+65536*this[++a]+256*this[++a]+this[++a])<<BigInt(32))+BigInt(0x1000000*this[++a]+65536*this[++a]+256*this[++a]+c)},"readBigInt64BE")),g.prototype.readFloatLE=eJ(function(a,b){return a>>>=0,b||J(a,4,this.length),c.read(this,a,!0,23,4)},"readFloatLE"),g.prototype.readFloatBE=eJ(function(a,b){return a>>>=0,b||J(a,4,this.length),c.read(this,a,!1,23,4)},"readFloatBE"),g.prototype.readDoubleLE=eJ(function(a,b){return a>>>=0,b||J(a,8,this.length),c.read(this,a,!0,52,8)},"readDoubleLE"),g.prototype.readDoubleBE=eJ(function(a,b){return a>>>=0,b||J(a,8,this.length),c.read(this,a,!1,52,8)},"readDoubleBE"),eJ(K,"checkInt"),g.prototype.writeUintLE=g.prototype.writeUIntLE=eJ(function(a,b,c,d){if(a*=1,b>>>=0,c>>>=0,!d){let d=Math.pow(2,8*c)-1;K(this,a,b,c,d,0)}let e=1,f=0;for(this[b]=255&a;++f<c&&(e*=256);)this[b+f]=a/e&255;return b+c},"writeUIntLE"),g.prototype.writeUintBE=g.prototype.writeUIntBE=eJ(function(a,b,c,d){if(a*=1,b>>>=0,c>>>=0,!d){let d=Math.pow(2,8*c)-1;K(this,a,b,c,d,0)}let e=c-1,f=1;for(this[b+e]=255&a;--e>=0&&(f*=256);)this[b+e]=a/f&255;return b+c},"writeUIntBE"),g.prototype.writeUint8=g.prototype.writeUInt8=eJ(function(a,b,c){return a*=1,b>>>=0,c||K(this,a,b,1,255,0),this[b]=255&a,b+1},"writeUInt8"),g.prototype.writeUint16LE=g.prototype.writeUInt16LE=eJ(function(a,b,c){return a*=1,b>>>=0,c||K(this,a,b,2,65535,0),this[b]=255&a,this[b+1]=a>>>8,b+2},"writeUInt16LE"),g.prototype.writeUint16BE=g.prototype.writeUInt16BE=eJ(function(a,b,c){return a*=1,b>>>=0,c||K(this,a,b,2,65535,0),this[b]=a>>>8,this[b+1]=255&a,b+2},"writeUInt16BE"),g.prototype.writeUint32LE=g.prototype.writeUInt32LE=eJ(function(a,b,c){return a*=1,b>>>=0,c||K(this,a,b,4,0xffffffff,0),this[b+3]=a>>>24,this[b+2]=a>>>16,this[b+1]=a>>>8,this[b]=255&a,b+4},"writeUInt32LE"),g.prototype.writeUint32BE=g.prototype.writeUInt32BE=eJ(function(a,b,c){return a*=1,b>>>=0,c||K(this,a,b,4,0xffffffff,0),this[b]=a>>>24,this[b+1]=a>>>16,this[b+2]=a>>>8,this[b+3]=255&a,b+4},"writeUInt32BE"),eJ(L,"wrtBigUInt64LE"),eJ(M,"wrtBigUInt64BE"),g.prototype.writeBigUInt64LE=af(eJ(function(a,b=0){return L(this,a,b,BigInt(0),BigInt("0xffffffffffffffff"))},"writeBigUInt64LE")),g.prototype.writeBigUInt64BE=af(eJ(function(a,b=0){return M(this,a,b,BigInt(0),BigInt("0xffffffffffffffff"))},"writeBigUInt64BE")),g.prototype.writeIntLE=eJ(function(a,b,c,d){if(a*=1,b>>>=0,!d){let d=Math.pow(2,8*c-1);K(this,a,b,c,d-1,-d)}let e=0,f=1,g=0;for(this[b]=255&a;++e<c&&(f*=256);)a<0&&0===g&&0!==this[b+e-1]&&(g=1),this[b+e]=(a/f|0)-g&255;return b+c},"writeIntLE"),g.prototype.writeIntBE=eJ(function(a,b,c,d){if(a*=1,b>>>=0,!d){let d=Math.pow(2,8*c-1);K(this,a,b,c,d-1,-d)}let e=c-1,f=1,g=0;for(this[b+e]=255&a;--e>=0&&(f*=256);)a<0&&0===g&&0!==this[b+e+1]&&(g=1),this[b+e]=(a/f|0)-g&255;return b+c},"writeIntBE"),g.prototype.writeInt8=eJ(function(a,b,c){return a*=1,b>>>=0,c||K(this,a,b,1,127,-128),a<0&&(a=255+a+1),this[b]=255&a,b+1},"writeInt8"),g.prototype.writeInt16LE=eJ(function(a,b,c){return a*=1,b>>>=0,c||K(this,a,b,2,32767,-32768),this[b]=255&a,this[b+1]=a>>>8,b+2},"writeInt16LE"),g.prototype.writeInt16BE=eJ(function(a,b,c){return a*=1,b>>>=0,c||K(this,a,b,2,32767,-32768),this[b]=a>>>8,this[b+1]=255&a,b+2},"writeInt16BE"),g.prototype.writeInt32LE=eJ(function(a,b,c){return a*=1,b>>>=0,c||K(this,a,b,4,0x7fffffff,-0x80000000),this[b]=255&a,this[b+1]=a>>>8,this[b+2]=a>>>16,this[b+3]=a>>>24,b+4},"writeInt32LE"),g.prototype.writeInt32BE=eJ(function(a,b,c){return a*=1,b>>>=0,c||K(this,a,b,4,0x7fffffff,-0x80000000),a<0&&(a=0xffffffff+a+1),this[b]=a>>>24,this[b+1]=a>>>16,this[b+2]=a>>>8,this[b+3]=255&a,b+4},"writeInt32BE"),g.prototype.writeBigInt64LE=af(eJ(function(a,b=0){return L(this,a,b,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))},"writeBigInt64LE")),g.prototype.writeBigInt64BE=af(eJ(function(a,b=0){return M(this,a,b,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))},"writeBigInt64BE")),eJ(N,"checkIEEE754"),eJ(O,"writeFloat"),g.prototype.writeFloatLE=eJ(function(a,b,c){return O(this,a,b,!0,c)},"writeFloatLE"),g.prototype.writeFloatBE=eJ(function(a,b,c){return O(this,a,b,!1,c)},"writeFloatBE"),eJ(P,"writeDouble"),g.prototype.writeDoubleLE=eJ(function(a,b,c){return P(this,a,b,!0,c)},"writeDoubleLE"),g.prototype.writeDoubleBE=eJ(function(a,b,c){return P(this,a,b,!1,c)},"writeDoubleBE"),g.prototype.copy=eJ(function(a,b,c,d){if(!g.isBuffer(a))throw TypeError("argument should be a Buffer");if(c||(c=0),d||0===d||(d=this.length),b>=a.length&&(b=a.length),b||(b=0),d>0&&d<c&&(d=c),d===c||0===a.length||0===this.length)return 0;if(b<0)throw RangeError("targetStart out of bounds");if(c<0||c>=this.length)throw RangeError("Index out of range");if(d<0)throw RangeError("sourceEnd out of bounds");d>this.length&&(d=this.length),a.length-b<d-c&&(d=a.length-b+c);let e=d-c;return this===a&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(b,c,d):Uint8Array.prototype.set.call(a,this.subarray(c,d),b),e},"copy"),g.prototype.fill=eJ(function(a,b,c,d){let e;if("string"==typeof a){if("string"==typeof b?(d=b,b=0,c=this.length):"string"==typeof c&&(d=c,c=this.length),void 0!==d&&"string"!=typeof d)throw TypeError("encoding must be a string");if("string"==typeof d&&!g.isEncoding(d))throw TypeError("Unknown encoding: "+d);if(1===a.length){let b=a.charCodeAt(0);("utf8"===d&&b<128||"latin1"===d)&&(a=b)}}else"number"==typeof a?a&=255:"boolean"==typeof a&&(a=Number(a));if(b<0||this.length<b||this.length<c)throw RangeError("Out of range index");if(c<=b)return this;if(b>>>=0,c=void 0===c?this.length:c>>>0,a||(a=0),"number"==typeof a)for(e=b;e<c;++e)this[e]=a;else{let f=g.isBuffer(a)?a:g.from(a,d),h=f.length;if(0===h)throw TypeError('The value "'+a+'" is invalid for argument "value"');for(e=0;e<c-b;++e)this[e+b]=f[e%h]}return this},"fill");var Q={};function R(a,b,c){var d;Q[a]=(eJ(d=class extends c{constructor(){super(),Object.defineProperty(this,"message",{value:b.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${a}]`,this.stack,delete this.name}get code(){return a}set code(a){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:a,writable:!0})}toString(){return`${this.name} [${a}]: ${this.message}`}},"NodeError"),d)}function S(a){let b="",c=a.length,d=+("-"===a[0]);for(;c>=d+4;c-=3)b=`_${a.slice(c-3,c)}${b}`;return`${a.slice(0,c)}${b}`}function T(a,b,c){V(b,"offset"),(void 0===a[b]||void 0===a[b+c])&&W(b,a.length-(c+1))}function U(a,b,c,d,e,f){if(a>c||a<b){let d="bigint"==typeof b?"n":"",e;throw e=f>3?0===b||b===BigInt(0)?`>= 0${d} and < 2${d} ** ${(f+1)*8}${d}`:`>= -(2${d} ** ${(f+1)*8-1}${d}) and \
< 2 ** ${(f+1)*8-1}${d}`:`>= ${b}${d} and <= ${c}${d}`,new Q.ERR_OUT_OF_RANGE("value",e,a)}T(d,e,f)}function V(a,b){if("number"!=typeof a)throw new Q.ERR_INVALID_ARG_TYPE(b,"number",a)}function W(a,b,c){throw Math.floor(a)!==a?(V(a,c),new Q.ERR_OUT_OF_RANGE(c||"offset","an integer",a)):b<0?new Q.ERR_BUFFER_OUT_OF_BOUNDS:new Q.ERR_OUT_OF_RANGE(c||"offset",`>= ${+!!c} and <= ${b}`,a)}eJ(R,"E"),R("ERR_BUFFER_OUT_OF_BOUNDS",function(a){return a?`${a} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),R("ERR_INVALID_ARG_TYPE",function(a,b){return`The "${a}" argum\
ent must be of type number. Received type ${typeof b}`},TypeError),R("ERR_OUT_OF_RANGE",function(a,b,c){let d=`The value of "${a}" is out of range.`,e=c;return Number.isInteger(c)&&Math.abs(c)>0x100000000?e=S(String(c)):"bigint"==typeof c&&(e=String(c),(c>BigInt(2)**BigInt(32)||c<-(BigInt(2)**BigInt(32)))&&(e=S(e)),e+="n"),d+=` It\
 must be ${b}. Received ${e}`},RangeError),eJ(S,"addNumericalSeparator"),eJ(T,"checkBounds"),eJ(U,"checkIntBI"),eJ(V,"validateNumber"),eJ(W,"boundsError");var X=/[^+/0-9A-Za-z-_]/g;function Y(a){if((a=(a=a.split("=")[0]).trim().replace(X,"")).length<2)return"";for(;a.length%4!=0;)a+="=";return a}function Z(a,b){b=b||1/0;let c,d=a.length,e=null,f=[];for(let g=0;g<d;++g){if((c=a.charCodeAt(g))>55295&&c<57344){if(!e){if(c>56319||g+1===d){(b-=3)>-1&&f.push(239,191,189);continue}e=c;continue}if(c<56320){(b-=3)>-1&&f.push(239,191,189),e=c;continue}c=(e-55296<<10|c-56320)+65536}else e&&(b-=3)>-1&&f.push(239,191,189);if(e=null,c<128){if((b-=1)<0)break;f.push(c)}else if(c<2048){if((b-=2)<0)break;f.push(c>>6|192,63&c|128)}else if(c<65536){if((b-=3)<0)break;f.push(c>>12|224,c>>6&63|128,63&c|128)}else if(c<1114112){if((b-=4)<0)break;f.push(c>>18|240,c>>12&63|128,c>>6&63|128,63&c|128)}else throw Error("Invalid code point")}return f}function $(a){let b=[];for(let c=0;c<a.length;++c)b.push(255&a.charCodeAt(c));return b}function _(a,b){let c,d,e=[];for(let f=0;f<a.length&&!((b-=2)<0);++f)d=(c=a.charCodeAt(f))>>8,e.push(c%256),e.push(d);return e}function aa(a){return b.toByteArray(Y(a))}function ab(a,b,c,d){let e;for(e=0;e<d&&!(e+c>=b.length||e>=a.length);++e)b[e+c]=a[e];return e}function ac(a,b){return a instanceof b||null!=a&&null!=a.constructor&&null!=a.constructor.name&&a.constructor.name===b.name}function ad(a){return a!=a}eJ(Y,"base64clean"),eJ(Z,"utf8ToBytes"),eJ($,"asciiToBytes"),eJ(_,"utf16leToBytes"),eJ(aa,"base64ToBytes"),eJ(ab,"blitBuffer"),eJ(ac,"isInstance"),eJ(ad,"numberIsNaN");var ae=function(){let a="0123456789abcdef",b=Array(256);for(let c=0;c<16;++c){let d=16*c;for(let e=0;e<16;++e)b[d+e]=a[c]+a[e]}return b}();function af(a){return typeof BigInt>"u"?ag:a}function ag(){throw Error("BigInt not supported")}eJ(af,"defineBigIntMethod"),eJ(ag,"BufferBigIntNotDefined")}),eU=eK(()=>{ey=globalThis,ez=globalThis.setImmediate??(a=>setTimeout(a,0)),globalThis.clearImmediate??(a=>clearTimeout(a)),(eA=globalThis.crypto??{}).subtle??(eA.subtle={}),eB="function"==typeof globalThis.Buffer&&"function"==typeof globalThis.Buffer.allocUnsafe?globalThis.Buffer:eT().Buffer,(eC=globalThis.process??{}).env??(eC.env={});try{eC.nextTick(()=>{})}catch{let a=Promise.resolve();eC.nextTick=a.then.bind(a)}}),eV=eL((a,b)=>{eU();var c,d="object"==typeof Reflect?Reflect:null,e=d&&"function"==typeof d.apply?d.apply:eJ(function(a,b,c){return Function.prototype.apply.call(a,b,c)},"ReflectApply");function f(a){console&&console.warn&&console.warn(a)}c=d&&"function"==typeof d.ownKeys?d.ownKeys:Object.getOwnPropertySymbols?eJ(function(a){return Object.getOwnPropertyNames(a).concat(Object.getOwnPropertySymbols(a))},"ReflectOwnKeys"):eJ(function(a){return Object.getOwnPropertyNames(a)},"ReflectOwnKeys"),eJ(f,"ProcessEmitWarning");var g=Number.isNaN||eJ(function(a){return a!=a},"NumberIsNaN");function h(){h.init.call(this)}eJ(h,"EventEmitter"),b.exports=h,b.exports.once=t,h.EventEmitter=h,h.prototype._events=void 0,h.prototype._eventsCount=0,h.prototype._maxListeners=void 0;var i=10;function j(a){if("function"!=typeof a)throw TypeError('The "listener" argument must be of type Function. Received type '+typeof a)}function k(a){return void 0===a._maxListeners?h.defaultMaxListeners:a._maxListeners}function l(a,b,c,d){var e,g,h;if(j(c),void 0===(g=a._events)?(g=a._events=Object.create(null),a._eventsCount=0):(void 0!==g.newListener&&(a.emit("newListener",b,c.listener?c.listener:c),g=a._events),h=g[b]),void 0===h)h=g[b]=c,++a._eventsCount;else if("function"==typeof h?h=g[b]=d?[c,h]:[h,c]:d?h.unshift(c):h.push(c),(e=k(a))>0&&h.length>e&&!h.warned){h.warned=!0;var i=Error("Possible EventEmitter memory leak detected. "+h.length+" "+String(b)+" listeners added. Use emitter.setMaxListeners() to increase limit");i.name="MaxListenersExceededWarning",i.emitter=a,i.type=b,i.count=h.length,f(i)}return a}function m(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0==arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function n(a,b,c){var d={fired:!1,wrapFn:void 0,target:a,type:b,listener:c},e=m.bind(d);return e.listener=c,d.wrapFn=e,e}function o(a,b,c){var d=a._events;if(void 0===d)return[];var e=d[b];return void 0===e?[]:"function"==typeof e?c?[e.listener||e]:[e]:c?s(e):q(e,e.length)}function p(a){var b=this._events;if(void 0!==b){var c=b[a];if("function"==typeof c)return 1;if(void 0!==c)return c.length}return 0}function q(a,b){for(var c=Array(b),d=0;d<b;++d)c[d]=a[d];return c}function r(a,b){for(;b+1<a.length;b++)a[b]=a[b+1];a.pop()}function s(a){for(var b=Array(a.length),c=0;c<b.length;++c)b[c]=a[c].listener||a[c];return b}function t(a,b){return new Promise(function(c,d){function e(c){a.removeListener(b,f),d(c)}function f(){"function"==typeof a.removeListener&&a.removeListener("error",e),c([].slice.call(arguments))}eJ(e,"errorListener"),eJ(f,"resolver"),v(a,b,f,{once:!0}),"error"!==b&&u(a,e,{once:!0})})}function u(a,b,c){"function"==typeof a.on&&v(a,"error",b,c)}function v(a,b,c,d){if("function"==typeof a.on)d.once?a.once(b,c):a.on(b,c);else if("function"==typeof a.addEventListener)a.addEventListener(b,eJ(function e(f){d.once&&a.removeEventListener(b,e),c(f)},"wrapListener"));else throw TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof a)}eJ(j,"checkListener"),Object.defineProperty(h,"defaultMaxListeners",{enumerable:!0,get:eJ(function(){return i},"get"),set:eJ(function(a){if("number"!=typeof a||a<0||g(a))throw RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+a+".");i=a},"set")}),h.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},h.prototype.setMaxListeners=eJ(function(a){if("number"!=typeof a||a<0||g(a))throw RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+a+".");return this._maxListeners=a,this},"setMaxListeners"),eJ(k,"_getMaxListeners"),h.prototype.getMaxListeners=eJ(function(){return k(this)},"getMaxListeners"),h.prototype.emit=eJ(function(a){for(var b=[],c=1;c<arguments.length;c++)b.push(arguments[c]);var d="error"===a,f=this._events;if(void 0!==f)d=d&&void 0===f.error;else if(!d)return!1;if(d){if(b.length>0&&(g=b[0]),g instanceof Error)throw g;var g,h=Error("Unhandled error."+(g?" ("+g.message+")":""));throw h.context=g,h}var i=f[a];if(void 0===i)return!1;if("function"==typeof i)e(i,this,b);else for(var j=i.length,k=q(i,j),c=0;c<j;++c)e(k[c],this,b);return!0},"emit"),eJ(l,"_addListener"),h.prototype.addListener=eJ(function(a,b){return l(this,a,b,!1)},"addListener"),h.prototype.on=h.prototype.addListener,h.prototype.prependListener=eJ(function(a,b){return l(this,a,b,!0)},"prependListener"),eJ(m,"onceWrapper"),eJ(n,"_onceWrap"),h.prototype.once=eJ(function(a,b){return j(b),this.on(a,n(this,a,b)),this},"once"),h.prototype.prependOnceListener=eJ(function(a,b){return j(b),this.prependListener(a,n(this,a,b)),this},"prependOnceListener"),h.prototype.removeListener=eJ(function(a,b){var c,d,e,f,g;if(j(b),void 0===(d=this._events)||void 0===(c=d[a]))return this;if(c===b||c.listener===b)0==--this._eventsCount?this._events=Object.create(null):(delete d[a],d.removeListener&&this.emit("removeListener",a,c.listener||b));else if("function"!=typeof c){for(e=-1,f=c.length-1;f>=0;f--)if(c[f]===b||c[f].listener===b){g=c[f].listener,e=f;break}if(e<0)return this;0===e?c.shift():r(c,e),1===c.length&&(d[a]=c[0]),void 0!==d.removeListener&&this.emit("removeListener",a,g||b)}return this},"removeListener"),h.prototype.off=h.prototype.removeListener,h.prototype.removeAllListeners=eJ(function(a){var b,c,d;if(void 0===(c=this._events))return this;if(void 0===c.removeListener)return 0==arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==c[a]&&(0==--this._eventsCount?this._events=Object.create(null):delete c[a]),this;if(0==arguments.length){var e,f=Object.keys(c);for(d=0;d<f.length;++d)"removeListener"!==(e=f[d])&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(b=c[a]))this.removeListener(a,b);else if(void 0!==b)for(d=b.length-1;d>=0;d--)this.removeListener(a,b[d]);return this},"removeAllListeners"),eJ(o,"_listeners"),h.prototype.listeners=eJ(function(a){return o(this,a,!0)},"listeners"),h.prototype.rawListeners=eJ(function(a){return o(this,a,!1)},"rawListeners"),h.listenerCount=function(a,b){return"function"==typeof a.listenerCount?a.listenerCount(b):p.call(a,b)},h.prototype.listenerCount=p,eJ(p,"listenerCount"),h.prototype.eventNames=eJ(function(){return this._eventsCount>0?c(this._events):[]},"eventNames"),eJ(q,"arrayClone"),eJ(r,"spliceOne"),eJ(s,"unwrapListeners"),eJ(t,"once"),eJ(u,"addErrorHandlerIfEventEmitter"),eJ(v,"eventTargetAgnosticAddListener")}),eW={};eM(eW,{default:()=>eX});var eX,eY=eK(()=>{eU(),eX={}});function eZ(a){let b=0x6a09e667,c=0xbb67ae85,d=0x3c6ef372,e=0xa54ff53a,f=0x510e527f,g=0x9b05688c,h=0x1f83d9ab,i=0x5be0cd19,j=0,k=0,l=[0x428a2f98,0x71374491,0xb5c0fbcf,0xe9b5dba5,0x3956c25b,0x59f111f1,0x923f82a4,0xab1c5ed5,0xd807aa98,0x12835b01,0x243185be,0x550c7dc3,0x72be5d74,0x80deb1fe,0x9bdc06a7,0xc19bf174,0xe49b69c1,0xefbe4786,0xfc19dc6,0x240ca1cc,0x2de92c6f,0x4a7484aa,0x5cb0a9dc,0x76f988da,0x983e5152,0xa831c66d,0xb00327c8,0xbf597fc7,0xc6e00bf3,0xd5a79147,0x6ca6351,0x14292967,0x27b70a85,0x2e1b2138,0x4d2c6dfc,0x53380d13,0x650a7354,0x766a0abb,0x81c2c92e,0x92722c85,0xa2bfe8a1,0xa81a664b,0xc24b8b70,0xc76c51a3,0xd192e819,0xd6990624,0xf40e3585,0x106aa070,0x19a4c116,0x1e376c08,0x2748774c,0x34b0bcb5,0x391c0cb3,0x4ed8aa4a,0x5b9cca4f,0x682e6ff3,0x748f82ee,0x78a5636f,0x84c87814,0x8cc70208,0x90befffa,0xa4506ceb,0xbef9a3f7,0xc67178f2],m=eJ((a,b)=>a>>>b|a<<32-b,"rrot"),n=new Uint32Array(64),o=new Uint8Array(64),p=eJ(()=>{for(let a=0,b=0;a<16;a++,b+=4)n[a]=o[b]<<24|o[b+1]<<16|o[b+2]<<8|o[b+3];for(let a=16;a<64;a++){let b=m(n[a-15],7)^m(n[a-15],18)^n[a-15]>>>3,c=m(n[a-2],17)^m(n[a-2],19)^n[a-2]>>>10;n[a]=n[a-16]+b+n[a-7]+c|0}let a=b,j=c,p=d,q=e,r=f,s=g,t=h,u=i;for(let b=0;b<64;b++){let c=u+(m(r,6)^m(r,11)^m(r,25))+(r&s^~r&t)+l[b]+n[b]|0,d=(m(a,2)^m(a,13)^m(a,22))+(a&j^a&p^j&p)|0;u=t,t=s,s=r,r=q+c|0,q=p,p=j,j=a,a=c+d|0}b=b+a|0,c=c+j|0,d=d+p|0,e=e+q|0,f=f+r|0,g=g+s|0,h=h+t|0,i=i+u|0,k=0},"process"),q=eJ(a=>{"string"==typeof a&&(a=new TextEncoder().encode(a));for(let b=0;b<a.length;b++)o[k++]=a[b],64===k&&p();j+=a.length},"add"),r=eJ(()=>{if(o[k++]=128,64==k&&p(),k+8>64){for(;k<64;)o[k++]=0;p()}for(;k<58;)o[k++]=0;let a=8*j;o[k++]=a/0x10000000000&255,o[k++]=a/0x100000000&255,o[k++]=a>>>24,o[k++]=a>>>16&255,o[k++]=a>>>8&255,o[k++]=255&a,p();let l=new Uint8Array(32);return l[0]=b>>>24,l[1]=b>>>16&255,l[2]=b>>>8&255,l[3]=255&b,l[4]=c>>>24,l[5]=c>>>16&255,l[6]=c>>>8&255,l[7]=255&c,l[8]=d>>>24,l[9]=d>>>16&255,l[10]=d>>>8&255,l[11]=255&d,l[12]=e>>>24,l[13]=e>>>16&255,l[14]=e>>>8&255,l[15]=255&e,l[16]=f>>>24,l[17]=f>>>16&255,l[18]=f>>>8&255,l[19]=255&f,l[20]=g>>>24,l[21]=g>>>16&255,l[22]=g>>>8&255,l[23]=255&g,l[24]=h>>>24,l[25]=h>>>16&255,l[26]=h>>>8&255,l[27]=255&h,l[28]=i>>>24,l[29]=i>>>16&255,l[30]=i>>>8&255,l[31]=255&i,l},"digest");return void 0===a?{add:q,digest:r}:(q(a),r())}var e$,e_,e0=eK(()=>{eU(),eJ(eZ,"sha256")}),e1=eK(()=>{eU(),eJ(e$=class a{constructor(){eQ(this,"_dataLength",0),eQ(this,"_bufferLength",0),eQ(this,"_state",new Int32Array(4)),eQ(this,"_buffer",new ArrayBuffer(68)),eQ(this,"_buffer8"),eQ(this,"_buffer32"),this._buffer8=new Uint8Array(this._buffer,0,68),this._buffer32=new Uint32Array(this._buffer,0,17),this.start()}static hashByteArray(a,b=!1){return this.onePassHasher.start().appendByteArray(a).end(b)}static hashStr(a,b=!1){return this.onePassHasher.start().appendStr(a).end(b)}static hashAsciiStr(a,b=!1){return this.onePassHasher.start().appendAsciiStr(a).end(b)}static _hex(b){let c=a.hexChars,d=a.hexOut,e,f,g,h;for(h=0;h<4;h+=1)for(f=8*h,e=b[h],g=0;g<8;g+=2)d[f+1+g]=c.charAt(15&e),e>>>=4,d[f+0+g]=c.charAt(15&e),e>>>=4;return d.join("")}static _md5cycle(a,b){let c=a[0],d=a[1],e=a[2],f=a[3];c+=(d&e|~d&f)+b[0]-0x28955b88|0,f+=((c=(c<<7|c>>>25)+d|0)&d|~c&e)+b[1]-0x173848aa|0,e+=((f=(f<<12|f>>>20)+c|0)&c|~f&d)+b[2]+0x242070db|0,d+=((e=(e<<17|e>>>15)+f|0)&f|~e&c)+b[3]-0x3e423112|0,c+=((d=(d<<22|d>>>10)+e|0)&e|~d&f)+b[4]-0xa83f051|0,f+=((c=(c<<7|c>>>25)+d|0)&d|~c&e)+b[5]+0x4787c62a|0,e+=((f=(f<<12|f>>>20)+c|0)&c|~f&d)+b[6]-0x57cfb9ed|0,d+=((e=(e<<17|e>>>15)+f|0)&f|~e&c)+b[7]-0x2b96aff|0,c+=((d=(d<<22|d>>>10)+e|0)&e|~d&f)+b[8]+0x698098d8|0,f+=((c=(c<<7|c>>>25)+d|0)&d|~c&e)+b[9]-0x74bb0851|0,e+=((f=(f<<12|f>>>20)+c|0)&c|~f&d)+b[10]-42063|0,d+=((e=(e<<17|e>>>15)+f|0)&f|~e&c)+b[11]-0x76a32842|0,c+=((d=(d<<22|d>>>10)+e|0)&e|~d&f)+b[12]+0x6b901122|0,f+=((c=(c<<7|c>>>25)+d|0)&d|~c&e)+b[13]-0x2678e6d|0,e+=((f=(f<<12|f>>>20)+c|0)&c|~f&d)+b[14]-0x5986bc72|0,d+=((e=(e<<17|e>>>15)+f|0)&f|~e&c)+b[15]+0x49b40821|0,c+=((d=(d<<22|d>>>10)+e|0)&f|e&~f)+b[1]-0x9e1da9e|0,f+=((c=(c<<5|c>>>27)+d|0)&e|d&~e)+b[6]-0x3fbf4cc0|0,e+=((f=(f<<9|f>>>23)+c|0)&d|c&~d)+b[11]+0x265e5a51|0,d+=((e=(e<<14|e>>>18)+f|0)&c|f&~c)+b[0]-0x16493856|0,c+=((d=(d<<20|d>>>12)+e|0)&f|e&~f)+b[5]-0x29d0efa3|0,f+=((c=(c<<5|c>>>27)+d|0)&e|d&~e)+b[10]+0x2441453|0,e+=((f=(f<<9|f>>>23)+c|0)&d|c&~d)+b[15]-0x275e197f|0,d+=((e=(e<<14|e>>>18)+f|0)&c|f&~c)+b[4]-0x182c0438|0,c+=((d=(d<<20|d>>>12)+e|0)&f|e&~f)+b[9]+0x21e1cde6|0,f+=((c=(c<<5|c>>>27)+d|0)&e|d&~e)+b[14]-0x3cc8f82a|0,e+=((f=(f<<9|f>>>23)+c|0)&d|c&~d)+b[3]-0xb2af279|0,d+=((e=(e<<14|e>>>18)+f|0)&c|f&~c)+b[8]+0x455a14ed|0,c+=((d=(d<<20|d>>>12)+e|0)&f|e&~f)+b[13]-0x561c16fb|0,f+=((c=(c<<5|c>>>27)+d|0)&e|d&~e)+b[2]-0x3105c08|0,e+=((f=(f<<9|f>>>23)+c|0)&d|c&~d)+b[7]+0x676f02d9|0,d+=((e=(e<<14|e>>>18)+f|0)&c|f&~c)+b[12]-0x72d5b376|0,c+=((d=(d<<20|d>>>12)+e|0)^e^f)+b[5]-378558|0,f+=((c=(c<<4|c>>>28)+d|0)^d^e)+b[8]-0x788e097f|0,e+=((f=(f<<11|f>>>21)+c|0)^c^d)+b[11]+0x6d9d6122|0,d+=((e=(e<<16|e>>>16)+f|0)^f^c)+b[14]-0x21ac7f4|0,c+=((d=(d<<23|d>>>9)+e|0)^e^f)+b[1]-0x5b4115bc|0,f+=((c=(c<<4|c>>>28)+d|0)^d^e)+b[4]+0x4bdecfa9|0,e+=((f=(f<<11|f>>>21)+c|0)^c^d)+b[7]-0x944b4a0|0,d+=((e=(e<<16|e>>>16)+f|0)^f^c)+b[10]-0x41404390|0,c+=((d=(d<<23|d>>>9)+e|0)^e^f)+b[13]+0x289b7ec6|0,f+=((c=(c<<4|c>>>28)+d|0)^d^e)+b[0]-0x155ed806|0,e+=((f=(f<<11|f>>>21)+c|0)^c^d)+b[3]-0x2b10cf7b|0,d+=((e=(e<<16|e>>>16)+f|0)^f^c)+b[6]+0x4881d05|0,c+=((d=(d<<23|d>>>9)+e|0)^e^f)+b[9]-0x262b2fc7|0,f+=((c=(c<<4|c>>>28)+d|0)^d^e)+b[12]-0x1924661b|0,e+=((f=(f<<11|f>>>21)+c|0)^c^d)+b[15]+0x1fa27cf8|0,d+=((e=(e<<16|e>>>16)+f|0)^f^c)+b[2]-0x3b53a99b|0,d=(d<<23|d>>>9)+e|0,c+=(e^(d|~f))+b[0]-0xbd6ddbc|0,c=(c<<6|c>>>26)+d|0,f+=(d^(c|~e))+b[7]+0x432aff97|0,f=(f<<10|f>>>22)+c|0,e+=(c^(f|~d))+b[14]-0x546bdc59|0,e=(e<<15|e>>>17)+f|0,d+=(f^(e|~c))+b[5]-0x36c5fc7|0,d=(d<<21|d>>>11)+e|0,c+=(e^(d|~f))+b[12]+0x655b59c3|0,c=(c<<6|c>>>26)+d|0,f+=(d^(c|~e))+b[3]-0x70f3336e|0,f=(f<<10|f>>>22)+c|0,e+=(c^(f|~d))+b[10]-1051523|0,e=(e<<15|e>>>17)+f|0,d+=(f^(e|~c))+b[1]-0x7a7ba22f|0,d=(d<<21|d>>>11)+e|0,c+=(e^(d|~f))+b[8]+0x6fa87e4f|0,c=(c<<6|c>>>26)+d|0,f+=(d^(c|~e))+b[15]-0x1d31920|0,f=(f<<10|f>>>22)+c|0,e+=(c^(f|~d))+b[6]-0x5cfebcec|0,e=(e<<15|e>>>17)+f|0,d+=(f^(e|~c))+b[13]+0x4e0811a1|0,d=(d<<21|d>>>11)+e|0,c+=(e^(d|~f))+b[4]-0x8ac817e|0,c=(c<<6|c>>>26)+d|0,f+=(d^(c|~e))+b[11]-0x42c50dcb|0,f=(f<<10|f>>>22)+c|0,e+=(c^(f|~d))+b[2]+0x2ad7d2bb|0,e=(e<<15|e>>>17)+f|0,d+=(f^(e|~c))+b[9]-0x14792c6f|0,d=(d<<21|d>>>11)+e|0,a[0]=c+a[0]|0,a[1]=d+a[1]|0,a[2]=e+a[2]|0,a[3]=f+a[3]|0}start(){return this._dataLength=0,this._bufferLength=0,this._state.set(a.stateIdentity),this}appendStr(b){let c=this._buffer8,d=this._buffer32,e=this._bufferLength,f,g;for(g=0;g<b.length;g+=1){if((f=b.charCodeAt(g))<128)c[e++]=f;else if(f<2048)c[e++]=(f>>>6)+192,c[e++]=63&f|128;else if(f<55296||f>56319)c[e++]=(f>>>12)+224,c[e++]=f>>>6&63|128,c[e++]=63&f|128;else{if((f=(f-55296)*1024+(b.charCodeAt(++g)-56320)+65536)>1114111)throw Error("Unicode standard supports code points up to U+10FFFF");c[e++]=(f>>>18)+240,c[e++]=f>>>12&63|128,c[e++]=f>>>6&63|128,c[e++]=63&f|128}e>=64&&(this._dataLength+=64,a._md5cycle(this._state,d),e-=64,d[0]=d[16])}return this._bufferLength=e,this}appendAsciiStr(b){let c=this._buffer8,d=this._buffer32,e=this._bufferLength,f,g=0;for(;;){for(f=Math.min(b.length-g,64-e);f--;)c[e++]=b.charCodeAt(g++);if(e<64)break;this._dataLength+=64,a._md5cycle(this._state,d),e=0}return this._bufferLength=e,this}appendByteArray(b){let c=this._buffer8,d=this._buffer32,e=this._bufferLength,f,g=0;for(;;){for(f=Math.min(b.length-g,64-e);f--;)c[e++]=b[g++];if(e<64)break;this._dataLength+=64,a._md5cycle(this._state,d),e=0}return this._bufferLength=e,this}getState(){let a=this._state;return{buffer:String.fromCharCode.apply(null,Array.from(this._buffer8)),buflen:this._bufferLength,length:this._dataLength,state:[a[0],a[1],a[2],a[3]]}}setState(a){let b=a.buffer,c=a.state,d=this._state,e;for(this._dataLength=a.length,this._bufferLength=a.buflen,d[0]=c[0],d[1]=c[1],d[2]=c[2],d[3]=c[3],e=0;e<b.length;e+=1)this._buffer8[e]=b.charCodeAt(e)}end(b=!1){let c=this._bufferLength,d=this._buffer8,e=this._buffer32,f=(c>>2)+1;this._dataLength+=c;let g=8*this._dataLength;if(d[c]=128,d[c+1]=d[c+2]=d[c+3]=0,e.set(a.buffer32Identity.subarray(f),f),c>55&&(a._md5cycle(this._state,e),e.set(a.buffer32Identity)),g<=0xffffffff)e[14]=g;else{let a=g.toString(16).match(/(.*?)(.{0,8})$/);if(null===a)return;let b=parseInt(a[2],16),c=parseInt(a[1],16)||0;e[14]=b,e[15]=c}return a._md5cycle(this._state,e),b?this._state:a._hex(this._state)}},"Md5"),eQ(e$,"stateIdentity",new Int32Array([0x67452301,-0x10325477,-0x67452302,0x10325476])),eQ(e$,"buffer32Identity",new Int32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),eQ(e$,"hexChars","0123456789abcdef"),eQ(e$,"hexOut",[]),eQ(e$,"onePassHasher",new e$),e_=e$}),e2={};function e3(a){return eA.getRandomValues(eB.alloc(a))}function e4(a){if("sha256"===a)return{update:eJ(function(a){return{digest:eJ(function(){return eB.from(eZ(a))},"digest")}},"update")};if("md5"===a)return{update:eJ(function(a){return{digest:eJ(function(){return"string"==typeof a?e_.hashStr(a):e_.hashByteArray(a)},"digest")}},"update")};throw Error(`Hash type '${a}' not supported`)}function e5(a,b){if("sha256"!==a)throw Error(`Only sha256 is supported (requested: '${a}')`);return{update:eJ(function(a){return{digest:eJ(function(){"string"==typeof b&&(b=new TextEncoder().encode(b)),"string"==typeof a&&(a=new TextEncoder().encode(a));let c=b.length;if(c>64)b=eZ(b);else if(c<64){let a=new Uint8Array(64);a.set(b),b=a}let d=new Uint8Array(64),e=new Uint8Array(64);for(let a=0;a<64;a++)d[a]=54^b[a],e[a]=92^b[a];let f=new Uint8Array(a.length+64);f.set(d,0),f.set(a,64);let g=new Uint8Array(96);return g.set(e,0),g.set(eZ(f),64),eB.from(eZ(g))},"digest")}},"update")}}eM(e2,{createHash:()=>e4,createHmac:()=>e5,randomBytes:()=>e3});var e6=eK(()=>{eU(),e0(),e1(),eJ(e3,"randomBytes"),eJ(e4,"createHash"),eJ(e5,"createHmac")}),e7=eL(a=>{eU(),a.parse=function(a,b){return new c(a,b).parse()};var b=class a{constructor(a,b){this.source=a,this.transform=b||d,this.position=0,this.entries=[],this.recorded=[],this.dimension=0}isEof(){return this.position>=this.source.length}nextCharacter(){var a=this.source[this.position++];return"\\"===a?{value:this.source[this.position++],escaped:!0}:{value:a,escaped:!1}}record(a){this.recorded.push(a)}newEntry(a){var b;(this.recorded.length>0||a)&&("NULL"!==(b=this.recorded.join(""))||a||(b=null),null!==b&&(b=this.transform(b)),this.entries.push(b),this.recorded=[])}consumeDimensions(){if("["===this.source[0])for(;!this.isEof()&&"="!==this.nextCharacter().value;);}parse(b){var c,d,e;for(this.consumeDimensions();!this.isEof();)if("{"!==(c=this.nextCharacter()).value||e){if("}"!==c.value||e)'"'!==c.value||c.escaped?","!==c.value||e?this.record(c.value):this.newEntry():(e&&this.newEntry(!0),e=!e);else if(this.dimension--,!this.dimension&&(this.newEntry(),b))return this.entries}else this.dimension++,this.dimension>1&&(d=new a(this.source.substr(this.position-1),this.transform),this.entries.push(d.parse(!0)),this.position+=d.position-2);if(0!==this.dimension)throw Error("array dimension not balanced");return this.entries}};eJ(b,"ArrayParser");var c=b;function d(a){return a}eJ(d,"identity")}),e8=eL((a,b)=>{eU();var c=e7();b.exports={create:eJ(function(a,b){return{parse:eJ(function(){return c.parse(a,b)},"parse")}},"create")}}),e9=eL((a,b)=>{eU();var c=/(\d{1,})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2})(\.\d{1,})?.*?( BC)?$/,d=/^(\d{1,})-(\d{2})-(\d{2})( BC)?$/,e=/([Z+-])(\d{2})?:?(\d{2})?:?(\d{2})?/,f=/^-?infinity$/;function g(a){var b=d.exec(a);if(b){var c=parseInt(b[1],10);b[4]&&(c=i(c));var e=new Date(c,parseInt(b[2],10)-1,b[3]);return j(c)&&e.setFullYear(c),e}}function h(a){if(a.endsWith("+00"))return 0;var b=e.exec(a.split(" ")[1]);if(b){var c=b[1];return"Z"===c?0:(3600*parseInt(b[2],10)+60*parseInt(b[3]||0,10)+parseInt(b[4]||0,10))*("-"===c?-1:1)*1e3}}function i(a){return-(a-1)}function j(a){return a>=0&&a<100}b.exports=eJ(function(a){if(f.test(a))return Number(a.replace("i","I"));var b=c.exec(a);if(!b)return g(a)||null;var d=!!b[8],e=parseInt(b[1],10);d&&(e=i(e));var k=parseInt(b[2],10)-1,l=b[3],m=parseInt(b[4],10),n=parseInt(b[5],10),o=parseInt(b[6],10),p=b[7];p=p?1e3*parseFloat(p):0;var q,r=h(a);return null!=r?(q=new Date(Date.UTC(e,k,l,m,n,o,p)),j(e)&&q.setUTCFullYear(e),0!==r&&q.setTime(q.getTime()-r)):(q=new Date(e,k,l,m,n,o,p),j(e)&&q.setFullYear(e)),q},"parseDate"),eJ(g,"getDate"),eJ(h,"timeZoneOffset"),eJ(i,"bcYearToNegativeYear"),eJ(j,"is0To99")}),fa=eL((a,b)=>{eU(),b.exports=d;var c=Object.prototype.hasOwnProperty;function d(a){for(var b=1;b<arguments.length;b++){var d=arguments[b];for(var e in d)c.call(d,e)&&(a[e]=d[e])}return a}eJ(d,"extend")}),fb=eL((a,b)=>{eU();var c=fa();function d(a){if(!(this instanceof d))return new d(a);c(this,n(a))}b.exports=d,eJ(d,"PostgresInterval");var e=["seconds","minutes","hours","days","months","years"];d.prototype.toPostgres=function(){var a=e.filter(this.hasOwnProperty,this);return this.milliseconds&&0>a.indexOf("seconds")&&a.push("seconds"),0===a.length?"0":a.map(function(a){var b=this[a]||0;return"seconds"===a&&this.milliseconds&&(b=(b+this.milliseconds/1e3).toFixed(6).replace(/\.?0+$/,"")),b+" "+a},this).join(" ")};var f={years:"Y",months:"M",days:"D",hours:"H",minutes:"M",seconds:"S"},g=["years","months","days"],h=["hours","minutes","seconds"];d.prototype.toISOString=d.prototype.toISO=function(){return"P"+g.map(a,this).join("")+"T"+h.map(a,this).join("");function a(a){var b=this[a]||0;return"seconds"===a&&this.milliseconds&&(b=(b+this.milliseconds/1e3).toFixed(6).replace(/0+$/,"")),b+f[a]}};var i="([+-]?\\d+)",j=new RegExp([i+"\\s+years?",i+"\\s+mons?",i+"\\s+days?","([+-])?([\\d]*):(\\d\\d):(\\d\\d)\\.?(\\d{1,6})?"].map(function(a){return"("+a+")?"}).join("\\s*")),k={years:2,months:4,days:6,hours:9,minutes:10,seconds:11,milliseconds:12},l=["hours","minutes","seconds","milliseconds"];function m(a){return parseInt(a+"000000".slice(a.length),10)/1e3}function n(a){if(!a)return{};var b=j.exec(a),c="-"===b[8];return Object.keys(k).reduce(function(a,d){var e=b[k[d]];return e&&(e="milliseconds"===d?m(e):parseInt(e,10))&&(c&&~l.indexOf(d)&&(e*=-1),a[d]=e),a},{})}eJ(m,"parseMilliseconds"),eJ(n,"parse")}),fc=eL((a,b)=>{eU(),b.exports=eJ(function(a){if(/^\\x/.test(a))return new eB(a.substr(2),"hex");for(var b="",c=0;c<a.length;)if("\\"!==a[c])b+=a[c],++c;else if(/[0-7]{3}/.test(a.substr(c+1,3)))b+=String.fromCharCode(parseInt(a.substr(c+1,3),8)),c+=4;else{for(var d=1;c+d<a.length&&"\\"===a[c+d];)d++;for(var e=0;e<Math.floor(d/2);++e)b+="\\";c+=2*Math.floor(d/2)}return new eB(b,"binary")},"parseBytea")}),fd=eL((a,b)=>{eU();var c=e7(),d=e8(),e=e9(),f=fb(),g=fc();function h(a){return eJ(function(b){return null===b?b:a(b)},"nullAllowed")}function i(a){return null===a?a:"TRUE"===a||"t"===a||"true"===a||"y"===a||"yes"===a||"on"===a||"1"===a}function j(a){return a?c.parse(a,i):null}function k(a){return parseInt(a,10)}function l(a){return a?c.parse(a,h(k)):null}function m(a){return a?c.parse(a,h(function(a){return u(a).trim()})):null}eJ(h,"allowNull"),eJ(i,"parseBool"),eJ(j,"parseBoolArray"),eJ(k,"parseBaseTenInt"),eJ(l,"parseIntegerArray"),eJ(m,"parseBigIntegerArray");var n=eJ(function(a){return a?d.create(a,function(a){return null!==a&&(a=w(a)),a}).parse():null},"parsePointArray"),o=eJ(function(a){return a?d.create(a,function(a){return null!==a&&(a=parseFloat(a)),a}).parse():null},"parseFloatArray"),p=eJ(function(a){return a?d.create(a).parse():null},"parseStringArray"),q=eJ(function(a){return a?d.create(a,function(a){return null!==a&&(a=e(a)),a}).parse():null},"parseDateArray"),r=eJ(function(a){return a?d.create(a,function(a){return null!==a&&(a=f(a)),a}).parse():null},"parseIntervalArray"),s=eJ(function(a){return a?c.parse(a,h(g)):null},"parseByteAArray"),t=eJ(function(a){return parseInt(a,10)},"parseInteger"),u=eJ(function(a){var b=String(a);return/^\d+$/.test(b)?b:a},"parseBigInteger"),v=eJ(function(a){return a?c.parse(a,h(JSON.parse)):null},"parseJsonArray"),w=eJ(function(a){return"("!==a[0]?null:{x:parseFloat((a=a.substring(1,a.length-1).split(","))[0]),y:parseFloat(a[1])}},"parsePoint"),x=eJ(function(a){if("<"!==a[0]&&"("!==a[1])return null;for(var b="(",c="",d=!1,e=2;e<a.length-1;e++){if(d||(b+=a[e]),")"===a[e]){d=!0;continue}d&&","!==a[e]&&(c+=a[e])}var f=w(b);return f.radius=parseFloat(c),f},"parseCircle");b.exports={init:eJ(function(a){a(20,u),a(21,t),a(23,t),a(26,t),a(700,parseFloat),a(701,parseFloat),a(16,i),a(1082,e),a(1114,e),a(1184,e),a(600,w),a(651,p),a(718,x),a(1e3,j),a(1001,s),a(1005,l),a(1007,l),a(1028,l),a(1016,m),a(1017,n),a(1021,o),a(1022,o),a(1231,o),a(1014,p),a(1015,p),a(1008,p),a(1009,p),a(1040,p),a(1041,p),a(1115,q),a(1182,q),a(1185,q),a(1186,f),a(1187,r),a(17,g),a(114,JSON.parse.bind(JSON)),a(3802,JSON.parse.bind(JSON)),a(199,v),a(3807,v),a(3907,p),a(2951,p),a(791,p),a(1183,p),a(1270,p)},"init")}}),fe=eL((a,b)=>{function c(a){var b=a.readInt32BE(0),c=a.readUInt32BE(4),d="";b<0&&(b=~b+(0===c),c=~c+1>>>0,d="-");var e,f,g,h,i,j,k="";if(e=b%1e6,b=b/1e6>>>0,c=(f=0x100000000*e+c)/1e6>>>0,g=""+(f-1e6*c),0===c&&0===b)return d+g+k;for(h="",i=6-g.length,j=0;j<i;j++)h+="0";if(k=h+g+k,e=b%1e6,b=b/1e6>>>0,c=(f=0x100000000*e+c)/1e6>>>0,g=""+(f-1e6*c),0===c&&0===b)return d+g+k;for(h="",i=6-g.length,j=0;j<i;j++)h+="0";if(k=h+g+k,e=b%1e6,b=b/1e6>>>0,c=(f=0x100000000*e+c)/1e6>>>0,g=""+(f-1e6*c),0===c&&0===b)return d+g+k;for(h="",i=6-g.length,j=0;j<i;j++)h+="0";return k=h+g+k,d+(g=""+(f=0x100000000*(e=b%1e6)+c)%1e6)+k}eU(),eJ(c,"readInt8"),b.exports=c}),ff=eL((a,b)=>{eU();var c=fe(),d=eJ(function(a,b,c,d,e){c=c||0,d=d||!1,e=e||function(a,b,c){return a*Math.pow(2,c)+b};var f=c>>3,g=eJ(function(a){return d?255&~a:a},"inv"),h=255,i=8-c%8;b<i&&(h=255<<8-b&255,i=b),c&&(h>>=c%8);var j=0;c%8+b>=8&&(j=e(0,g(a[f])&h,i));for(var k=b+c>>3,l=f+1;l<k;l++)j=e(j,g(a[l]),8);var m=(b+c)%8;return m>0&&(j=e(j,g(a[k])>>8-m,m)),j},"parseBits"),e=eJ(function(a,b,c){var e=Math.pow(2,c-1)-1,f=d(a,1),g=d(a,c,1);if(0===g)return 0;var h=1,i=d(a,b,c+1,!1,eJ(function(a,b,c){0===a&&(a=1);for(var d=1;d<=c;d++)h/=2,(b&1<<c-d)>0&&(a+=h);return a},"parsePrecisionBits"));return g==Math.pow(2,c+1)-1?0===i?0===f?1/0:-1/0:NaN:(0===f?1:-1)*Math.pow(2,g-e)*i},"parseFloatFromBits"),f=eJ(function(a){return 1==d(a,1)?-1*(d(a,15,1,!0)+1):d(a,15,1)},"parseInt16"),g=eJ(function(a){return 1==d(a,1)?-1*(d(a,31,1,!0)+1):d(a,31,1)},"parseInt32"),h=eJ(function(a){return e(a,23,8)},"parseFloat32"),i=eJ(function(a){return e(a,52,11)},"parseFloat64"),j=eJ(function(a){var b=d(a,16,32);if(49152==b)return NaN;for(var c=Math.pow(1e4,d(a,16,16)),e=0,f=d(a,16),g=0;g<f;g++)e+=d(a,16,64+16*g)*c,c/=1e4;var h=Math.pow(10,d(a,16,48));return(0===b?1:-1)*Math.round(e*h)/h},"parseNumeric"),k=eJ(function(a,b){var c=d(b,1),e=d(b,63,1),f=new Date((0===c?1:-1)*e/1e3+9466848e5);return a||f.setTime(f.getTime()+6e4*f.getTimezoneOffset()),f.usec=e%1e3,f.getMicroSeconds=function(){return this.usec},f.setMicroSeconds=function(a){this.usec=a},f.getUTCMicroSeconds=function(){return this.usec},f},"parseDate"),l=eJ(function(a){for(var b=d(a,32),c=(d(a,32,32),d(a,32,64)),e=96,f=[],g=0;g<b;g++)f[g]=d(a,32,e),e+=64;var h=eJ(function(b){var c,f=d(a,32,e);return(e+=32,0xffffffff==f)?null:23==b||20==b?(c=d(a,8*f,e),e+=8*f,c):25==b?a.toString(this.encoding,e>>3,(e+=f<<3)>>3):void console.log("ERROR: ElementType not implemented: "+b)},"parseElement"),i=eJ(function(a,b){var c,d=[];if(a.length>1){var e=a.shift();for(c=0;c<e;c++)d[c]=i(a,b);a.unshift(e)}else for(c=0;c<a[0];c++)d[c]=h(b);return d},"parse");return i(f,c)},"parseArray"),m=eJ(function(a){return a.toString("utf8")},"parseText"),n=eJ(function(a){return null===a?null:d(a,8)>0},"parseBool");b.exports={init:eJ(function(a){a(20,c),a(21,f),a(23,g),a(26,g),a(1700,j),a(700,h),a(701,i),a(16,n),a(1114,k.bind(null,!1)),a(1184,k.bind(null,!0)),a(1e3,l),a(1007,l),a(1016,l),a(1008,l),a(1009,l),a(25,m)},"init")}}),fg=eL((a,b)=>{eU(),b.exports={BOOL:16,BYTEA:17,CHAR:18,INT8:20,INT2:21,INT4:23,REGPROC:24,TEXT:25,OID:26,TID:27,XID:28,CID:29,JSON:114,XML:142,PG_NODE_TREE:194,SMGR:210,PATH:602,POLYGON:604,CIDR:650,FLOAT4:700,FLOAT8:701,ABSTIME:702,RELTIME:703,TINTERVAL:704,CIRCLE:718,MACADDR8:774,MONEY:790,MACADDR:829,INET:869,ACLITEM:1033,BPCHAR:1042,VARCHAR:1043,DATE:1082,TIME:1083,TIMESTAMP:1114,TIMESTAMPTZ:1184,INTERVAL:1186,TIMETZ:1266,BIT:1560,VARBIT:1562,NUMERIC:1700,REFCURSOR:1790,REGPROCEDURE:2202,REGOPER:2203,REGOPERATOR:2204,REGCLASS:2205,REGTYPE:2206,UUID:2950,TXID_SNAPSHOT:2970,PG_LSN:3220,PG_NDISTINCT:3361,PG_DEPENDENCIES:3402,TSVECTOR:3614,TSQUERY:3615,GTSVECTOR:3642,REGCONFIG:3734,REGDICTIONARY:3769,JSONB:3802,REGNAMESPACE:4089,REGROLE:4096}}),fh=eL(a=>{eU();var b=fd(),c=ff(),d=e8(),e=fg();a.getTypeParser=h,a.setTypeParser=i,a.arrayParser=d,a.builtins=e;var f={text:{},binary:{}};function g(a){return String(a)}function h(a,b){return f[b=b||"text"]&&f[b][a]||g}function i(a,b,c){"function"==typeof b&&(c=b,b="text"),f[b][a]=c}eJ(g,"noParse"),eJ(h,"getTypeParser"),eJ(i,"setTypeParser"),b.init(function(a,b){f.text[a]=b}),c.init(function(a,b){f.binary[a]=b})}),fi=eL((a,b)=>{eU(),b.exports={host:"localhost",user:"win32"===eC.platform?eC.env.USERNAME:eC.env.USER,database:void 0,password:null,connectionString:void 0,port:5432,rows:0,binary:!1,max:10,idleTimeoutMillis:3e4,client_encoding:"",ssl:!1,application_name:void 0,fallback_application_name:void 0,options:void 0,parseInputDatesAsUTC:!1,statement_timeout:!1,lock_timeout:!1,idle_in_transaction_session_timeout:!1,query_timeout:!1,connect_timeout:0,keepalives:1,keepalives_idle:0};var c=fh(),d=c.getTypeParser(20,"text"),e=c.getTypeParser(1016,"text");b.exports.__defineSetter__("parseInt8",function(a){c.setTypeParser(20,"text",a?c.getTypeParser(23,"text"):d),c.setTypeParser(1016,"text",a?c.getTypeParser(1007,"text"):e)})}),fj=eL((a,b)=>{eU();var c=(e6(),eP(e2)),d=fi();function e(a){return'"'+a.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'}function f(a){for(var b="{",c=0;c<a.length;c++)c>0&&(b+=","),null===a[c]||typeof a[c]>"u"?b+="NULL":Array.isArray(a[c])?b+=f(a[c]):a[c]instanceof eB?b+="\\\\x"+a[c].toString("hex"):b+=e(g(a[c]));return b+"}"}eJ(e,"escapeElement"),eJ(f,"arrayString");var g=eJ(function(a,b){if(null==a)return null;if(a instanceof eB)return a;if(ArrayBuffer.isView(a)){var c=eB.from(a.buffer,a.byteOffset,a.byteLength);return c.length===a.byteLength?c:c.slice(a.byteOffset,a.byteOffset+a.byteLength)}return a instanceof Date?d.parseInputDatesAsUTC?k(a):j(a):Array.isArray(a)?f(a):"object"==typeof a?h(a,b):a.toString()},"prepareValue");function h(a,b){if(a&&"function"==typeof a.toPostgres){if(-1!==(b=b||[]).indexOf(a))throw Error('circular reference detected while preparing "'+a+'" for query');return b.push(a),g(a.toPostgres(g),b)}return JSON.stringify(a)}function i(a,b){for(a=""+a;a.length<b;)a="0"+a;return a}function j(a){var b=-a.getTimezoneOffset(),c=a.getFullYear(),d=c<1;d&&(c=Math.abs(c)+1);var e=i(c,4)+"-"+i(a.getMonth()+1,2)+"-"+i(a.getDate(),2)+"T"+i(a.getHours(),2)+":"+i(a.getMinutes(),2)+":"+i(a.getSeconds(),2)+"."+i(a.getMilliseconds(),3);return b<0?(e+="-",b*=-1):e+="+",e+=i(Math.floor(b/60),2)+":"+i(b%60,2),d&&(e+=" BC"),e}function k(a){var b=a.getUTCFullYear(),c=b<1;c&&(b=Math.abs(b)+1);var d=i(b,4)+"-"+i(a.getUTCMonth()+1,2)+"-"+i(a.getUTCDate(),2)+"T"+i(a.getUTCHours(),2)+":"+i(a.getUTCMinutes(),2)+":"+i(a.getUTCSeconds(),2)+"."+i(a.getUTCMilliseconds(),3);return d+="+00:00",c&&(d+=" BC"),d}function l(a,b,c){return a="string"==typeof a?{text:a}:a,b&&("function"==typeof b?a.callback=b:a.values=b),c&&(a.callback=c),a}eJ(h,"prepareObject"),eJ(i,"pad"),eJ(j,"dateToString"),eJ(k,"dateToStringUTC"),eJ(l,"normalizeQueryConfig");var m=eJ(function(a){return c.createHash("md5").update(a,"utf-8").digest("hex")},"md5"),n=eJ(function(a,b,c){var d=m(b+a);return"md5"+m(eB.concat([eB.from(d),c]))},"postgresMd5PasswordHash");b.exports={prepareValue:eJ(function(a){return g(a)},"prepareValueWrapper"),normalizeQueryConfig:l,postgresMd5PasswordHash:n,md5:m}}),fk=eL((a,b)=>{eU();var c=(e6(),eP(e2));function d(a){if(-1===a.indexOf("SCRAM-SHA-256"))throw Error("SASL: Only mechanism SCRAM-SHA-256 is currently supported");let b=c.randomBytes(18).toString("base64");return{mechanism:"SCRAM-SHA-256",clientNonce:b,response:"n,,n=*,r="+b,message:"SASLInitialResponse"}}function e(a,b,c){if("SASLInitialResponse"!==a.message)throw Error("SASL: Last message was not SASLInitialResponse");if("string"!=typeof b)throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: client password must be a string");if("string"!=typeof c)throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: serverData must be a string");let d=j(c);if(d.nonce.startsWith(a.clientNonce)){if(d.nonce.length===a.clientNonce.length)throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce is too short")}else throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce does not start with client nonce");var e=o(b,eB.from(d.salt,"base64"),d.iteration),f=n(e,"Client Key"),g=m(f),h="n=*,r="+a.clientNonce,i="r="+d.nonce+",s="+d.salt+",i="+d.iteration,k="c=biws,r="+d.nonce,p=h+","+i+","+k,q=l(f,n(g,p)).toString("base64"),r=n(e,"Server Key"),s=n(r,p);a.message="SASLResponse",a.serverSignature=s.toString("base64"),a.response=k+",p="+q}function f(a,b){if("SASLResponse"!==a.message)throw Error("SASL: Last message was not SASLResponse");if("string"!=typeof b)throw Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: serverData must be a string");let{serverSignature:c}=k(b);if(c!==a.serverSignature)throw Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature does not match")}function g(a){if("string"!=typeof a)throw TypeError("SASL: text must be a string");return a.split("").map((b,c)=>a.charCodeAt(c)).every(a=>a>=33&&a<=43||a>=45&&a<=126)}function h(a){return/^(?:[a-zA-Z0-9+/]{4})*(?:[a-zA-Z0-9+/]{2}==|[a-zA-Z0-9+/]{3}=)?$/.test(a)}function i(a){if("string"!=typeof a)throw TypeError("SASL: attribute pairs text must be a string");return new Map(a.split(",").map(a=>{if(!/^.=/.test(a))throw Error("SASL: Invalid attribute pair entry");return[a[0],a.substring(2)]}))}function j(a){let b=i(a),c=b.get("r");if(c){if(!g(c))throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce must only contain printable characters")}else throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce missing");let d=b.get("s");if(d){if(!h(d))throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt must be base64")}else throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt missing");let e=b.get("i");if(e){if(!/^[1-9][0-9]*$/.test(e))throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: invalid iteration count")}else throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: iteration missing");return{nonce:c,salt:d,iteration:parseInt(e,10)}}function k(a){let b=i(a).get("v");if(b){if(!h(b))throw Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature must be base64")}else throw Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature is missing");return{serverSignature:b}}function l(a,b){if(!eB.isBuffer(a))throw TypeError("first argument must be a Buffer");if(!eB.isBuffer(b))throw TypeError("second argument must be a Buffer");if(a.length!==b.length)throw Error("Buffer lengths must match");if(0===a.length)throw Error("Buffers cannot be empty");return eB.from(a.map((c,d)=>a[d]^b[d]))}function m(a){return c.createHash("sha256").update(a).digest()}function n(a,b){return c.createHmac("sha256",a).update(b).digest()}function o(a,b,c){for(var d=n(a,eB.concat([b,eB.from([0,0,0,1])])),e=d,f=0;f<c-1;f++)e=l(e,d=n(a,d));return e}eJ(d,"startSession"),eJ(e,"continueSession"),eJ(f,"finalizeSession"),eJ(g,"isPrintableChars"),eJ(h,"isBase64"),eJ(i,"parseAttributePairs"),eJ(j,"parseServerFirstMessage"),eJ(k,"parseServerFinalMessage"),eJ(l,"xorBuffers"),eJ(m,"sha256"),eJ(n,"hmacSha256"),eJ(o,"Hi"),b.exports={startSession:d,continueSession:e,finalizeSession:f}}),fl={};function fm(...a){return a.join("/")}eM(fl,{join:()=>fm});var fn=eK(()=>{eU(),eJ(fm,"join")}),fo={};function fp(a,b){b(Error("No filesystem"))}eM(fo,{stat:()=>fp});var fq=eK(()=>{eU(),eJ(fp,"stat")}),fr={};eM(fr,{default:()=>fs});var fs,ft=eK(()=>{eU(),fs={}}),fu={};eM(fu,{StringDecoder:()=>fw});var fv,fw,fx=eK(()=>{eU(),eJ(fv=class{constructor(a){eQ(this,"td"),this.td=new TextDecoder(a)}write(a){return this.td.decode(a,{stream:!0})}end(a){return this.td.decode(a)}},"StringDecoder"),fw=fv}),fy=eL((a,b)=>{eU();var{Transform:c}=(ft(),eP(fr)),{StringDecoder:d}=(fx(),eP(fu)),e=Symbol("last"),f=Symbol("decoder");function g(a,b,c){let d;if(this.overflow){if(1===(d=this[f].write(a).split(this.matcher)).length)return c();d.shift(),this.overflow=!1}else this[e]+=this[f].write(a),d=this[e].split(this.matcher);this[e]=d.pop();for(let a=0;a<d.length;a++)try{i(this,this.mapper(d[a]))}catch(a){return c(a)}if(this.overflow=this[e].length>this.maxLength,this.overflow&&!this.skipOverflow)return void c(Error("maximum buffer reached"));c()}function h(a){if(this[e]+=this[f].end(),this[e])try{i(this,this.mapper(this[e]))}catch(b){return a(b)}a()}function i(a,b){void 0!==b&&a.push(b)}function j(a){return a}function k(a,b,i){switch(a=a||/\r?\n/,b=b||j,i=i||{},arguments.length){case 1:"function"==typeof a?(b=a,a=/\r?\n/):"object"!=typeof a||a instanceof RegExp||a[Symbol.split]||(i=a,a=/\r?\n/);break;case 2:"function"==typeof a?(i=b,b=a,a=/\r?\n/):"object"==typeof b&&(i=b,b=j)}(i=Object.assign({},i)).autoDestroy=!0,i.transform=g,i.flush=h,i.readableObjectMode=!0;let k=new c(i);return k[e]="",k[f]=new d("utf8"),k.matcher=a,k.mapper=b,k.maxLength=i.maxLength,k.skipOverflow=i.skipOverflow||!1,k.overflow=!1,k._destroy=function(a,b){this._writableState.errorEmitted=!1,b(a)},k}eJ(g,"transform"),eJ(h,"flush"),eJ(i,"push"),eJ(j,"noop"),eJ(k,"split"),b.exports=k}),fz=eL((a,b)=>{eU();var c=(fn(),eP(fl)),d=(ft(),eP(fr)).Stream,e=fy(),f=(eY(),eP(eW)),g="win32"===eC.platform,h=eC.stderr;function i(a){return(61440&a)==32768}eJ(i,"isRegFile");var j=["host","port","database","user","password"],k=j.length,l=j[k-1];function m(){if(h instanceof d&&!0===h.writable){var a=Array.prototype.slice.call(arguments).concat(`
`);h.write(f.format.apply(f,a))}}eJ(m,"warn"),Object.defineProperty(b.exports,"isWin",{get:eJ(function(){return g},"get"),set:eJ(function(a){g=a},"set")}),b.exports.warnTo=function(a){var b=h;return h=a,b},b.exports.getFileName=function(a){var b=a||eC.env;return b.PGPASSFILE||(g?c.join(b.APPDATA||"./","postgresql","pgpass.conf"):c.join(b.HOME||"./",".pgpass"))},b.exports.usePgPass=function(a,b){return!Object.prototype.hasOwnProperty.call(eC.env,"PGPASSWORD")&&(!!g||(b=b||"<unkn>",i(a.mode)?!(63&a.mode)||(m('WARNING: password file "%s" has group or world access; permissions should be u=rw (0600) or less',b),!1):(m('WARNING: password file "%s" is not a plain file',b),!1)))};var n=b.exports.match=function(a,b){return j.slice(0,-1).reduce(function(c,d,e){return 1==e&&Number(a[d]||5432)===Number(b[d])?c&&!0:c&&("*"===b[d]||b[d]===a[d])},!0)};b.exports.getPassword=function(a,b,c){var d,f=b.pipe(e());function g(b){var c=o(b);c&&p(c)&&n(a,c)&&(d=c[l],f.end())}eJ(g,"onLine");var h=eJ(function(){b.destroy(),c(d)},"onEnd"),i=eJ(function(a){b.destroy(),m("WARNING: error on reading file: %s",a),c(void 0)},"onErr");b.on("error",i),f.on("data",g).on("end",h).on("error",i)};var o=b.exports.parseLine=function(a){if(a.length<11||a.match(/^\s+#/))return null;for(var b="",c="",d=0,e=0,f={},g=eJ(function(b,c,d){var e=a.substring(c,d);Object.hasOwnProperty.call(eC.env,"PGPASS_NO_DEESCAPE")||(e=e.replace(/\\([:\\])/g,"$1")),f[j[b]]=e},"addToObj"),h=0;h<a.length-1;h+=1){if(b=a.charAt(h+1),c=a.charAt(h),d==k-1){g(d,e);break}h>=0&&":"==b&&"\\"!==c&&(g(d,e,h+1),e=h+2,d+=1)}return f=Object.keys(f).length===k?f:null},p=b.exports.isValidEntry=function(a){for(var b={0:function(a){return a.length>0},1:function(a){return"*"===a||isFinite(a=Number(a))&&a>0&&a<0x20000000000000&&Math.floor(a)===a},2:function(a){return a.length>0},3:function(a){return a.length>0},4:function(a){return a.length>0}},c=0;c<j.length;c+=1)if(!(0,b[c])(a[j[c]]||""))return!1;return!0}}),fA=eL((a,b)=>{eU(),fn(),eP(fl);var c=(fq(),eP(fo)),d=fz();b.exports=function(a,b){var e=d.getFileName();c.stat(e,function(f,g){if(f||!d.usePgPass(g,e))return b(void 0);var h=c.createReadStream(e);d.getPassword(a,h,b)})},b.exports.warnTo=d.warnTo}),fB=eL((a,b)=>{eU();var c=fh();function d(a){this._types=a||c,this.text={},this.binary={}}eJ(d,"TypeOverrides"),d.prototype.getOverrides=function(a){switch(a){case"text":return this.text;case"binary":return this.binary;default:return{}}},d.prototype.setTypeParser=function(a,b,c){"function"==typeof b&&(c=b,b="text"),this.getOverrides(b)[a]=c},d.prototype.getTypeParser=function(a,b){return b=b||"text",this.getOverrides(b)[a]||this._types.getTypeParser(a,b)},b.exports=d}),fC={};eM(fC,{default:()=>fD});var fD,fE=eK(()=>{eU(),fD={}}),fF={};function fG(a,b=!1){let{protocol:c}=new URL(a),{username:d,password:e,host:f,hostname:g,port:h,pathname:i,search:j,searchParams:k,hash:l}=new URL("http:"+a.substring(c.length));e=decodeURIComponent(e),d=decodeURIComponent(d),i=decodeURIComponent(i);let m=d+":"+e,n=b?Object.fromEntries(k.entries()):j;return{href:a,protocol:c,auth:m,username:d,password:e,host:f,hostname:g,port:h,pathname:i,search:j,query:n,hash:l}}eM(fF,{parse:()=>fG});var fH=eK(()=>{eU(),eJ(fG,"parse")}),fI=eL((a,b)=>{eU();var c=(fH(),eP(fF)),d=(fq(),eP(fo));function e(a){if("/"===a.charAt(0)){var b=a.split(" ");return{host:b[0],database:b[1]}}var e=c.parse(/ |%[^a-f0-9]|%[a-f0-9][^a-f0-9]/i.test(a)?encodeURI(a).replace(/\%25(\d\d)/g,"%$1"):a,!0),b=e.query;for(var f in b)Array.isArray(b[f])&&(b[f]=b[f][b[f].length-1]);var g=(e.auth||":").split(":");if(b.user=g[0],b.password=g.splice(1).join(":"),b.port=e.port,"socket:"==e.protocol)return b.host=decodeURI(e.pathname),b.database=e.query.db,b.client_encoding=e.query.encoding,b;b.host||(b.host=e.hostname);var h=e.pathname;if(!b.host&&h&&/^%2f/i.test(h)){var i=h.split("/");b.host=decodeURIComponent(i[0]),h=i.splice(1).join("/")}switch(h&&"/"===h.charAt(0)&&(h=h.slice(1)||null),b.database=h&&decodeURI(h),("true"===b.ssl||"1"===b.ssl)&&(b.ssl=!0),"0"===b.ssl&&(b.ssl=!1),(b.sslcert||b.sslkey||b.sslrootcert||b.sslmode)&&(b.ssl={}),b.sslcert&&(b.ssl.cert=d.readFileSync(b.sslcert).toString()),b.sslkey&&(b.ssl.key=d.readFileSync(b.sslkey).toString()),b.sslrootcert&&(b.ssl.ca=d.readFileSync(b.sslrootcert).toString()),b.sslmode){case"disable":b.ssl=!1;break;case"prefer":case"require":case"verify-ca":case"verify-full":break;case"no-verify":b.ssl.rejectUnauthorized=!1}return b}eJ(e,"parse"),b.exports=e,e.parse=e}),fJ=eL((a,b)=>{eU();var c=(fE(),eP(fC)),d=fi(),e=fI().parse,f=eJ(function(a,b,c){return void 0===c?c=eC.env["PG"+a.toUpperCase()]:!1===c||(c=eC.env[c]),b[a]||c||d[a]},"val"),g=eJ(function(){switch(eC.env.PGSSLMODE){case"disable":return!1;case"prefer":case"require":case"verify-ca":case"verify-full":return!0;case"no-verify":return{rejectUnauthorized:!1}}return d.ssl},"readSSLConfigFromEnvironment"),h=eJ(function(a){return"'"+(""+a).replace(/\\/g,"\\\\").replace(/'/g,"\\'")+"'"},"quoteParamValue"),i=eJ(function(a,b,c){var d=b[c];null!=d&&a.push(c+"="+h(d))},"add"),j=class{constructor(a){(a="string"==typeof a?e(a):a||{}).connectionString&&(a=Object.assign({},a,e(a.connectionString))),this.user=f("user",a),this.database=f("database",a),void 0===this.database&&(this.database=this.user),this.port=parseInt(f("port",a),10),this.host=f("host",a),Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:f("password",a)}),this.binary=f("binary",a),this.options=f("options",a),this.ssl=typeof a.ssl>"u"?g():a.ssl,"string"==typeof this.ssl&&"true"===this.ssl&&(this.ssl=!0),"no-verify"===this.ssl&&(this.ssl={rejectUnauthorized:!1}),this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this.client_encoding=f("client_encoding",a),this.replication=f("replication",a),this.isDomainSocket=!(this.host||"").indexOf("/"),this.application_name=f("application_name",a,"PGAPPNAME"),this.fallback_application_name=f("fallback_application_name",a,!1),this.statement_timeout=f("statement_timeout",a,!1),this.lock_timeout=f("lock_timeout",a,!1),this.idle_in_transaction_session_timeout=f("idle_in_transaction_session_timeout",a,!1),this.query_timeout=f("query_timeout",a,!1),void 0===a.connectionTimeoutMillis?this.connect_timeout=eC.env.PGCONNECT_TIMEOUT||0:this.connect_timeout=Math.floor(a.connectionTimeoutMillis/1e3),!1===a.keepAlive?this.keepalives=0:!0===a.keepAlive&&(this.keepalives=1),"number"==typeof a.keepAliveInitialDelayMillis&&(this.keepalives_idle=Math.floor(a.keepAliveInitialDelayMillis/1e3))}getLibpqConnectionString(a){var b=[];i(b,this,"user"),i(b,this,"password"),i(b,this,"port"),i(b,this,"application_name"),i(b,this,"fallback_application_name"),i(b,this,"connect_timeout"),i(b,this,"options");var d="object"==typeof this.ssl?this.ssl:this.ssl?{sslmode:this.ssl}:{};if(i(b,d,"sslmode"),i(b,d,"sslca"),i(b,d,"sslkey"),i(b,d,"sslcert"),i(b,d,"sslrootcert"),this.database&&b.push("dbname="+h(this.database)),this.replication&&b.push("replication="+h(this.replication)),this.host&&b.push("host="+h(this.host)),this.isDomainSocket)return a(null,b.join(" "));this.client_encoding&&b.push("client_encoding="+h(this.client_encoding)),c.lookup(this.host,function(c,d){return c?a(c,null):(b.push("hostaddr="+h(d)),a(null,b.join(" ")))})}};eJ(j,"ConnectionParameters"),b.exports=j}),fK=eL((a,b)=>{eU();var c=fh(),d=/^([A-Za-z]+)(?: (\d+))?(?: (\d+))?/,e=class{constructor(a,b){this.command=null,this.rowCount=null,this.oid=null,this.rows=[],this.fields=[],this._parsers=void 0,this._types=b,this.RowCtor=null,this.rowAsArray="array"===a,this.rowAsArray&&(this.parseRow=this._parseRowAsArray)}addCommandComplete(a){var b;(b=a.text?d.exec(a.text):d.exec(a.command))&&(this.command=b[1],b[3]?(this.oid=parseInt(b[2],10),this.rowCount=parseInt(b[3],10)):b[2]&&(this.rowCount=parseInt(b[2],10)))}_parseRowAsArray(a){for(var b=Array(a.length),c=0,d=a.length;c<d;c++){var e=a[c];null!==e?b[c]=this._parsers[c](e):b[c]=null}return b}parseRow(a){for(var b={},c=0,d=a.length;c<d;c++){var e=a[c],f=this.fields[c].name;null!==e?b[f]=this._parsers[c](e):b[f]=null}return b}addRow(a){this.rows.push(a)}addFields(a){this.fields=a,this.fields.length&&(this._parsers=Array(a.length));for(var b=0;b<a.length;b++){var d=a[b];this._types?this._parsers[b]=this._types.getTypeParser(d.dataTypeID,d.format||"text"):this._parsers[b]=c.getTypeParser(d.dataTypeID,d.format||"text")}}};eJ(e,"Result"),b.exports=e}),fL=eL((a,b)=>{eU();var{EventEmitter:c}=eV(),d=fK(),e=fj(),f=class extends c{constructor(a,b,c){super(),a=e.normalizeQueryConfig(a,b,c),this.text=a.text,this.values=a.values,this.rows=a.rows,this.types=a.types,this.name=a.name,this.binary=a.binary,this.portal=a.portal||"",this.callback=a.callback,this._rowMode=a.rowMode,eC.domain&&a.callback&&(this.callback=eC.domain.bind(a.callback)),this._result=new d(this._rowMode,this.types),this._results=this._result,this.isPreparedStatement=!1,this._canceledDueToError=!1,this._promise=null}requiresPreparation(){return!!this.name||!!this.rows||!!this.text&&!!this.values&&this.values.length>0}_checkForMultirow(){this._result.command&&(Array.isArray(this._results)||(this._results=[this._result]),this._result=new d(this._rowMode,this.types),this._results.push(this._result))}handleRowDescription(a){this._checkForMultirow(),this._result.addFields(a.fields),this._accumulateRows=this.callback||!this.listeners("row").length}handleDataRow(a){let b;if(!this._canceledDueToError){try{b=this._result.parseRow(a.fields)}catch(a){this._canceledDueToError=a;return}this.emit("row",b,this._result),this._accumulateRows&&this._result.addRow(b)}}handleCommandComplete(a,b){this._checkForMultirow(),this._result.addCommandComplete(a),this.rows&&b.sync()}handleEmptyQuery(a){this.rows&&a.sync()}handleError(a,b){if(this._canceledDueToError&&(a=this._canceledDueToError,this._canceledDueToError=!1),this.callback)return this.callback(a);this.emit("error",a)}handleReadyForQuery(a){if(this._canceledDueToError)return this.handleError(this._canceledDueToError,a);if(this.callback)try{this.callback(null,this._results)}catch(a){eC.nextTick(()=>{throw a})}this.emit("end",this._results)}submit(a){if("string"!=typeof this.text&&"string"!=typeof this.name)return Error("A query must have either text or a name. Supplying neither is unsupported.");let b=a.parsedStatements[this.name];return this.text&&b&&this.text!==b?Error(`Prepared statements must be \
unique - '${this.name}' was used for a different statement`):this.values&&!Array.isArray(this.values)?Error("Query values must be an array"):(this.requiresPreparation()?this.prepare(a):a.query(this.text),null)}hasBeenParsed(a){return this.name&&a.parsedStatements[this.name]}handlePortalSuspended(a){this._getRows(a,this.rows)}_getRows(a,b){a.execute({portal:this.portal,rows:b}),b?a.flush():a.sync()}prepare(a){this.isPreparedStatement=!0,this.hasBeenParsed(a)||a.parse({text:this.text,name:this.name,types:this.types});try{a.bind({portal:this.portal,statement:this.name,values:this.values,binary:this.binary,valueMapper:e.prepareValue})}catch(b){this.handleError(b,a);return}a.describe({type:"P",name:this.portal||""}),this._getRows(a,this.rows)}handleCopyInResponse(a){a.sendCopyFail("No source stream defined")}handleCopyData(a,b){}};eJ(f,"Query"),b.exports=f}),fM={};function fN(a){return 0}eM(fM,{Socket:()=>fR,isIP:()=>fN});var fO,fP,fQ,fR,fS=eK(()=>{eU(),fO=eO(eV(),1),eJ(fN,"isIP"),fP=/^[^.]+\./,fQ=class a extends fO.EventEmitter{constructor(){super(...arguments),eQ(this,"opts",{}),eQ(this,"connecting",!1),eQ(this,"pending",!0),eQ(this,"writable",!0),eQ(this,"encrypted",!1),eQ(this,"authorized",!1),eQ(this,"destroyed",!1),eQ(this,"ws",null),eQ(this,"writeBuffer"),eQ(this,"tlsState",0),eQ(this,"tlsRead"),eQ(this,"tlsWrite")}static get poolQueryViaFetch(){return a.opts.poolQueryViaFetch??a.defaults.poolQueryViaFetch}static set poolQueryViaFetch(b){a.opts.poolQueryViaFetch=b}static get fetchEndpoint(){return a.opts.fetchEndpoint??a.defaults.fetchEndpoint}static set fetchEndpoint(b){a.opts.fetchEndpoint=b}static get fetchConnectionCache(){return!0}static set fetchConnectionCache(a){console.warn("The `fetchConnectionCache` option is deprecated (now always `true`)")}static get fetchFunction(){return a.opts.fetchFunction??a.defaults.fetchFunction}static set fetchFunction(b){a.opts.fetchFunction=b}static get webSocketConstructor(){return a.opts.webSocketConstructor??a.defaults.webSocketConstructor}static set webSocketConstructor(b){a.opts.webSocketConstructor=b}get webSocketConstructor(){return this.opts.webSocketConstructor??a.webSocketConstructor}set webSocketConstructor(a){this.opts.webSocketConstructor=a}static get wsProxy(){return a.opts.wsProxy??a.defaults.wsProxy}static set wsProxy(b){a.opts.wsProxy=b}get wsProxy(){return this.opts.wsProxy??a.wsProxy}set wsProxy(a){this.opts.wsProxy=a}static get coalesceWrites(){return a.opts.coalesceWrites??a.defaults.coalesceWrites}static set coalesceWrites(b){a.opts.coalesceWrites=b}get coalesceWrites(){return this.opts.coalesceWrites??a.coalesceWrites}set coalesceWrites(a){this.opts.coalesceWrites=a}static get useSecureWebSocket(){return a.opts.useSecureWebSocket??a.defaults.useSecureWebSocket}static set useSecureWebSocket(b){a.opts.useSecureWebSocket=b}get useSecureWebSocket(){return this.opts.useSecureWebSocket??a.useSecureWebSocket}set useSecureWebSocket(a){this.opts.useSecureWebSocket=a}static get forceDisablePgSSL(){return a.opts.forceDisablePgSSL??a.defaults.forceDisablePgSSL}static set forceDisablePgSSL(b){a.opts.forceDisablePgSSL=b}get forceDisablePgSSL(){return this.opts.forceDisablePgSSL??a.forceDisablePgSSL}set forceDisablePgSSL(a){this.opts.forceDisablePgSSL=a}static get disableSNI(){return a.opts.disableSNI??a.defaults.disableSNI}static set disableSNI(b){a.opts.disableSNI=b}get disableSNI(){return this.opts.disableSNI??a.disableSNI}set disableSNI(a){this.opts.disableSNI=a}static get pipelineConnect(){return a.opts.pipelineConnect??a.defaults.pipelineConnect}static set pipelineConnect(b){a.opts.pipelineConnect=b}get pipelineConnect(){return this.opts.pipelineConnect??a.pipelineConnect}set pipelineConnect(a){this.opts.pipelineConnect=a}static get subtls(){return a.opts.subtls??a.defaults.subtls}static set subtls(b){a.opts.subtls=b}get subtls(){return this.opts.subtls??a.subtls}set subtls(a){this.opts.subtls=a}static get pipelineTLS(){return a.opts.pipelineTLS??a.defaults.pipelineTLS}static set pipelineTLS(b){a.opts.pipelineTLS=b}get pipelineTLS(){return this.opts.pipelineTLS??a.pipelineTLS}set pipelineTLS(a){this.opts.pipelineTLS=a}static get rootCerts(){return a.opts.rootCerts??a.defaults.rootCerts}static set rootCerts(b){a.opts.rootCerts=b}get rootCerts(){return this.opts.rootCerts??a.rootCerts}set rootCerts(a){this.opts.rootCerts=a}wsProxyAddrForHost(a,b){let c=this.wsProxy;if(void 0===c)throw Error("No WebSocket proxy is configured. Please see https://github.com/neondatabase/serverless/blob/main/CONFIG.md#wsproxy-string--host-string-port-number--string--string");return"function"==typeof c?c(a,b):`${c}?address=${a}:${b}`}setNoDelay(){return this}setKeepAlive(){return this}ref(){return this}unref(){return this}connect(a,b,c){this.connecting=!0,c&&this.once("connect",c);let d=eJ(()=>{this.connecting=!1,this.pending=!1,this.emit("connect"),this.emit("ready")},"handleWebSocketOpen"),e=eJ((a,b=!1)=>{a.binaryType="arraybuffer",a.addEventListener("error",a=>{this.emit("error",a),this.emit("close")}),a.addEventListener("message",a=>{if(0===this.tlsState){let b=eB.from(a.data);this.emit("data",b)}}),a.addEventListener("close",()=>{this.emit("close")}),b?d():a.addEventListener("open",d)},"configureWebSocket"),f;try{f=this.wsProxyAddrForHost(b,"string"==typeof a?parseInt(a,10):a)}catch(a){this.emit("error",a),this.emit("close");return}try{let a=(this.useSecureWebSocket?"wss:":"ws:")+"//"+f;if(void 0!==this.webSocketConstructor)this.ws=new this.webSocketConstructor(a),e(this.ws);else try{this.ws=new WebSocket(a),e(this.ws)}catch{this.ws=new __unstable_WebSocket(a),e(this.ws)}}catch(a){fetch((this.useSecureWebSocket?"https:":"http:")+"//"+f,{headers:{Upgrade:"websocket"}}).then(b=>{if(this.ws=b.webSocket,null==this.ws)throw a;this.ws.accept(),e(this.ws,!0)}).catch(a=>{this.emit("error",Error(`All attempts to open a WebSocket to\
 connect to the database failed. Please refer to https://github.com/neondatabase\
/serverless/blob/main/CONFIG.md#websocketconstructor-typeof-websocket--undefined\
. Details: ${a.message}`)),this.emit("close")})}}async startTls(a){if(void 0===this.subtls)throw Error("For Postgres SSL connections, you must set `neonConfig.subtls` to the subtls library. See https://github.com/neondatabase/serverless/blob/main/CONFIG.md for more information.");this.tlsState=1;let b=this.subtls.TrustedCert.fromPEM(this.rootCerts),c=new this.subtls.WebSocketReadQueue(this.ws),d=c.read.bind(c),e=this.rawWrite.bind(this),[f,g]=await this.subtls.startTls(a,b,d,e,{useSNI:!this.disableSNI,expectPreData:this.pipelineTLS?new Uint8Array([83]):void 0});this.tlsRead=f,this.tlsWrite=g,this.tlsState=2,this.encrypted=!0,this.authorized=!0,this.emit("secureConnection",this),this.tlsReadLoop()}async tlsReadLoop(){for(;;){let a=await this.tlsRead();if(void 0===a)break;{let b=eB.from(a);this.emit("data",b)}}}rawWrite(a){if(!this.coalesceWrites)return void this.ws.send(a);if(void 0===this.writeBuffer)this.writeBuffer=a,setTimeout(()=>{this.ws.send(this.writeBuffer),this.writeBuffer=void 0},0);else{let b=new Uint8Array(this.writeBuffer.length+a.length);b.set(this.writeBuffer),b.set(a,this.writeBuffer.length),this.writeBuffer=b}}write(a,b="utf8",c=a=>{}){return 0===a.length?c():("string"==typeof a&&(a=eB.from(a,b)),0===this.tlsState?(this.rawWrite(a),c()):1===this.tlsState?this.once("secureConnection",()=>{this.write(a,b,c)}):(this.tlsWrite(a),c())),!0}end(a=eB.alloc(0),b="utf8",c=()=>{}){return this.write(a,b,()=>{this.ws.close(),c()}),this}destroy(){return this.destroyed=!0,this.end()}},eJ(fQ,"Socket"),eQ(fQ,"defaults",{poolQueryViaFetch:!1,fetchEndpoint:eJ((a,b,c)=>"https://"+(c?.jwtAuth?a.replace(fP,"apiauth."):a.replace(fP,"api."))+"/sql","fetchEndpoint"),fetchConnectionCache:!0,fetchFunction:void 0,webSocketConstructor:void 0,wsProxy:eJ(a=>a+"/v2","wsProxy"),useSecureWebSocket:!0,forceDisablePgSSL:!0,coalesceWrites:!0,pipelineConnect:"password",subtls:void 0,rootCerts:"",pipelineTLS:!1,disableSNI:!1}),eQ(fQ,"opts",{}),fR=fQ}),fT=eL(a=>{eU(),Object.defineProperty(a,"__esModule",{value:!0}),a.NoticeMessage=a.DataRowMessage=a.CommandCompleteMessage=a.ReadyForQueryMessage=a.NotificationResponseMessage=a.BackendKeyDataMessage=a.AuthenticationMD5Password=a.ParameterStatusMessage=a.ParameterDescriptionMessage=a.RowDescriptionMessage=a.Field=a.CopyResponse=a.CopyDataMessage=a.DatabaseError=a.copyDone=a.emptyQuery=a.replicationStart=a.portalSuspended=a.noData=a.closeComplete=a.bindComplete=a.parseComplete=void 0,a.parseComplete={name:"parseComplete",length:5},a.bindComplete={name:"bindComplete",length:5},a.closeComplete={name:"closeComplete",length:5},a.noData={name:"noData",length:5},a.portalSuspended={name:"portalSuspended",length:5},a.replicationStart={name:"replicationStart",length:4},a.emptyQuery={name:"emptyQuery",length:4},a.copyDone={name:"copyDone",length:4};var b=class extends Error{constructor(a,b,c){super(a),this.length=b,this.name=c}};eJ(b,"DatabaseError"),a.DatabaseError=b;var c=class{constructor(a,b){this.length=a,this.chunk=b,this.name="copyData"}};eJ(c,"CopyDataMessage"),a.CopyDataMessage=c;var d=class{constructor(a,b,c,d){this.length=a,this.name=b,this.binary=c,this.columnTypes=Array(d)}};eJ(d,"CopyResponse"),a.CopyResponse=d;var e=class{constructor(a,b,c,d,e,f,g){this.name=a,this.tableID=b,this.columnID=c,this.dataTypeID=d,this.dataTypeSize=e,this.dataTypeModifier=f,this.format=g}};eJ(e,"Field"),a.Field=e;var f=class{constructor(a,b){this.length=a,this.fieldCount=b,this.name="rowDescription",this.fields=Array(this.fieldCount)}};eJ(f,"RowDescriptionMessage"),a.RowDescriptionMessage=f;var g=class{constructor(a,b){this.length=a,this.parameterCount=b,this.name="parameterDescription",this.dataTypeIDs=Array(this.parameterCount)}};eJ(g,"ParameterDescriptionMessage"),a.ParameterDescriptionMessage=g;var h=class{constructor(a,b,c){this.length=a,this.parameterName=b,this.parameterValue=c,this.name="parameterStatus"}};eJ(h,"ParameterStatusMessage"),a.ParameterStatusMessage=h;var i=class{constructor(a,b){this.length=a,this.salt=b,this.name="authenticationMD5Password"}};eJ(i,"AuthenticationMD5Password"),a.AuthenticationMD5Password=i;var j=class{constructor(a,b,c){this.length=a,this.processID=b,this.secretKey=c,this.name="backendKeyData"}};eJ(j,"BackendKeyDataMessage"),a.BackendKeyDataMessage=j;var k=class{constructor(a,b,c,d){this.length=a,this.processId=b,this.channel=c,this.payload=d,this.name="notification"}};eJ(k,"NotificationResponseMessage"),a.NotificationResponseMessage=k;var l=class{constructor(a,b){this.length=a,this.status=b,this.name="readyForQuery"}};eJ(l,"ReadyForQueryMessage"),a.ReadyForQueryMessage=l;var m=class{constructor(a,b){this.length=a,this.text=b,this.name="commandComplete"}};eJ(m,"CommandCompleteMessage"),a.CommandCompleteMessage=m;var n=class{constructor(a,b){this.length=a,this.fields=b,this.name="dataRow",this.fieldCount=b.length}};eJ(n,"DataRowMessage"),a.DataRowMessage=n;var o=class{constructor(a,b){this.length=a,this.message=b,this.name="notice"}};eJ(o,"NoticeMessage"),a.NoticeMessage=o}),fU=eL(a=>{eU(),Object.defineProperty(a,"__esModule",{value:!0}),a.Writer=void 0;var b=class{constructor(a=256){this.size=a,this.offset=5,this.headerPosition=0,this.buffer=eB.allocUnsafe(a)}ensure(a){if(this.buffer.length-this.offset<a){var b=this.buffer,c=b.length+(b.length>>1)+a;this.buffer=eB.allocUnsafe(c),b.copy(this.buffer)}}addInt32(a){return this.ensure(4),this.buffer[this.offset++]=a>>>24&255,this.buffer[this.offset++]=a>>>16&255,this.buffer[this.offset++]=a>>>8&255,this.buffer[this.offset++]=a>>>0&255,this}addInt16(a){return this.ensure(2),this.buffer[this.offset++]=a>>>8&255,this.buffer[this.offset++]=a>>>0&255,this}addCString(a){if(a){var b=eB.byteLength(a);this.ensure(b+1),this.buffer.write(a,this.offset,"utf-8"),this.offset+=b}else this.ensure(1);return this.buffer[this.offset++]=0,this}addString(a=""){var b=eB.byteLength(a);return this.ensure(b),this.buffer.write(a,this.offset),this.offset+=b,this}add(a){return this.ensure(a.length),a.copy(this.buffer,this.offset),this.offset+=a.length,this}join(a){if(a){this.buffer[this.headerPosition]=a;let b=this.offset-(this.headerPosition+1);this.buffer.writeInt32BE(b,this.headerPosition+1)}return this.buffer.slice(5*!a,this.offset)}flush(a){var b=this.join(a);return this.offset=5,this.headerPosition=0,this.buffer=eB.allocUnsafe(this.size),b}};eJ(b,"Writer"),a.Writer=b}),fV=eL(a=>{eU(),Object.defineProperty(a,"__esModule",{value:!0}),a.serialize=void 0;var b=fU(),c=new b.Writer,d=eJ(a=>{for(let b of(c.addInt16(3).addInt16(0),Object.keys(a)))c.addCString(b).addCString(a[b]);c.addCString("client_encoding").addCString("UTF8");var d=c.addCString("").flush(),e=d.length+4;return new b.Writer().addInt32(e).add(d).flush()},"startup"),e=eJ(()=>{let a=eB.allocUnsafe(8);return a.writeInt32BE(8,0),a.writeInt32BE(0x4d2162f,4),a},"requestSsl"),f=eJ(a=>c.addCString(a).flush(112),"password"),g=eJ(function(a,b){return c.addCString(a).addInt32(eB.byteLength(b)).addString(b),c.flush(112)},"sendSASLInitialResponseMessage"),h=eJ(function(a){return c.addString(a).flush(112)},"sendSCRAMClientFinalMessage"),i=eJ(a=>c.addCString(a).flush(81),"query"),j=[],k=eJ(a=>{let b=a.name||"";b.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",b,b.length),console.error("This can cause conflicts and silent errors executing queries"));let d=a.types||j;for(var e=d.length,f=c.addCString(b).addCString(a.text).addInt16(e),g=0;g<e;g++)f.addInt32(d[g]);return c.flush(80)},"parse"),l=new b.Writer,m=eJ(function(a,b){for(let d=0;d<a.length;d++){let e=b?b(a[d],d):a[d];null==e?(c.addInt16(0),l.addInt32(-1)):e instanceof eB?(c.addInt16(1),l.addInt32(e.length),l.add(e)):(c.addInt16(0),l.addInt32(eB.byteLength(e)),l.addString(e))}},"writeValues"),n=eJ((a={})=>{let b=a.portal||"",d=a.statement||"",e=a.binary||!1,f=a.values||j,g=f.length;return c.addCString(b).addCString(d),c.addInt16(g),m(f,a.valueMapper),c.addInt16(g),c.add(l.flush()),c.addInt16(+!!e),c.flush(66)},"bind"),o=eB.from([69,0,0,0,9,0,0,0,0,0]),p=eJ(a=>{if(!a||!a.portal&&!a.rows)return o;let b=a.portal||"",c=a.rows||0,d=eB.byteLength(b),e=4+d+1+4,f=eB.allocUnsafe(1+e);return f[0]=69,f.writeInt32BE(e,1),f.write(b,5,"utf-8"),f[d+5]=0,f.writeUInt32BE(c,f.length-4),f},"execute"),q=eJ((a,b)=>{let c=eB.allocUnsafe(16);return c.writeInt32BE(16,0),c.writeInt16BE(1234,4),c.writeInt16BE(5678,6),c.writeInt32BE(a,8),c.writeInt32BE(b,12),c},"cancel"),r=eJ((a,b)=>{let c=4+eB.byteLength(b)+1,d=eB.allocUnsafe(1+c);return d[0]=a,d.writeInt32BE(c,1),d.write(b,5,"utf-8"),d[c]=0,d},"cstringMessage"),s=c.addCString("P").flush(68),t=c.addCString("S").flush(68),u=eJ(a=>a.name?r(68,`${a.type}${a.name||""}`):"P"===a.type?s:t,"describe"),v=eJ(a=>r(67,`${a.type}${a.name||""}`),"close"),w=eJ(a=>c.add(a).flush(100),"copyData"),x=eJ(a=>r(102,a),"copyFail"),y=eJ(a=>eB.from([a,0,0,0,4]),"codeOnlyBuffer"),z=y(72),A=y(83),B=y(88),C=y(99);a.serialize={startup:d,password:f,requestSsl:e,sendSASLInitialResponseMessage:g,sendSCRAMClientFinalMessage:h,query:i,parse:k,bind:n,execute:p,describe:u,close:v,flush:eJ(()=>z,"flush"),sync:eJ(()=>A,"sync"),end:eJ(()=>B,"end"),copyData:w,copyDone:eJ(()=>C,"copyDone"),copyFail:x,cancel:q}}),fW=eL(a=>{eU(),Object.defineProperty(a,"__esModule",{value:!0}),a.BufferReader=void 0;var b=eB.allocUnsafe(0),c=class{constructor(a=0){this.offset=a,this.buffer=b,this.encoding="utf-8"}setBuffer(a,b){this.offset=a,this.buffer=b}int16(){let a=this.buffer.readInt16BE(this.offset);return this.offset+=2,a}byte(){let a=this.buffer[this.offset];return this.offset++,a}int32(){let a=this.buffer.readInt32BE(this.offset);return this.offset+=4,a}string(a){let b=this.buffer.toString(this.encoding,this.offset,this.offset+a);return this.offset+=a,b}cstring(){let a=this.offset,b=a;for(;0!==this.buffer[b++];);return this.offset=b,this.buffer.toString(this.encoding,a,b-1)}bytes(a){let b=this.buffer.slice(this.offset,this.offset+a);return this.offset+=a,b}};eJ(c,"BufferReader"),a.BufferReader=c}),fX=eL(a=>{eU(),Object.defineProperty(a,"__esModule",{value:!0}),a.Parser=void 0;var b=fT(),c=fW(),d=eB.allocUnsafe(0),e=class{constructor(a){if(this.buffer=d,this.bufferLength=0,this.bufferOffset=0,this.reader=new c.BufferReader,a?.mode==="binary")throw Error("Binary mode not supported yet");this.mode=a?.mode||"text"}parse(a,b){this.mergeBuffer(a);let c=this.bufferOffset+this.bufferLength,e=this.bufferOffset;for(;e+5<=c;){let a=this.buffer[e],d=this.buffer.readUInt32BE(e+1),f=1+d;if(f+e<=c)b(this.handlePacket(e+5,a,d,this.buffer)),e+=f;else break}e===c?(this.buffer=d,this.bufferLength=0,this.bufferOffset=0):(this.bufferLength=c-e,this.bufferOffset=e)}mergeBuffer(a){if(this.bufferLength>0){let b=this.bufferLength+a.byteLength;if(b+this.bufferOffset>this.buffer.byteLength){let a;if(b<=this.buffer.byteLength&&this.bufferOffset>=this.bufferLength)a=this.buffer;else{let c=2*this.buffer.byteLength;for(;b>=c;)c*=2;a=eB.allocUnsafe(c)}this.buffer.copy(a,0,this.bufferOffset,this.bufferOffset+this.bufferLength),this.buffer=a,this.bufferOffset=0}a.copy(this.buffer,this.bufferOffset+this.bufferLength),this.bufferLength=b}else this.buffer=a,this.bufferOffset=0,this.bufferLength=a.byteLength}handlePacket(a,c,d,e){switch(c){case 50:return b.bindComplete;case 49:return b.parseComplete;case 51:return b.closeComplete;case 110:return b.noData;case 115:return b.portalSuspended;case 99:return b.copyDone;case 87:return b.replicationStart;case 73:return b.emptyQuery;case 68:return this.parseDataRowMessage(a,d,e);case 67:return this.parseCommandCompleteMessage(a,d,e);case 90:return this.parseReadyForQueryMessage(a,d,e);case 65:return this.parseNotificationMessage(a,d,e);case 82:return this.parseAuthenticationResponse(a,d,e);case 83:return this.parseParameterStatusMessage(a,d,e);case 75:return this.parseBackendKeyData(a,d,e);case 69:return this.parseErrorMessage(a,d,e,"error");case 78:return this.parseErrorMessage(a,d,e,"notice");case 84:return this.parseRowDescriptionMessage(a,d,e);case 116:return this.parseParameterDescriptionMessage(a,d,e);case 71:return this.parseCopyInMessage(a,d,e);case 72:return this.parseCopyOutMessage(a,d,e);case 100:return this.parseCopyData(a,d,e);default:return new b.DatabaseError("received invalid response: "+c.toString(16),d,"error")}}parseReadyForQueryMessage(a,c,d){this.reader.setBuffer(a,d);let e=this.reader.string(1);return new b.ReadyForQueryMessage(c,e)}parseCommandCompleteMessage(a,c,d){this.reader.setBuffer(a,d);let e=this.reader.cstring();return new b.CommandCompleteMessage(c,e)}parseCopyData(a,c,d){let e=d.slice(a,a+(c-4));return new b.CopyDataMessage(c,e)}parseCopyInMessage(a,b,c){return this.parseCopyMessage(a,b,c,"copyInResponse")}parseCopyOutMessage(a,b,c){return this.parseCopyMessage(a,b,c,"copyOutResponse")}parseCopyMessage(a,c,d,e){this.reader.setBuffer(a,d);let f=0!==this.reader.byte(),g=this.reader.int16(),h=new b.CopyResponse(c,e,f,g);for(let a=0;a<g;a++)h.columnTypes[a]=this.reader.int16();return h}parseNotificationMessage(a,c,d){this.reader.setBuffer(a,d);let e=this.reader.int32(),f=this.reader.cstring(),g=this.reader.cstring();return new b.NotificationResponseMessage(c,e,f,g)}parseRowDescriptionMessage(a,c,d){this.reader.setBuffer(a,d);let e=this.reader.int16(),f=new b.RowDescriptionMessage(c,e);for(let a=0;a<e;a++)f.fields[a]=this.parseField();return f}parseField(){let a=this.reader.cstring(),c=this.reader.int32(),d=this.reader.int16(),e=this.reader.int32(),f=this.reader.int16(),g=this.reader.int32(),h=0===this.reader.int16()?"text":"binary";return new b.Field(a,c,d,e,f,g,h)}parseParameterDescriptionMessage(a,c,d){this.reader.setBuffer(a,d);let e=this.reader.int16(),f=new b.ParameterDescriptionMessage(c,e);for(let a=0;a<e;a++)f.dataTypeIDs[a]=this.reader.int32();return f}parseDataRowMessage(a,c,d){this.reader.setBuffer(a,d);let e=this.reader.int16(),f=Array(e);for(let a=0;a<e;a++){let b=this.reader.int32();f[a]=-1===b?null:this.reader.string(b)}return new b.DataRowMessage(c,f)}parseParameterStatusMessage(a,c,d){this.reader.setBuffer(a,d);let e=this.reader.cstring(),f=this.reader.cstring();return new b.ParameterStatusMessage(c,e,f)}parseBackendKeyData(a,c,d){this.reader.setBuffer(a,d);let e=this.reader.int32(),f=this.reader.int32();return new b.BackendKeyDataMessage(c,e,f)}parseAuthenticationResponse(a,c,d){this.reader.setBuffer(a,d);let e=this.reader.int32(),f={name:"authenticationOk",length:c};switch(e){case 0:break;case 3:8===f.length&&(f.name="authenticationCleartextPassword");break;case 5:if(12===f.length){f.name="authenticationMD5Password";let a=this.reader.bytes(4);return new b.AuthenticationMD5Password(c,a)}break;case 10:let g;f.name="authenticationSASL",f.mechanisms=[];do(g=this.reader.cstring())&&f.mechanisms.push(g);while(g);break;case 11:f.name="authenticationSASLContinue",f.data=this.reader.string(c-8);break;case 12:f.name="authenticationSASLFinal",f.data=this.reader.string(c-8);break;default:throw Error("Unknown authenticationOk message type "+e)}return f}parseErrorMessage(a,c,d,e){this.reader.setBuffer(a,d);let f={},g=this.reader.string(1);for(;"\0"!==g;)f[g]=this.reader.cstring(),g=this.reader.string(1);let h=f.M,i="notice"===e?new b.NoticeMessage(c,h):new b.DatabaseError(h,c,e);return i.severity=f.S,i.code=f.C,i.detail=f.D,i.hint=f.H,i.position=f.P,i.internalPosition=f.p,i.internalQuery=f.q,i.where=f.W,i.schema=f.s,i.table=f.t,i.column=f.c,i.dataType=f.d,i.constraint=f.n,i.file=f.F,i.line=f.L,i.routine=f.R,i}};eJ(e,"Parser"),a.Parser=e}),fY=eL(a=>{eU(),Object.defineProperty(a,"__esModule",{value:!0}),a.DatabaseError=a.serialize=a.parse=void 0;var b=fT();Object.defineProperty(a,"DatabaseError",{enumerable:!0,get:eJ(function(){return b.DatabaseError},"get")});var c=fV();Object.defineProperty(a,"serialize",{enumerable:!0,get:eJ(function(){return c.serialize},"get")});var d=fX();function e(a,b){let c=new d.Parser;return a.on("data",a=>c.parse(a,b)),new Promise(b=>a.on("end",()=>b()))}eJ(e,"parse"),a.parse=e}),fZ={};function f$({socket:a,servername:b}){return a.startTls(b),a}eM(fZ,{connect:()=>f$});var f_=eK(()=>{eU(),eJ(f$,"connect")}),f0=eL((a,b)=>{eU();var c=(fS(),eP(fM)),d=eV().EventEmitter,{parse:e,serialize:f}=fY(),g=f.flush(),h=f.sync(),i=f.end(),j=class extends d{constructor(a){super(),a=a||{},this.stream=a.stream||new c.Socket,this._keepAlive=a.keepAlive,this._keepAliveInitialDelayMillis=a.keepAliveInitialDelayMillis,this.lastBuffer=!1,this.parsedStatements={},this.ssl=a.ssl||!1,this._ending=!1,this._emitMessage=!1;var b=this;this.on("newListener",function(a){"message"===a&&(b._emitMessage=!0)})}connect(a,b){var d=this;this._connecting=!0,this.stream.setNoDelay(!0),this.stream.connect(a,b),this.stream.once("connect",function(){d._keepAlive&&d.stream.setKeepAlive(!0,d._keepAliveInitialDelayMillis),d.emit("connect")});let e=eJ(function(a){d._ending&&("ECONNRESET"===a.code||"EPIPE"===a.code)||d.emit("error",a)},"reportStreamError");if(this.stream.on("error",e),this.stream.on("close",function(){d.emit("end")}),!this.ssl)return this.attachListeners(this.stream);this.stream.once("data",function(a){switch(a.toString("utf8")){case"S":break;case"N":return d.stream.end(),d.emit("error",Error("The server does not support SSL connections"));default:return d.stream.end(),d.emit("error",Error("There was an error establishing an SSL connection"))}var f=(f_(),eP(fZ));let g={socket:d.stream};!0!==d.ssl&&(Object.assign(g,d.ssl),"key"in d.ssl&&(g.key=d.ssl.key)),0===c.isIP(b)&&(g.servername=b);try{d.stream=f.connect(g)}catch(a){return d.emit("error",a)}d.attachListeners(d.stream),d.stream.on("error",e),d.emit("sslconnect")})}attachListeners(a){a.on("end",()=>{this.emit("end")}),e(a,a=>{var b="error"===a.name?"errorMessage":a.name;this._emitMessage&&this.emit("message",a),this.emit(b,a)})}requestSsl(){this.stream.write(f.requestSsl())}startup(a){this.stream.write(f.startup(a))}cancel(a,b){this._send(f.cancel(a,b))}password(a){this._send(f.password(a))}sendSASLInitialResponseMessage(a,b){this._send(f.sendSASLInitialResponseMessage(a,b))}sendSCRAMClientFinalMessage(a){this._send(f.sendSCRAMClientFinalMessage(a))}_send(a){return!!this.stream.writable&&this.stream.write(a)}query(a){this._send(f.query(a))}parse(a){this._send(f.parse(a))}bind(a){this._send(f.bind(a))}execute(a){this._send(f.execute(a))}flush(){this.stream.writable&&this.stream.write(g)}sync(){this._ending=!0,this._send(g),this._send(h)}ref(){this.stream.ref()}unref(){this.stream.unref()}end(){return(this._ending=!0,this._connecting&&this.stream.writable)?this.stream.write(i,()=>{this.stream.end()}):void this.stream.end()}close(a){this._send(f.close(a))}describe(a){this._send(f.describe(a))}sendCopyFromChunk(a){this._send(f.copyData(a))}endCopyFrom(){this._send(f.copyDone())}sendCopyFail(a){this._send(f.copyFail(a))}};eJ(j,"Connection"),b.exports=j}),f1=eL((a,b)=>{eU();var c=eV().EventEmitter,d=(eY(),eP(eW),fj()),e=fk(),f=fA(),g=fB(),h=fJ(),i=fL(),j=fi(),k=f0(),l=class extends c{constructor(a){super(),this.connectionParameters=new h(a),this.user=this.connectionParameters.user,this.database=this.connectionParameters.database,this.port=this.connectionParameters.port,this.host=this.connectionParameters.host,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:this.connectionParameters.password}),this.replication=this.connectionParameters.replication;var b=a||{};this._Promise=b.Promise||ey.Promise,this._types=new g(b.types),this._ending=!1,this._connecting=!1,this._connected=!1,this._connectionError=!1,this._queryable=!0,this.connection=b.connection||new k({stream:b.stream,ssl:this.connectionParameters.ssl,keepAlive:b.keepAlive||!1,keepAliveInitialDelayMillis:b.keepAliveInitialDelayMillis||0,encoding:this.connectionParameters.client_encoding||"utf8"}),this.queryQueue=[],this.binary=b.binary||j.binary,this.processID=null,this.secretKey=null,this.ssl=this.connectionParameters.ssl||!1,this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this._connectionTimeoutMillis=b.connectionTimeoutMillis||0}_errorAllQueries(a){let b=eJ(b=>{eC.nextTick(()=>{b.handleError(a,this.connection)})},"enqueueError");this.activeQuery&&(b(this.activeQuery),this.activeQuery=null),this.queryQueue.forEach(b),this.queryQueue.length=0}_connect(a){var b=this,c=this.connection;if(this._connectionCallback=a,this._connecting||this._connected){let b=Error("Client has already been connected. You cannot reuse a client.");eC.nextTick(()=>{a(b)});return}this._connecting=!0,this.connectionTimeoutHandle,this._connectionTimeoutMillis>0&&(this.connectionTimeoutHandle=setTimeout(()=>{c._ending=!0,c.stream.destroy(Error("timeout expired"))},this._connectionTimeoutMillis)),this.host&&0===this.host.indexOf("/")?c.connect(this.host+"/.s.PGSQL."+this.port):c.connect(this.port,this.host),c.on("connect",function(){b.ssl?c.requestSsl():c.startup(b.getStartupConf())}),c.on("sslconnect",function(){c.startup(b.getStartupConf())}),this._attachListeners(c),c.once("end",()=>{let a=this._ending?Error("Connection terminated"):Error("Connection terminated unexpectedly");clearTimeout(this.connectionTimeoutHandle),this._errorAllQueries(a),this._ending||(this._connecting&&!this._connectionError?this._connectionCallback?this._connectionCallback(a):this._handleErrorEvent(a):this._connectionError||this._handleErrorEvent(a)),eC.nextTick(()=>{this.emit("end")})})}connect(a){return a?void this._connect(a):new this._Promise((a,b)=>{this._connect(c=>{c?b(c):a()})})}_attachListeners(a){a.on("authenticationCleartextPassword",this._handleAuthCleartextPassword.bind(this)),a.on("authenticationMD5Password",this._handleAuthMD5Password.bind(this)),a.on("authenticationSASL",this._handleAuthSASL.bind(this)),a.on("authenticationSASLContinue",this._handleAuthSASLContinue.bind(this)),a.on("authenticationSASLFinal",this._handleAuthSASLFinal.bind(this)),a.on("backendKeyData",this._handleBackendKeyData.bind(this)),a.on("error",this._handleErrorEvent.bind(this)),a.on("errorMessage",this._handleErrorMessage.bind(this)),a.on("readyForQuery",this._handleReadyForQuery.bind(this)),a.on("notice",this._handleNotice.bind(this)),a.on("rowDescription",this._handleRowDescription.bind(this)),a.on("dataRow",this._handleDataRow.bind(this)),a.on("portalSuspended",this._handlePortalSuspended.bind(this)),a.on("emptyQuery",this._handleEmptyQuery.bind(this)),a.on("commandComplete",this._handleCommandComplete.bind(this)),a.on("parseComplete",this._handleParseComplete.bind(this)),a.on("copyInResponse",this._handleCopyInResponse.bind(this)),a.on("copyData",this._handleCopyData.bind(this)),a.on("notification",this._handleNotification.bind(this))}_checkPgPass(a){let b=this.connection;"function"==typeof this.password?this._Promise.resolve().then(()=>this.password()).then(c=>{if(void 0!==c){if("string"!=typeof c)return void b.emit("error",TypeError("Password must be a string"));this.connectionParameters.password=this.password=c}else this.connectionParameters.password=this.password=null;a()}).catch(a=>{b.emit("error",a)}):null!==this.password?a():f(this.connectionParameters,b=>{void 0!==b&&(this.connectionParameters.password=this.password=b),a()})}_handleAuthCleartextPassword(a){this._checkPgPass(()=>{this.connection.password(this.password)})}_handleAuthMD5Password(a){this._checkPgPass(()=>{let b=d.postgresMd5PasswordHash(this.user,this.password,a.salt);this.connection.password(b)})}_handleAuthSASL(a){this._checkPgPass(()=>{this.saslSession=e.startSession(a.mechanisms),this.connection.sendSASLInitialResponseMessage(this.saslSession.mechanism,this.saslSession.response)})}_handleAuthSASLContinue(a){e.continueSession(this.saslSession,this.password,a.data),this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}_handleAuthSASLFinal(a){e.finalizeSession(this.saslSession,a.data),this.saslSession=null}_handleBackendKeyData(a){this.processID=a.processID,this.secretKey=a.secretKey}_handleReadyForQuery(a){this._connecting&&(this._connecting=!1,this._connected=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback&&(this._connectionCallback(null,this),this._connectionCallback=null),this.emit("connect"));let{activeQuery:b}=this;this.activeQuery=null,this.readyForQuery=!0,b&&b.handleReadyForQuery(this.connection),this._pulseQueryQueue()}_handleErrorWhileConnecting(a){if(!this._connectionError){if(this._connectionError=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback)return this._connectionCallback(a);this.emit("error",a)}}_handleErrorEvent(a){if(this._connecting)return this._handleErrorWhileConnecting(a);this._queryable=!1,this._errorAllQueries(a),this.emit("error",a)}_handleErrorMessage(a){if(this._connecting)return this._handleErrorWhileConnecting(a);let b=this.activeQuery;if(!b)return void this._handleErrorEvent(a);this.activeQuery=null,b.handleError(a,this.connection)}_handleRowDescription(a){this.activeQuery.handleRowDescription(a)}_handleDataRow(a){this.activeQuery.handleDataRow(a)}_handlePortalSuspended(a){this.activeQuery.handlePortalSuspended(this.connection)}_handleEmptyQuery(a){this.activeQuery.handleEmptyQuery(this.connection)}_handleCommandComplete(a){this.activeQuery.handleCommandComplete(a,this.connection)}_handleParseComplete(a){this.activeQuery.name&&(this.connection.parsedStatements[this.activeQuery.name]=this.activeQuery.text)}_handleCopyInResponse(a){this.activeQuery.handleCopyInResponse(this.connection)}_handleCopyData(a){this.activeQuery.handleCopyData(a,this.connection)}_handleNotification(a){this.emit("notification",a)}_handleNotice(a){this.emit("notice",a)}getStartupConf(){var a=this.connectionParameters,b={user:a.user,database:a.database},c=a.application_name||a.fallback_application_name;return c&&(b.application_name=c),a.replication&&(b.replication=""+a.replication),a.statement_timeout&&(b.statement_timeout=String(parseInt(a.statement_timeout,10))),a.lock_timeout&&(b.lock_timeout=String(parseInt(a.lock_timeout,10))),a.idle_in_transaction_session_timeout&&(b.idle_in_transaction_session_timeout=String(parseInt(a.idle_in_transaction_session_timeout,10))),a.options&&(b.options=a.options),b}cancel(a,b){if(a.activeQuery===b){var c=this.connection;this.host&&0===this.host.indexOf("/")?c.connect(this.host+"/.s.PGSQL."+this.port):c.connect(this.port,this.host),c.on("connect",function(){c.cancel(a.processID,a.secretKey)})}else -1!==a.queryQueue.indexOf(b)&&a.queryQueue.splice(a.queryQueue.indexOf(b),1)}setTypeParser(a,b,c){return this._types.setTypeParser(a,b,c)}getTypeParser(a,b){return this._types.getTypeParser(a,b)}escapeIdentifier(a){return'"'+a.replace(/"/g,'""')+'"'}escapeLiteral(a){for(var b=!1,c="'",d=0;d<a.length;d++){var e=a[d];"'"===e?c+=e+e:"\\"===e?(c+=e+e,b=!0):c+=e}return c+="'",!0===b&&(c=" E"+c),c}_pulseQueryQueue(){if(!0===this.readyForQuery)if(this.activeQuery=this.queryQueue.shift(),this.activeQuery){this.readyForQuery=!1,this.hasExecuted=!0;let a=this.activeQuery.submit(this.connection);a&&eC.nextTick(()=>{this.activeQuery.handleError(a,this.connection),this.readyForQuery=!0,this._pulseQueryQueue()})}else this.hasExecuted&&(this.activeQuery=null,this.emit("drain"))}query(a,b,c){var d,e,f,g,h;if(null==a)throw TypeError("Client was passed a null or undefined query");return"function"==typeof a.submit?(f=a.query_timeout||this.connectionParameters.query_timeout,e=d=a,"function"==typeof b&&(d.callback=d.callback||b)):(f=this.connectionParameters.query_timeout,(d=new i(a,b,c)).callback||(e=new this._Promise((a,b)=>{d.callback=(c,d)=>c?b(c):a(d)}))),f&&(h=d.callback,g=setTimeout(()=>{var a=Error("Query read timeout");eC.nextTick(()=>{d.handleError(a,this.connection)}),h(a),d.callback=()=>{};var b=this.queryQueue.indexOf(d);b>-1&&this.queryQueue.splice(b,1),this._pulseQueryQueue()},f),d.callback=(a,b)=>{clearTimeout(g),h(a,b)}),this.binary&&!d.binary&&(d.binary=!0),d._result&&!d._result._types&&(d._result._types=this._types),this._queryable?this._ending?eC.nextTick(()=>{d.handleError(Error("Client was closed and is not queryable"),this.connection)}):(this.queryQueue.push(d),this._pulseQueryQueue()):eC.nextTick(()=>{d.handleError(Error("Client has encountered a connection error and is not queryable"),this.connection)}),e}ref(){this.connection.ref()}unref(){this.connection.unref()}end(a){if(this._ending=!0,!this.connection._connecting)if(!a)return this._Promise.resolve();else a();if(this.activeQuery||!this._queryable?this.connection.stream.destroy():this.connection.end(),!a)return new this._Promise(a=>{this.connection.once("end",a)});this.connection.once("end",a)}};eJ(l,"Client"),l.Query=i,b.exports=l}),f2=eL((a,b)=>{eU();var c=eV().EventEmitter,d=eJ(function(){},"NOOP"),e=eJ((a,b)=>{let c=a.findIndex(b);return -1===c?void 0:a.splice(c,1)[0]},"removeWhere"),f=class{constructor(a,b,c){this.client=a,this.idleListener=b,this.timeoutId=c}};eJ(f,"IdleItem");var g=class{constructor(a){this.callback=a}};function h(){throw Error("Release called on client which has already been released to the pool.")}function i(a,b){let c,d;return b?{callback:b,result:void 0}:{callback:eJ(function(a,b){a?c(a):d(b)},"cb"),result:new a(function(a,b){d=a,c=b}).catch(a=>{throw Error.captureStackTrace(a),a})}}function j(a,b){return eJ(function c(d){d.client=b,b.removeListener("error",c),b.on("error",()=>{a.log("additional client error after disconnection due to error",d)}),a._remove(b),a.emit("error",d,b)},"idleListener")}eJ(g,"PendingItem"),eJ(h,"throwOnDoubleRelease"),eJ(i,"promisify"),eJ(j,"makeIdleListener");var k=class extends c{constructor(a,b){super(),this.options=Object.assign({},a),null!=a&&"password"in a&&Object.defineProperty(this.options,"password",{configurable:!0,enumerable:!1,writable:!0,value:a.password}),null!=a&&a.ssl&&a.ssl.key&&Object.defineProperty(this.options.ssl,"key",{enumerable:!1}),this.options.max=this.options.max||this.options.poolSize||10,this.options.maxUses=this.options.maxUses||1/0,this.options.allowExitOnIdle=this.options.allowExitOnIdle||!1,this.options.maxLifetimeSeconds=this.options.maxLifetimeSeconds||0,this.log=this.options.log||function(){},this.Client=this.options.Client||b||ga().Client,this.Promise=this.options.Promise||ey.Promise,typeof this.options.idleTimeoutMillis>"u"&&(this.options.idleTimeoutMillis=1e4),this._clients=[],this._idle=[],this._expired=new WeakSet,this._pendingQueue=[],this._endCallback=void 0,this.ending=!1,this.ended=!1}_isFull(){return this._clients.length>=this.options.max}_pulseQueue(){if(this.log("pulse queue"),this.ended)return void this.log("pulse queue ended");if(this.ending){this.log("pulse queue on ending"),this._idle.length&&this._idle.slice().map(a=>{this._remove(a.client)}),this._clients.length||(this.ended=!0,this._endCallback());return}if(!this._pendingQueue.length)return void this.log("no queued requests");if(!this._idle.length&&this._isFull())return;let a=this._pendingQueue.shift();if(this._idle.length){let b=this._idle.pop();clearTimeout(b.timeoutId);let c=b.client;c.ref&&c.ref();let d=b.idleListener;return this._acquireClient(c,a,d,!1)}if(!this._isFull())return this.newClient(a);throw Error("unexpected condition")}_remove(a){let b=e(this._idle,b=>b.client===a);void 0!==b&&clearTimeout(b.timeoutId),this._clients=this._clients.filter(b=>b!==a),a.end(),this.emit("remove",a)}connect(a){if(this.ending){let b=Error("Cannot use a pool after calling end on the pool");return a?a(b):this.Promise.reject(b)}let b=i(this.Promise,a),c=b.result;if(this._isFull()||this._idle.length){if(this._idle.length&&eC.nextTick(()=>this._pulseQueue()),!this.options.connectionTimeoutMillis)return this._pendingQueue.push(new g(b.callback)),c;let a=eJ((a,c,d)=>{clearTimeout(f),b.callback(a,c,d)},"queueCallback"),d=new g(a),f=setTimeout(()=>{e(this._pendingQueue,b=>b.callback===a),d.timedOut=!0,b.callback(Error("timeout exceeded when trying to connect"))},this.options.connectionTimeoutMillis);return this._pendingQueue.push(d),c}return this.newClient(new g(b.callback)),c}newClient(a){let b=new this.Client(this.options);this._clients.push(b);let c=j(this,b);this.log("checking client timeout");let e,f=!1;this.options.connectionTimeoutMillis&&(e=setTimeout(()=>{this.log("ending client due to timeout"),f=!0,b.connection?b.connection.stream.destroy():b.end()},this.options.connectionTimeoutMillis)),this.log("connecting new client"),b.connect(h=>{if(e&&clearTimeout(e),b.on("error",c),h)this.log("client failed to connect",h),this._clients=this._clients.filter(a=>a!==b),f&&(h.message="Connection terminated due to connection timeout"),this._pulseQueue(),a.timedOut||a.callback(h,void 0,d);else{if(this.log("new client connected"),0!==this.options.maxLifetimeSeconds){let a=setTimeout(()=>{this.log("ending client due to expired lifetime"),this._expired.add(b),-1!==this._idle.findIndex(a=>a.client===b)&&this._acquireClient(b,new g((a,b,c)=>c()),c,!1)},1e3*this.options.maxLifetimeSeconds);a.unref(),b.once("end",()=>clearTimeout(a))}return this._acquireClient(b,a,c,!0)}})}_acquireClient(a,b,c,e){e&&this.emit("connect",a),this.emit("acquire",a),a.release=this._releaseOnce(a,c),a.removeListener("error",c),b.timedOut?e&&this.options.verify?this.options.verify(a,a.release):a.release():e&&this.options.verify?this.options.verify(a,c=>{if(c)return a.release(c),b.callback(c,void 0,d);b.callback(void 0,a,a.release)}):b.callback(void 0,a,a.release)}_releaseOnce(a,b){let c=!1;return d=>{c&&h(),c=!0,this._release(a,b,d)}}_release(a,b,c){let d;if(a.on("error",b),a._poolUseCount=(a._poolUseCount||0)+1,this.emit("release",c,a),c||this.ending||!a._queryable||a._ending||a._poolUseCount>=this.options.maxUses){a._poolUseCount>=this.options.maxUses&&this.log("remove expended client"),this._remove(a),this._pulseQueue();return}if(this._expired.has(a)){this.log("remove expired client"),this._expired.delete(a),this._remove(a),this._pulseQueue();return}this.options.idleTimeoutMillis&&(d=setTimeout(()=>{this.log("remove idle client"),this._remove(a)},this.options.idleTimeoutMillis),this.options.allowExitOnIdle&&d.unref()),this.options.allowExitOnIdle&&a.unref(),this._idle.push(new f(a,b,d)),this._pulseQueue()}query(a,b,c){if("function"==typeof a){let b=i(this.Promise,a);return ez(function(){return b.callback(Error("Passing a function as the first parameter to pool.query is not supported"))}),b.result}"function"==typeof b&&(c=b,b=void 0);let d=i(this.Promise,c);return c=d.callback,this.connect((d,e)=>{if(d)return c(d);let f=!1,g=eJ(a=>{f||(f=!0,e.release(a),c(a))},"onError");e.once("error",g),this.log("dispatching query");try{e.query(a,b,(a,b)=>{if(this.log("query dispatched"),e.removeListener("error",g),!f)return f=!0,e.release(a),a?c(a):c(void 0,b)})}catch(a){return e.release(a),c(a)}}),d.result}end(a){if(this.log("ending"),this.ending){let b=Error("Called end on pool more than once");return a?a(b):this.Promise.reject(b)}this.ending=!0;let b=i(this.Promise,a);return this._endCallback=b.callback,this._pulseQueue(),b.result}get waitingCount(){return this._pendingQueue.length}get idleCount(){return this._idle.length}get expiredCount(){return this._clients.reduce((a,b)=>a+ +!!this._expired.has(b),0)}get totalCount(){return this._clients.length}};eJ(k,"Pool"),b.exports=k}),f3={};eM(f3,{default:()=>f4});var f4,f5=eK(()=>{eU(),f4={}}),f6=eL((a,b)=>{b.exports={name:"pg",version:"8.8.0",description:"PostgreSQL client - pure javascript & libpq with the same API",keywords:["database","libpq","pg","postgre","postgres","postgresql","rdbms"],homepage:"https://github.com/brianc/node-postgres",repository:{type:"git",url:"git://github.com/brianc/node-postgres.git",directory:"packages/pg"},author:"Brian Carlson <brian.m.carlson@gmail.com>",main:"./lib",dependencies:{"buffer-writer":"2.0.0","packet-reader":"1.0.0","pg-connection-string":"^2.5.0","pg-pool":"^3.5.2","pg-protocol":"^1.5.0","pg-types":"^2.1.0",pgpass:"1.x"},devDependencies:{async:"2.6.4",bluebird:"3.5.2",co:"4.6.0","pg-copy-streams":"0.3.0"},peerDependencies:{"pg-native":">=3.0.1"},peerDependenciesMeta:{"pg-native":{optional:!0}},scripts:{test:"make test-all"},files:["lib","SPONSORS.md"],license:"MIT",engines:{node:">= 8.0.0"},gitHead:"c99fb2c127ddf8d712500db2c7b9a5491a178655"}}),f7=eL((a,b)=>{eU();var c=eV().EventEmitter,d=(eY(),eP(eW)),e=fj(),f=b.exports=function(a,b,d){c.call(this),a=e.normalizeQueryConfig(a,b,d),this.text=a.text,this.values=a.values,this.name=a.name,this.callback=a.callback,this.state="new",this._arrayMode="array"===a.rowMode,this._emitRowEvents=!1,this.on("newListener",(function(a){"row"===a&&(this._emitRowEvents=!0)}).bind(this))};d.inherits(f,c);var g={sqlState:"code",statementPosition:"position",messagePrimary:"message",context:"where",schemaName:"schema",tableName:"table",columnName:"column",dataTypeName:"dataType",constraintName:"constraint",sourceFile:"file",sourceLine:"line",sourceFunction:"routine"};f.prototype.handleError=function(a){var b=this.native.pq.resultErrorFields();if(b)for(var c in b)a[g[c]||c]=b[c];this.callback?this.callback(a):this.emit("error",a),this.state="error"},f.prototype.then=function(a,b){return this._getPromise().then(a,b)},f.prototype.catch=function(a){return this._getPromise().catch(a)},f.prototype._getPromise=function(){return this._promise||(this._promise=new Promise((function(a,b){this._once("end",a),this._once("error",b)}).bind(this))),this._promise},f.prototype.submit=function(a){this.state="running";var b=this;this.native=a.native,a.native.arrayMode=this._arrayMode;var c=eJ(function(c,d,e){if(a.native.arrayMode=!1,ez(function(){b.emit("_done")}),c)return b.handleError(c);b._emitRowEvents&&(e.length>1?d.forEach((a,c)=>{a.forEach(a=>{b.emit("row",a,e[c])})}):d.forEach(function(a){b.emit("row",a,e)})),b.state="end",b.emit("end",e),b.callback&&b.callback(null,e)},"after");if(eC.domain&&(c=eC.domain.bind(c)),this.name){this.name.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",this.name,this.name.length),console.error("This can cause conflicts and silent errors executing queries"));var d=(this.values||[]).map(e.prepareValue);if(a.namedQueries[this.name]){if(this.text&&a.namedQueries[this.name]!==this.text){let a=Error(`Pre\
pared statements must be unique - '${this.name}' was used for a different statem\
ent`);return c(a)}return a.native.execute(this.name,d,c)}return a.native.prepare(this.name,this.text,d.length,function(e){return e?c(e):(a.namedQueries[b.name]=b.text,b.native.execute(b.name,d,c))})}if(this.values){if(!Array.isArray(this.values)){let a=Error("Query values must be an array");return c(a)}var f=this.values.map(e.prepareValue);a.native.query(this.text,f,c)}else a.native.query(this.text,c)}}),f8=eL((a,b)=>{eU();var c=(f5(),eP(f3)),d=fB(),e=(f6(),eV().EventEmitter),f=(eY(),eP(eW)),g=fJ(),h=f7(),i=b.exports=function(a){e.call(this),a=a||{},this._Promise=a.Promise||ey.Promise,this._types=new d(a.types),this.native=new c({types:this._types}),this._queryQueue=[],this._ending=!1,this._connecting=!1,this._connected=!1,this._queryable=!0;var b=this.connectionParameters=new g(a);this.user=b.user,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:b.password}),this.database=b.database,this.host=b.host,this.port=b.port,this.namedQueries={}};i.Query=h,f.inherits(i,e),i.prototype._errorAllQueries=function(a){let b=eJ(b=>{eC.nextTick(()=>{b.native=this.native,b.handleError(a)})},"enqueueError");this._hasActiveQuery()&&(b(this._activeQuery),this._activeQuery=null),this._queryQueue.forEach(b),this._queryQueue.length=0},i.prototype._connect=function(a){var b=this;if(this._connecting)return void eC.nextTick(()=>a(Error("Client has already been connected. You cannot reuse a client.")));this._connecting=!0,this.connectionParameters.getLibpqConnectionString(function(c,d){if(c)return a(c);b.native.connect(d,function(c){if(c)return b.native.end(),a(c);b._connected=!0,b.native.on("error",function(a){b._queryable=!1,b._errorAllQueries(a),b.emit("error",a)}),b.native.on("notification",function(a){b.emit("notification",{channel:a.relname,payload:a.extra})}),b.emit("connect"),b._pulseQueryQueue(!0),a()})})},i.prototype.connect=function(a){return a?void this._connect(a):new this._Promise((a,b)=>{this._connect(c=>{c?b(c):a()})})},i.prototype.query=function(a,b,c){var d,e,f,g,i;if(null==a)throw TypeError("Client was passed a null or undefined query");if("function"==typeof a.submit)f=a.query_timeout||this.connectionParameters.query_timeout,e=d=a,"function"==typeof b&&(a.callback=b);else if(f=this.connectionParameters.query_timeout,!(d=new h(a,b,c)).callback){let a,b;e=new this._Promise((c,d)=>{a=c,b=d}),d.callback=(c,d)=>c?b(c):a(d)}return f&&(i=d.callback,g=setTimeout(()=>{var a=Error("Query read timeout");eC.nextTick(()=>{d.handleError(a,this.connection)}),i(a),d.callback=()=>{};var b=this._queryQueue.indexOf(d);b>-1&&this._queryQueue.splice(b,1),this._pulseQueryQueue()},f),d.callback=(a,b)=>{clearTimeout(g),i(a,b)}),this._queryable?this._ending?(d.native=this.native,eC.nextTick(()=>{d.handleError(Error("Client was closed and is not queryable"))})):(this._queryQueue.push(d),this._pulseQueryQueue()):(d.native=this.native,eC.nextTick(()=>{d.handleError(Error("Client has encountered a connection error and is not queryable"))})),e},i.prototype.end=function(a){var b,c=this;return this._ending=!0,this._connected||this.once("connect",this.end.bind(this,a)),a||(b=new this._Promise(function(b,c){a=eJ(a=>a?c(a):b(),"cb")})),this.native.end(function(){c._errorAllQueries(Error("Connection terminated")),eC.nextTick(()=>{c.emit("end"),a&&a()})}),b},i.prototype._hasActiveQuery=function(){return this._activeQuery&&"error"!==this._activeQuery.state&&"end"!==this._activeQuery.state},i.prototype._pulseQueryQueue=function(a){if(this._connected&&!this._hasActiveQuery()){var b=this._queryQueue.shift();if(!b){a||this.emit("drain");return}this._activeQuery=b,b.submit(this);var c=this;b.once("_done",function(){c._pulseQueryQueue()})}},i.prototype.cancel=function(a){this._activeQuery===a?this.native.cancel(function(){}):-1!==this._queryQueue.indexOf(a)&&this._queryQueue.splice(this._queryQueue.indexOf(a),1)},i.prototype.ref=function(){},i.prototype.unref=function(){},i.prototype.setTypeParser=function(a,b,c){return this._types.setTypeParser(a,b,c)},i.prototype.getTypeParser=function(a,b){return this._types.getTypeParser(a,b)}}),f9=eL((a,b)=>{eU(),b.exports=f8()}),ga=eL((a,b)=>{eU();var c=f1(),d=fi(),e=f0(),f=f2(),{DatabaseError:g}=fY(),h=eJ(a=>{var b;return eJ(b=class extends f{constructor(b){super(b,a)}},"BoundPool"),b},"poolFactory"),i=eJ(function(a){this.defaults=d,this.Client=a,this.Query=this.Client.Query,this.Pool=h(this.Client),this._pools=[],this.Connection=e,this.types=fh(),this.DatabaseError=g},"PG");"u">typeof eC.env.NODE_PG_FORCE_NATIVE?b.exports=new i(f9()):(b.exports=new i(c),Object.defineProperty(b.exports,"native",{configurable:!0,enumerable:!1,get(){var a=null;try{a=new i(f9())}catch(a){if("MODULE_NOT_FOUND"!==a.code)throw a}return Object.defineProperty(b.exports,"native",{value:a}),a}}))});eU();var gb=eO(ga());fS(),eU(),fS(),fH();var gc=eO(fj()),gd=eO(fB());function ge(a){return a instanceof eB?"\\x"+a.toString("hex"):a}eJ(ge,"encodeBuffersAsBytea");var gf=class a extends Error{constructor(b){super(b),eQ(this,"name","NeonDbError"),eQ(this,"severity"),eQ(this,"code"),eQ(this,"detail"),eQ(this,"hint"),eQ(this,"position"),eQ(this,"internalPosition"),eQ(this,"internalQuery"),eQ(this,"where"),eQ(this,"schema"),eQ(this,"table"),eQ(this,"column"),eQ(this,"dataType"),eQ(this,"constraint"),eQ(this,"file"),eQ(this,"line"),eQ(this,"routine"),eQ(this,"sourceError"),"captureStackTrace"in Error&&"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,a)}};eJ(gf,"NeonDbError");var gg="transaction() expects an array of queries, or a function returning an array of queries",gh=["severity","code","detail","hint","position","internalPosition","internalQuery","where","schema","table","column","dataType","constraint","file","line","routine"];function gi(a,{arrayMode:b,fullResults:c,fetchOptions:d,isolationLevel:e,readOnly:f,deferrable:g,queryCallback:h,resultCallback:i,authToken:j}={}){let k;if(!a)throw Error("No database connection string was provided to `neon()`. Perhaps an environment variable has not been set?");try{k=fG(a)}catch{throw Error("Database connection string provided to `neon()` is not a valid URL. Connection string: "+String(a))}let{protocol:l,username:m,hostname:n,port:o,pathname:p}=k;if("postgres:"!==l&&"postgresql:"!==l||!m||!n||!p)throw Error("Database connection string format for `neon()` should be: postgresql://user:password@host.tld/dbname?option=value");function q(a,...b){let c,d;if("string"==typeof a)c=a,d=b[1],b=b[0]??[];else{c="";for(let d=0;d<a.length;d++)c+=a[d],d<b.length&&(c+="$"+(d+1))}let e={query:c,params:b=b.map(a=>ge((0,gc.prepareValue)(a)))};return h&&h(e),gj(r,e,d)}async function r(h,k,l){let m,{fetchEndpoint:p,fetchFunction:q}=fR,r=Array.isArray(h)?{queries:h}:h,s=d??{},t=b??!1,u=c??!1,v=e,w=f,x=g;void 0!==l&&(void 0!==l.fetchOptions&&(s={...s,...l.fetchOptions}),void 0!==l.arrayMode&&(t=l.arrayMode),void 0!==l.fullResults&&(u=l.fullResults),void 0!==l.isolationLevel&&(v=l.isolationLevel),void 0!==l.readOnly&&(w=l.readOnly),void 0!==l.deferrable&&(x=l.deferrable)),void 0===k||Array.isArray(k)||void 0===k.fetchOptions||(s={...s,...k.fetchOptions});let y=j;Array.isArray(k)||k?.authToken===void 0||(y=k.authToken);let z="function"==typeof p?p(n,o,{jwtAuth:void 0!==y}):p,A={"Neon-Connection-String":a,"Neon-Raw-Text-Output":"true","Neon-Array-Mode":"true"},B=await gl(y);B&&(A.Authorization=`Bearer ${B}`),Array.isArray(h)&&(void 0!==v&&(A["Neon-Batch-Isolation-Level"]=v),void 0!==w&&(A["Neon-Batch-Read-Only"]=String(w)),void 0!==x&&(A["Neon-Batch-Deferrable"]=String(x)));try{m=await (q??fetch)(z,{method:"POST",body:JSON.stringify(r),headers:A,...s})}catch(b){let a=new gf(`Error connecting to database: ${b.message}`);throw a.sourceError=b,a}if(m.ok){let a=await m.json();if(Array.isArray(h)){let b=a.results;if(!Array.isArray(b))throw new gf("Neon internal error: unexpected result format");return b.map((a,b)=>{let c=k[b]??{};return gk(a,{arrayMode:c.arrayMode??t,fullResults:c.fullResults??u,parameterizedQuery:h[b],resultCallback:i,types:c.types})})}{let b=k??{};return gk(a,{arrayMode:b.arrayMode??t,fullResults:b.fullResults??u,parameterizedQuery:h,resultCallback:i,types:b.types})}}{let{status:a}=m;if(400===a){let a=await m.json(),b=new gf(a.message);for(let c of gh)b[c]=a[c]??void 0;throw b}{let b=await m.text();throw new gf(`Server er\
ror (HTTP status ${a}): ${b}`)}}}return eJ(q,"resolve"),q.transaction=async(a,b)=>{if("function"==typeof a&&(a=a(q)),!Array.isArray(a))throw Error(gg);return a.forEach(a=>{if("NeonQueryPromise"!==a[Symbol.toStringTag])throw Error(gg)}),r(a.map(a=>a.parameterizedQuery),a.map(a=>a.opts??{}),b)},eJ(r,"execute"),q}function gj(a,b,c){return{[Symbol.toStringTag]:"NeonQueryPromise",parameterizedQuery:b,opts:c,then:eJ((d,e)=>a(b,c).then(d,e),"then"),catch:eJ(d=>a(b,c).catch(d),"catch"),finally:eJ(d=>a(b,c).finally(d),"finally")}}function gk(a,{arrayMode:b,fullResults:c,parameterizedQuery:d,resultCallback:e,types:f}){let g=new gd.default(f),h=a.fields.map(a=>a.name),i=a.fields.map(a=>g.getTypeParser(a.dataTypeID)),j=!0===b?a.rows.map(a=>a.map((a,b)=>null===a?null:i[b](a))):a.rows.map(a=>Object.fromEntries(a.map((a,b)=>[h[b],null===a?null:i[b](a)])));return e&&e(d,a,j,{arrayMode:b,fullResults:c}),c?(a.viaNeonFetch=!0,a.rowAsArray=b,a.rows=j,a._parsers=i,a._types=g,a):j}async function gl(a){if("string"==typeof a)return a;if("function"==typeof a)try{return await Promise.resolve(a())}catch(b){let a=new gf("Error getting auth token.");throw b instanceof Error&&(a=new gf(`Error getting auth toke\
n: ${b.message}`)),a}}eJ(gi,"neon"),eJ(gj,"createNeonQueryPromise"),eJ(gk,"processQueryResult"),eJ(gl,"getAuthToken");var gm=eO(fJ()),gn=eO(ga()),go=class extends gb.Client{constructor(a){super(a),this.config=a}get neonConfig(){return this.connection.stream}connect(a){let{neonConfig:b}=this;b.forceDisablePgSSL&&(this.ssl=this.connection.ssl=!1),this.ssl&&b.useSecureWebSocket&&console.warn("SSL is enabled for both Postgres (e.g. ?sslmode=require in the connection string + forceDisablePgSSL = false) and the WebSocket tunnel (useSecureWebSocket = true). Double encryption will increase latency and CPU usage. It may be appropriate to disable SSL in the Postgres connection parameters or set forceDisablePgSSL = true.");let c=this.config?.host!==void 0||this.config?.connectionString!==void 0||void 0!==eC.env.PGHOST,d=eC.env.USER??eC.env.USERNAME;if(!c&&"localhost"===this.host&&this.user===d&&this.database===d&&null===this.password)throw Error(`No datab\
ase host or connection string was set, and key parameters have default values (h\
ost: localhost, user: ${d}, db: ${d}, password: null). Is an environment variabl\
e missing? Alternatively, if you intended to connect with these parameters, plea\
se set the host to 'localhost' explicitly.`);let e=super.connect(a),f=b.pipelineTLS&&this.ssl,g="password"===b.pipelineConnect;if(!f&&!b.pipelineConnect)return e;let h=this.connection;if(f&&h.on("connect",()=>h.stream.emit("data","S")),g){h.removeAllListeners("authenticationCleartextPassword"),h.removeAllListeners("readyForQuery"),h.once("readyForQuery",()=>h.on("readyForQuery",this._handleReadyForQuery.bind(this)));let a=this.ssl?"sslconnect":"connect";h.on(a,()=>{this._handleAuthCleartextPassword(),this._handleReadyForQuery()})}return e}async _handleAuthSASLContinue(a){let b=this.saslSession,c=this.password,d=a.data;if("SASLInitialResponse"!==b.message||"string"!=typeof c||"string"!=typeof d)throw Error("SASL: protocol error");let e=Object.fromEntries(d.split(",").map(a=>{if(!/^.=/.test(a))throw Error("SASL: Invalid attribute pair entry");return[a[0],a.substring(2)]})),f=e.r,g=e.s,h=e.i;if(!f||!/^[!-+--~]+$/.test(f))throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce missing/unprintable");if(!g||!/^(?:[a-zA-Z0-9+/]{4})*(?:[a-zA-Z0-9+/]{2}==|[a-zA-Z0-9+/]{3}=)?$/.test(g))throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt missing/not base64");if(!h||!/^[1-9][0-9]*$/.test(h))throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: missing/invalid iteration count");if(!f.startsWith(b.clientNonce))throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce does not start with client nonce");if(f.length===b.clientNonce.length)throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce is too short");let i=parseInt(h,10),j=eB.from(g,"base64"),k=new TextEncoder,l=k.encode(c),m=await eA.subtle.importKey("raw",l,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),n=new Uint8Array(await eA.subtle.sign("HMAC",m,eB.concat([j,eB.from([0,0,0,1])]))),o=n;for(var p=0;p<i-1;p++)n=new Uint8Array(await eA.subtle.sign("HMAC",m,n)),o=eB.from(o.map((a,b)=>o[b]^n[b]));let q=o,r=await eA.subtle.importKey("raw",q,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),s=new Uint8Array(await eA.subtle.sign("HMAC",r,k.encode("Client Key"))),t=await eA.subtle.digest("SHA-256",s),u="n=*,r="+b.clientNonce,v="r="+f+",s="+g+",i="+i,w="c=biws,r="+f,x=u+","+v+","+w,y=await eA.subtle.importKey("raw",t,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);var z=new Uint8Array(await eA.subtle.sign("HMAC",y,k.encode(x))),A=eB.from(s.map((a,b)=>s[b]^z[b])).toString("base64");let B=await eA.subtle.importKey("raw",q,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),C=await eA.subtle.sign("HMAC",B,k.encode("Server Key")),D=await eA.subtle.importKey("raw",C,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);var E=eB.from(await eA.subtle.sign("HMAC",D,k.encode(x)));b.message="SASLResponse",b.serverSignature=E.toString("base64"),b.response=w+",p="+A,this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}};function gp(a,b){let c,d;return b?{callback:b,result:void 0}:{callback:eJ(function(a,b){a?c(a):d(b)},"cb"),result:new a(function(a,b){d=a,c=b})}}eJ(go,"NeonClient"),eJ(gp,"promisify"),eJ(class extends gb.Pool{constructor(){super(...arguments),eQ(this,"Client",go),eQ(this,"hasFetchUnsupportedListeners",!1)}on(a,b){return"error"!==a&&(this.hasFetchUnsupportedListeners=!0),super.on(a,b)}query(a,b,c){if(!fR.poolQueryViaFetch||this.hasFetchUnsupportedListeners||"function"==typeof a)return super.query(a,b,c);"function"==typeof b&&(c=b,b=void 0);let d=gp(this.Promise,c);c=d.callback;try{let d=new gm.default(this.options),e=encodeURIComponent,f=encodeURI,g=`postgresql://${e(d.user)}:${e(d.password)}@${e(d.host)}/${f(d.database)}`,h="string"==typeof a?a:a.text,i=b??a.values??[];gi(g,{fullResults:!0,arrayMode:"array"===a.rowMode})(h,i,{types:a.types??this.options?.types}).then(a=>c(void 0,a)).catch(a=>c(a))}catch(a){c(a)}return d.result}},"NeonPool"),gn.ClientBase,gn.Connection,gn.DatabaseError,gn.Query,gn.defaults;var gq=gn.types;class gr{static [y]="ConsoleLogWriter";write(a){console.log(a)}}class gs{static [y]="DefaultLogger";writer;constructor(a){this.writer=a?.writer??new gr}logQuery(a,b){let c=b.map(a=>{try{return JSON.stringify(a)}catch{return String(a)}}),d=c.length?` -- params: [${c.join(", ")}]`:"";this.writer.write(`Query: ${a}${d}`)}}class gt{static [y]="NoopLogger";logQuery(){}}class gu{constructor(a){this.table=a}static [y]="ColumnAliasProxyHandler";get(a,b){return"table"===b?this.table:a[b]}}class gv{constructor(a,b){this.alias=a,this.replaceOriginalName=b}static [y]="TableAliasProxyHandler";get(a,b){if(b===ae.Symbol.IsAlias)return!0;if(b===ae.Symbol.Name||this.replaceOriginalName&&b===ae.Symbol.OriginalName)return this.alias;if(b===X)return{...a[X],name:this.alias,isAlias:!0};if(b===ae.Symbol.Columns){let b=a[ae.Symbol.Columns];if(!b)return b;let c={};return Object.keys(b).map(d=>{c[d]=new Proxy(b[d],new gu(new Proxy(a,this)))}),c}let c=a[b];return z(c,B)?new Proxy(c,new gu(new Proxy(a,this))):c}}class gw{constructor(a){this.alias=a}static [y]=null;get(a,b){return"sourceTable"===b?gx(a.sourceTable,this.alias):a[b]}}function gx(a,b){return new Proxy(a,new gv(b,!1))}function gy(a,b){return new Proxy(a,new gu(new Proxy(a.table,new gv(b,!1))))}function gz(a,b){return new ak.Aliased(gA(a.sql,b),a.fieldAlias)}function gA(a,b){return ap.join(a.queryChunks.map(a=>z(a,B)?gy(a,b):z(a,ak)?gA(a,b):z(a,ak.Aliased)?gz(a,b):a))}function gB(a){return(a.replace(/['\u2019]/g,"").match(/[\da-z]+|[A-Z]+(?![a-z])|[A-Z][\da-z]+/g)??[]).map(a=>a.toLowerCase()).join("_")}function gC(a){return(a.replace(/['\u2019]/g,"").match(/[\da-z]+|[A-Z]+(?![a-z])|[A-Z][\da-z]+/g)??[]).reduce((a,b,c)=>a+(0===c?b.toLowerCase():`${b[0].toUpperCase()}${b.slice(1)}`),"")}function gD(a){return a}class gE{static [y]="CasingCache";cache={};cachedTables={};convert;constructor(a){this.convert="snake_case"===a?gB:"camelCase"===a?gC:gD}getColumnCasing(a){if(!a.keyAsName)return a.name;let b=a.table[ae.Symbol.Schema]??"public",c=a.table[ae.Symbol.OriginalName],d=`${b}.${c}.${a.name}`;return this.cache[d]||this.cacheTable(a.table),this.cache[d]}cacheTable(a){let b=a[ae.Symbol.Schema]??"public",c=a[ae.Symbol.OriginalName],d=`${b}.${c}`;if(!this.cachedTables[d]){for(let b of Object.values(a[ae.Symbol.Columns])){let a=`${d}.${b.name}`;this.cache[a]=this.convert(b.name)}this.cachedTables[d]=!0}}clearCache(){this.cache={},this.cachedTables={}}}class gF extends Error{static [y]="DrizzleError";constructor({message:a,cause:b}){super(a),this.name="DrizzleError",this.cause=b}}class gG extends gF{static [y]="TransactionRollbackError";constructor(){super({message:"Rollback"})}}class gH{static [y]="PgPrimaryKeyBuilder";columns;name;constructor(a,b){this.columns=a,this.name=b}build(a){return new gI(a,this.columns,this.name)}}class gI{constructor(a,b,c){this.table=a,this.columns=b,this.name=c}static [y]="PgPrimaryKey";columns;name;getName(){return this.name??`${this.table[co.Symbol.Name]}_${this.columns.map(a=>a.name).join("_")}_pk`}}function gJ(a,b){return"object"!=typeof b||null===b||!("mapToDriverValue"in b)||"function"!=typeof b.mapToDriverValue||ai(a)||z(a,ao)||z(a,aq)||z(a,B)||z(a,ae)||z(a,at)?a:new ao(a,b)}let gK=(a,b)=>ap`${a} = ${gJ(b,a)}`,gL=(a,b)=>ap`${a} <> ${gJ(b,a)}`;function gM(...a){let b=a.filter(a=>void 0!==a);if(0!==b.length)return new ak(1===b.length?b:[new aj("("),ap.join(b,new aj(" and ")),new aj(")")])}function gN(...a){let b=a.filter(a=>void 0!==a);if(0!==b.length)return new ak(1===b.length?b:[new aj("("),ap.join(b,new aj(" or ")),new aj(")")])}function gO(a){return ap`not ${a}`}let gP=(a,b)=>ap`${a} > ${gJ(b,a)}`,gQ=(a,b)=>ap`${a} >= ${gJ(b,a)}`,gR=(a,b)=>ap`${a} < ${gJ(b,a)}`,gS=(a,b)=>ap`${a} <= ${gJ(b,a)}`;function gT(a,b){return Array.isArray(b)?0===b.length?ap`false`:ap`${a} in ${b.map(b=>gJ(b,a))}`:ap`${a} in ${gJ(b,a)}`}function gU(a,b){return Array.isArray(b)?0===b.length?ap`true`:ap`${a} not in ${b.map(b=>gJ(b,a))}`:ap`${a} not in ${gJ(b,a)}`}function gV(a){return ap`${a} is null`}function gW(a){return ap`${a} is not null`}function gX(a){return ap`exists ${a}`}function gY(a){return ap`not exists ${a}`}function gZ(a,b,c){return ap`${a} between ${gJ(b,a)} and ${gJ(c,a)}`}function g$(a,b,c){return ap`${a} not between ${gJ(b,a)} and ${gJ(c,a)}`}function g_(a,b){return ap`${a} like ${b}`}function g0(a,b){return ap`${a} not like ${b}`}function g1(a,b){return ap`${a} ilike ${b}`}function g2(a,b){return ap`${a} not ilike ${b}`}function g3(a){return ap`${a} asc`}function g4(a){return ap`${a} desc`}class g5{constructor(a,b,c){this.sourceTable=a,this.referencedTable=b,this.relationName=c,this.referencedTableName=b[ae.Symbol.Name]}static [y]="Relation";referencedTableName;fieldName}class g6{constructor(a,b){this.table=a,this.config=b}static [y]="Relations"}class g7 extends g5{constructor(a,b,c,d){super(a,b,c?.relationName),this.config=c,this.isNullable=d}static [y]="One";withFieldName(a){let b=new g7(this.sourceTable,this.referencedTable,this.config,this.isNullable);return b.fieldName=a,b}}class g8 extends g5{constructor(a,b,c){super(a,b,c?.relationName),this.config=c}static [y]="Many";withFieldName(a){let b=new g8(this.sourceTable,this.referencedTable,this.config);return b.fieldName=a,b}}function g9(a){return{one:function(b,c){return new g7(a,b,c,c?.fields.reduce((a,b)=>a&&b.notNull,!0)??!1)},many:function(b,c){return new g8(a,b,c)}}}class ha extends at{static [y]="PgViewBase"}class hb{static [y]="PgDialect";casing;constructor(a){this.casing=new gE(a?.casing)}async migrate(a,b,c){let d="string"==typeof c?"__drizzle_migrations":c.migrationsTable??"__drizzle_migrations",e="string"==typeof c?"drizzle":c.migrationsSchema??"drizzle",f=ap`
			CREATE TABLE IF NOT EXISTS ${ap.identifier(e)}.${ap.identifier(d)} (
				id SERIAL PRIMARY KEY,
				hash text NOT NULL,
				created_at bigint
			)
		`;await b.execute(ap`CREATE SCHEMA IF NOT EXISTS ${ap.identifier(e)}`),await b.execute(f);let g=(await b.all(ap`select id, hash, created_at from ${ap.identifier(e)}.${ap.identifier(d)} order by created_at desc limit 1`))[0];await b.transaction(async b=>{for await(let c of a)if(!g||Number(g.created_at)<c.folderMillis){for(let a of c.sql)await b.execute(ap.raw(a));await b.execute(ap`insert into ${ap.identifier(e)}.${ap.identifier(d)} ("hash", "created_at") values(${c.hash}, ${c.folderMillis})`)}})}escapeName(a){return`"${a}"`}escapeParam(a){return`$${a+1}`}escapeString(a){return`'${a.replace(/'/g,"''")}'`}buildWithCTE(a){if(!a?.length)return;let b=[ap`with `];for(let[c,d]of a.entries())b.push(ap`${ap.identifier(d._.alias)} as (${d._.sql})`),c<a.length-1&&b.push(ap`, `);return b.push(ap` `),ap.join(b)}buildDeleteQuery({table:a,where:b,returning:c,withList:d}){let e=this.buildWithCTE(d),f=c?ap` returning ${this.buildSelection(c,{isSingleTable:!0})}`:void 0,g=b?ap` where ${b}`:void 0;return ap`${e}delete from ${a}${g}${f}`}buildUpdateSet(a,b){let c=a[ae.Symbol.Columns],d=Object.keys(c).filter(a=>void 0!==b[a]||c[a]?.onUpdateFn!==void 0),e=d.length;return ap.join(d.flatMap((a,d)=>{let f=c[a],g=b[a]??ap.param(f.onUpdateFn(),f),h=ap`${ap.identifier(this.casing.getColumnCasing(f))} = ${g}`;return d<e-1?[h,ap.raw(", ")]:[h]}))}buildUpdateQuery({table:a,set:b,where:c,returning:d,withList:e,from:f,joins:g}){let h=this.buildWithCTE(e),i=a[co.Symbol.Name],j=a[co.Symbol.Schema],k=a[co.Symbol.OriginalName],l=i===k?void 0:i,m=ap`${j?ap`${ap.identifier(j)}.`:void 0}${ap.identifier(k)}${l&&ap` ${ap.identifier(l)}`}`,n=this.buildUpdateSet(a,b),o=f&&ap.join([ap.raw(" from "),this.buildFromTable(f)]),p=this.buildJoins(g),q=d?ap` returning ${this.buildSelection(d,{isSingleTable:!f})}`:void 0,r=c?ap` where ${c}`:void 0;return ap`${h}update ${m} set ${n}${o}${p}${r}${q}`}buildSelection(a,{isSingleTable:b=!1}={}){let c=a.length,d=a.flatMap(({field:a},d)=>{let e=[];if(z(a,ak.Aliased)&&a.isSelectionField)e.push(ap.identifier(a.fieldAlias));else if(z(a,ak.Aliased)||z(a,ak)){let c=z(a,ak.Aliased)?a.sql:a;b?e.push(new ak(c.queryChunks.map(a=>z(a,M)?ap.identifier(this.casing.getColumnCasing(a)):a))):e.push(c),z(a,ak.Aliased)&&e.push(ap` as ${ap.identifier(a.fieldAlias)}`)}else z(a,B)&&(b?e.push(ap.identifier(this.casing.getColumnCasing(a))):e.push(a));return d<c-1&&e.push(ap`, `),e});return ap.join(d)}buildJoins(a){if(!a||0===a.length)return;let b=[];for(let[c,d]of a.entries()){0===c&&b.push(ap` `);let e=d.table,f=d.lateral?ap` lateral`:void 0;if(z(e,co)){let a=e[co.Symbol.Name],c=e[co.Symbol.Schema],g=e[co.Symbol.OriginalName],h=a===g?void 0:d.alias;b.push(ap`${ap.raw(d.joinType)} join${f} ${c?ap`${ap.identifier(c)}.`:void 0}${ap.identifier(g)}${h&&ap` ${ap.identifier(h)}`} on ${d.on}`)}else if(z(e,at)){let a=e[X].name,c=e[X].schema,g=e[X].originalName,h=a===g?void 0:d.alias;b.push(ap`${ap.raw(d.joinType)} join${f} ${c?ap`${ap.identifier(c)}.`:void 0}${ap.identifier(g)}${h&&ap` ${ap.identifier(h)}`} on ${d.on}`)}else b.push(ap`${ap.raw(d.joinType)} join${f} ${e} on ${d.on}`);c<a.length-1&&b.push(ap` `)}return ap.join(b)}buildFromTable(a){if(z(a,ae)&&a[ae.Symbol.OriginalName]!==a[ae.Symbol.Name]){let b=ap`${ap.identifier(a[ae.Symbol.OriginalName])}`;return a[ae.Symbol.Schema]&&(b=ap`${ap.identifier(a[ae.Symbol.Schema])}.${b}`),ap`${b} ${ap.identifier(a[ae.Symbol.Name])}`}return a}buildSelectQuery({withList:a,fields:b,fieldsFlat:c,where:d,having:e,table:f,joins:g,orderBy:h,groupBy:i,limit:j,offset:k,lockingClause:l,distinct:m,setOperators:n}){let o,p,q,r=c??au(b);for(let a of r){let b;if(z(a.field,B)&&a.field.table[C]!==(z(f,U)?f._.alias:z(f,ha)?f[X].name:z(f,ak)?void 0:f[C])&&(b=a.field.table,!g?.some(({alias:a})=>a===(b[ae.Symbol.IsAlias]?b[C]:b[ae.Symbol.BaseName])))){let b=a.field.table[C];throw Error(`Your "${a.path.join("->")}" field references a column "${b}"."${a.field.name}", but the table "${b}" is not part of the query! Did you forget to join it?`)}}let s=!g||0===g.length,t=this.buildWithCTE(a);m&&(o=!0===m?ap` distinct`:ap` distinct on (${ap.join(m.on,ap`, `)})`);let u=this.buildSelection(r,{isSingleTable:s}),v=this.buildFromTable(f),w=this.buildJoins(g),x=d?ap` where ${d}`:void 0,y=e?ap` having ${e}`:void 0;h&&h.length>0&&(p=ap` order by ${ap.join(h,ap`, `)}`),i&&i.length>0&&(q=ap` group by ${ap.join(i,ap`, `)}`);let A="object"==typeof j||"number"==typeof j&&j>=0?ap` limit ${j}`:void 0,D=k?ap` offset ${k}`:void 0,E=ap.empty();if(l){let a=ap` for ${ap.raw(l.strength)}`;l.config.of&&a.append(ap` of ${ap.join(Array.isArray(l.config.of)?l.config.of:[l.config.of],ap`, `)}`),l.config.noWait?a.append(ap` no wait`):l.config.skipLocked&&a.append(ap` skip locked`),E.append(a)}let F=ap`${t}select${o} ${u} from ${v}${w}${x}${q}${y}${p}${A}${D}${E}`;return n.length>0?this.buildSetOperations(F,n):F}buildSetOperations(a,b){let[c,...d]=b;if(!c)throw Error("Cannot pass undefined values to any set operator");return 0===d.length?this.buildSetOperationQuery({leftSelect:a,setOperator:c}):this.buildSetOperations(this.buildSetOperationQuery({leftSelect:a,setOperator:c}),d)}buildSetOperationQuery({leftSelect:a,setOperator:{type:b,isAll:c,rightSelect:d,limit:e,orderBy:f,offset:g}}){let h,i=ap`(${a.getSQL()}) `,j=ap`(${d.getSQL()})`;if(f&&f.length>0){let a=[];for(let b of f)if(z(b,M))a.push(ap.identifier(b.name));else if(z(b,ak)){for(let a=0;a<b.queryChunks.length;a++){let c=b.queryChunks[a];z(c,M)&&(b.queryChunks[a]=ap.identifier(c.name))}a.push(ap`${b}`)}else a.push(ap`${b}`);h=ap` order by ${ap.join(a,ap`, `)} `}let k="object"==typeof e||"number"==typeof e&&e>=0?ap` limit ${e}`:void 0,l=ap.raw(`${b} ${c?"all ":""}`),m=g?ap` offset ${g}`:void 0;return ap`${i}${l}${j}${h}${k}${m}`}buildInsertQuery({table:a,values:b,onConflict:c,returning:d,withList:e,select:f,overridingSystemValue_:g}){let h=[],i=Object.entries(a[ae.Symbol.Columns]).filter(([a,b])=>!b.shouldDisableInsert()),j=i.map(([,a])=>ap.identifier(this.casing.getColumnCasing(a)));if(f)z(b,ak)?h.push(b):h.push(b.getSQL());else for(let[a,c]of(h.push(ap.raw("values ")),b.entries())){let d=[];for(let[a,b]of i){let e=c[a];if(void 0===e||z(e,ao)&&void 0===e.value)if(void 0!==b.defaultFn){let a=b.defaultFn(),c=z(a,ak)?a:ap.param(a,b);d.push(c)}else if(b.default||void 0===b.onUpdateFn)d.push(ap`default`);else{let a=b.onUpdateFn(),c=z(a,ak)?a:ap.param(a,b);d.push(c)}else d.push(e)}h.push(d),a<b.length-1&&h.push(ap`, `)}let k=this.buildWithCTE(e),l=ap.join(h),m=d?ap` returning ${this.buildSelection(d,{isSingleTable:!0})}`:void 0,n=c?ap` on conflict ${c}`:void 0,o=!0===g?ap`overriding system value `:void 0;return ap`${k}insert into ${a} ${j} ${o}${l}${n}${m}`}buildRefreshMaterializedViewQuery({view:a,concurrently:b,withNoData:c}){let d=b?ap` concurrently`:void 0,e=c?ap` with no data`:void 0;return ap`refresh materialized view${d} ${a}${e}`}prepareTyping(a){if(z(a,bh)||z(a,be))return"json";if(z(a,bv))return"decimal";if(z(a,bZ))return"time";if(z(a,b0)||z(a,b2))return"timestamp";if(z(a,aZ)||z(a,a_))return"date";else if(z(a,b5))return"uuid";else return"none"}sqlToQuery(a,b){return a.toQuery({casing:this.casing,escapeName:this.escapeName,escapeParam:this.escapeParam,escapeString:this.escapeString,prepareTyping:this.prepareTyping,invokeSource:b})}buildRelationalQueryWithoutPK({fullSchema:a,schema:b,tableNamesMap:c,table:d,tableConfig:e,queryConfig:f,tableAlias:g,nestedQueryRelation:h,joinOn:i}){let j,k=[],l,m,n=[],o,p=[];if(!0===f)k=Object.entries(e.columns).map(([a,b])=>({dbKey:b.name,tsKey:a,field:gy(b,g),relationTableTsKey:void 0,isJson:!1,selection:[]}));else{let d=Object.fromEntries(Object.entries(e.columns).map(([a,b])=>[a,gy(b,g)]));if(f.where){let a="function"==typeof f.where?f.where(d,{and:gM,between:gZ,eq:gK,exists:gX,gt:gP,gte:gQ,ilike:g1,inArray:gT,isNull:gV,isNotNull:gW,like:g_,lt:gR,lte:gS,ne:gL,not:gO,notBetween:g$,notExists:gY,notLike:g0,notIlike:g2,notInArray:gU,or:gN,sql:ap}):f.where;o=a&&gA(a,g)}let h=[],i=[];if(f.columns){let a=!1;for(let[b,c]of Object.entries(f.columns))void 0!==c&&b in e.columns&&(a||!0!==c||(a=!0),i.push(b));i.length>0&&(i=a?i.filter(a=>f.columns?.[a]===!0):Object.keys(e.columns).filter(a=>!i.includes(a)))}else i=Object.keys(e.columns);for(let a of i){let b=e.columns[a];h.push({tsKey:a,value:b})}let j=[];if(f.with&&(j=Object.entries(f.with).filter(a=>!!a[1]).map(([a,b])=>({tsKey:a,queryConfig:b,relation:e.relations[a]}))),f.extras)for(let[a,b]of Object.entries("function"==typeof f.extras?f.extras(d,{sql:ap}):f.extras))h.push({tsKey:a,value:gz(b,g)});for(let{tsKey:a,value:b}of h)k.push({dbKey:z(b,ak.Aliased)?b.fieldAlias:e.columns[a].name,tsKey:a,field:z(b,B)?gy(b,g):b,relationTableTsKey:void 0,isJson:!1,selection:[]});let q="function"==typeof f.orderBy?f.orderBy(d,{sql:ap,asc:g3,desc:g4}):f.orderBy??[];for(let{tsKey:d,queryConfig:e,relation:h}of(Array.isArray(q)||(q=[q]),n=q.map(a=>z(a,B)?gy(a,g):gA(a,g)),l=f.limit,m=f.offset,j)){let f=function(a,b,c){if(z(c,g7)&&c.config)return{fields:c.config.fields,references:c.config.references};let d=b[ag(c.referencedTable)];if(!d)throw Error(`Table "${c.referencedTable[ae.Symbol.Name]}" not found in schema`);let e=a[d];if(!e)throw Error(`Table "${d}" not found in schema`);let f=c.sourceTable,g=b[ag(f)];if(!g)throw Error(`Table "${f[ae.Symbol.Name]}" not found in schema`);let h=[];for(let a of Object.values(e.relations))(c.relationName&&c!==a&&a.relationName===c.relationName||!c.relationName&&a.referencedTable===c.sourceTable)&&h.push(a);if(h.length>1)throw c.relationName?Error(`There are multiple relations with name "${c.relationName}" in table "${d}"`):Error(`There are multiple relations between "${d}" and "${c.sourceTable[ae.Symbol.Name]}". Please specify relation name`);if(h[0]&&z(h[0],g7)&&h[0].config)return{fields:h[0].config.references,references:h[0].config.fields};throw Error(`There is not enough information to infer relation "${g}.${c.fieldName}"`)}(b,c,h),i=c[ag(h.referencedTable)],j=`${g}_${d}`,l=gM(...f.fields.map((a,b)=>gK(gy(f.references[b],j),gy(a,g)))),m=this.buildRelationalQueryWithoutPK({fullSchema:a,schema:b,tableNamesMap:c,table:a[i],tableConfig:b[i],queryConfig:z(h,g7)?!0===e?{limit:1}:{...e,limit:1}:e,tableAlias:j,joinOn:l,nestedQueryRelation:h}),n=ap`${ap.identifier(j)}.${ap.identifier("data")}`.as(d);p.push({on:ap`true`,table:new U(m.sql,{},j),alias:j,joinType:"left",lateral:!0}),k.push({dbKey:d,tsKey:d,field:n,relationTableTsKey:i,isJson:!0,selection:m.selection})}}if(0===k.length)throw new gF({message:`No fields selected for table "${e.tsName}" ("${g}")`});if(o=gM(i,o),h){let a=ap`json_build_array(${ap.join(k.map(({field:a,tsKey:b,isJson:c})=>c?ap`${ap.identifier(`${g}_${b}`)}.${ap.identifier("data")}`:z(a,ak.Aliased)?a.sql:a),ap`, `)})`;z(h,g8)&&(a=ap`coalesce(json_agg(${a}${n.length>0?ap` order by ${ap.join(n,ap`, `)}`:void 0}), '[]'::json)`);let b=[{dbKey:"data",tsKey:"data",field:a.as("data"),isJson:!0,relationTableTsKey:e.tsName,selection:k}];void 0!==l||void 0!==m||n.length>0?(j=this.buildSelectQuery({table:gx(d,g),fields:{},fieldsFlat:[{path:[],field:ap.raw("*")}],where:o,limit:l,offset:m,orderBy:n,setOperators:[]}),o=void 0,l=void 0,m=void 0,n=[]):j=gx(d,g),j=this.buildSelectQuery({table:z(j,co)?j:new U(j,{},g),fields:{},fieldsFlat:b.map(({field:a})=>({path:[],field:z(a,B)?gy(a,g):a})),joins:p,where:o,limit:l,offset:m,orderBy:n,setOperators:[]})}else j=this.buildSelectQuery({table:gx(d,g),fields:{},fieldsFlat:k.map(({field:a})=>({path:[],field:z(a,B)?gy(a,g):a})),joins:p,where:o,limit:l,offset:m,orderBy:n,setOperators:[]});return{tableTsKey:e.tsName,sql:j,selection:k}}}class hc{static [y]="SelectionProxyHandler";config;constructor(a){this.config={...a}}get(a,b){if("_"===b)return{...a._,selectedFields:new Proxy(a._.selectedFields,this)};if(b===X)return{...a[X],selectedFields:new Proxy(a[X].selectedFields,this)};if("symbol"==typeof b)return a[b];let c=(z(a,U)?a._.selectedFields:z(a,at)?a[X].selectedFields:a)[b];if(z(c,ak.Aliased)){if("sql"===this.config.sqlAliasedBehavior&&!c.isSelectionField)return c.sql;let a=c.clone();return a.isSelectionField=!0,a}if(z(c,ak)){if("sql"===this.config.sqlBehavior)return c;throw Error(`You tried to reference "${b}" field from a subquery, which is a raw SQL field, but it doesn't have an alias declared. Please add an alias to the field using ".as('alias')" method.`)}return z(c,B)?this.config.alias?new Proxy(c,new gu(new Proxy(c.table,new gv(this.config.alias,this.config.replaceOriginalName??!1)))):c:"object"!=typeof c||null===c?c:new Proxy(c,new hc(this.config))}}class hd{static [y]="TypedQueryBuilder";getSelectedFields(){return this._.selectedFields}}class he{static [y]="QueryPromise";[Symbol.toStringTag]="QueryPromise";catch(a){return this.then(void 0,a)}finally(a){return this.then(b=>(a?.(),b),b=>{throw a?.(),b})}then(a,b){return this.execute().then(a,b)}}class hf{static [y]="PgSelectBuilder";fields;session;dialect;withList=[];distinct;constructor(a){this.fields=a.fields,this.session=a.session,this.dialect=a.dialect,a.withList&&(this.withList=a.withList),this.distinct=a.distinct}authToken;setToken(a){return this.authToken=a,this}from(a){let b,c=!!this.fields;return b=this.fields?this.fields:z(a,U)?Object.fromEntries(Object.keys(a._.selectedFields).map(b=>[b,a[b]])):z(a,ha)?a[X].selectedFields:z(a,ak)?{}:ax(a),new hh({table:a,fields:b,isPartialSelect:c,session:this.session,dialect:this.dialect,withList:this.withList,distinct:this.distinct}).setToken(this.authToken)}}class hg extends hd{static [y]="PgSelectQueryBuilder";_;config;joinsNotNullableMap;tableName;isPartialSelect;session;dialect;constructor({table:a,fields:b,isPartialSelect:c,session:d,dialect:e,withList:f,distinct:g}){super(),this.config={withList:f,table:a,fields:{...b},distinct:g,setOperators:[]},this.isPartialSelect=c,this.session=d,this.dialect=e,this._={selectedFields:b},this.tableName=ay(a),this.joinsNotNullableMap="string"==typeof this.tableName?{[this.tableName]:!0}:{}}createJoin(a){return(b,c)=>{let d=this.tableName,e=ay(b);if("string"==typeof e&&this.config.joins?.some(a=>a.alias===e))throw Error(`Alias "${e}" is already used in this query`);if(!this.isPartialSelect&&(1===Object.keys(this.joinsNotNullableMap).length&&"string"==typeof d&&(this.config.fields={[d]:this.config.fields}),"string"==typeof e&&!z(b,ak))){let a=z(b,U)?b._.selectedFields:z(b,at)?b[X].selectedFields:b[ae.Symbol.Columns];this.config.fields[e]=a}if("function"==typeof c&&(c=c(new Proxy(this.config.fields,new hc({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.joins||(this.config.joins=[]),this.config.joins.push({on:c,table:b,joinType:a,alias:e}),"string"==typeof e)switch(a){case"left":this.joinsNotNullableMap[e]=!1;break;case"right":this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([a])=>[a,!1])),this.joinsNotNullableMap[e]=!0;break;case"inner":this.joinsNotNullableMap[e]=!0;break;case"full":this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([a])=>[a,!1])),this.joinsNotNullableMap[e]=!1}return this}}leftJoin=this.createJoin("left");rightJoin=this.createJoin("right");innerJoin=this.createJoin("inner");fullJoin=this.createJoin("full");createSetOperator(a,b){return c=>{let d="function"==typeof c?c(hj()):c;if(!av(this.getSelectedFields(),d.getSelectedFields()))throw Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return this.config.setOperators.push({type:a,isAll:b,rightSelect:d}),this}}union=this.createSetOperator("union",!1);unionAll=this.createSetOperator("union",!0);intersect=this.createSetOperator("intersect",!1);intersectAll=this.createSetOperator("intersect",!0);except=this.createSetOperator("except",!1);exceptAll=this.createSetOperator("except",!0);addSetOperators(a){return this.config.setOperators.push(...a),this}where(a){return"function"==typeof a&&(a=a(new Proxy(this.config.fields,new hc({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.where=a,this}having(a){return"function"==typeof a&&(a=a(new Proxy(this.config.fields,new hc({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.having=a,this}groupBy(...a){if("function"==typeof a[0]){let b=a[0](new Proxy(this.config.fields,new hc({sqlAliasedBehavior:"alias",sqlBehavior:"sql"})));this.config.groupBy=Array.isArray(b)?b:[b]}else this.config.groupBy=a;return this}orderBy(...a){if("function"==typeof a[0]){let b=a[0](new Proxy(this.config.fields,new hc({sqlAliasedBehavior:"alias",sqlBehavior:"sql"}))),c=Array.isArray(b)?b:[b];this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=c:this.config.orderBy=c}else this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=a:this.config.orderBy=a;return this}limit(a){return this.config.setOperators.length>0?this.config.setOperators.at(-1).limit=a:this.config.limit=a,this}offset(a){return this.config.setOperators.length>0?this.config.setOperators.at(-1).offset=a:this.config.offset=a,this}for(a,b={}){return this.config.lockingClause={strength:a,config:b},this}getSQL(){return this.dialect.buildSelectQuery(this.config)}toSQL(){let{typings:a,...b}=this.dialect.sqlToQuery(this.getSQL());return b}as(a){return new Proxy(new U(this.getSQL(),this.config.fields,a),new hc({alias:a,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}getSelectedFields(){return new Proxy(this.config.fields,new hc({alias:this.tableName,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}$dynamic(){return this}}class hh extends hg{static [y]="PgSelect";_prepare(a){let{session:b,config:c,dialect:d,joinsNotNullableMap:e,authToken:f}=this;if(!b)throw Error("Cannot execute a query on a query builder. Please use a database instance instead.");return W.startActiveSpan("drizzle.prepareQuery",()=>{let g=au(c.fields),h=b.prepareQuery(d.sqlToQuery(this.getSQL()),g,a,!0);return h.joinsNotNullableMap=e,h.setToken(f)})}prepare(a){return this._prepare(a)}authToken;setToken(a){return this.authToken=a,this}execute=a=>W.startActiveSpan("drizzle.operation",()=>this._prepare().execute(a,this.authToken))}for(let a of[he])for(let b of Object.getOwnPropertyNames(a.prototype))"constructor"!==b&&Object.defineProperty(hh.prototype,b,Object.getOwnPropertyDescriptor(a.prototype,b)||Object.create(null));function hi(a,b){return(c,d,...e)=>{let f=[d,...e].map(c=>({type:a,isAll:b,rightSelect:c}));for(let a of f)if(!av(c.getSelectedFields(),a.rightSelect.getSelectedFields()))throw Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return c.addSetOperators(f)}}let hj=()=>({union:hk,unionAll:hl,intersect:hm,intersectAll:hn,except:ho,exceptAll:hp}),hk=hi("union",!1),hl=hi("union",!0),hm=hi("intersect",!1),hn=hi("intersect",!0),ho=hi("except",!1),hp=hi("except",!0);class hq{static [y]="PgQueryBuilder";dialect;dialectConfig;constructor(a){this.dialect=z(a,hb)?a:void 0,this.dialectConfig=z(a,hb)?void 0:a}$with=(a,b)=>{let c=this;return{as:d=>("function"==typeof d&&(d=d(c)),new Proxy(new V(d.getSQL(),b??("getSelectedFields"in d?d.getSelectedFields()??{}:{}),a,!0),new hc({alias:a,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}};with(...a){let b=this;return{select:function(c){return new hf({fields:c??void 0,session:void 0,dialect:b.getDialect(),withList:a})},selectDistinct:function(a){return new hf({fields:a??void 0,session:void 0,dialect:b.getDialect(),distinct:!0})},selectDistinctOn:function(a,c){return new hf({fields:c??void 0,session:void 0,dialect:b.getDialect(),distinct:{on:a}})}}}select(a){return new hf({fields:a??void 0,session:void 0,dialect:this.getDialect()})}selectDistinct(a){return new hf({fields:a??void 0,session:void 0,dialect:this.getDialect(),distinct:!0})}selectDistinctOn(a,b){return new hf({fields:b??void 0,session:void 0,dialect:this.getDialect(),distinct:{on:a}})}getDialect(){return this.dialect||(this.dialect=new hb(this.dialectConfig)),this.dialect}}class hr{constructor(a,b,c,d){this.table=a,this.session=b,this.dialect=c,this.withList=d}static [y]="PgUpdateBuilder";authToken;setToken(a){return this.authToken=a,this}set(a){return new hs(this.table,aw(this.table,a),this.session,this.dialect,this.withList).setToken(this.authToken)}}class hs extends he{constructor(a,b,c,d,e){super(),this.session=c,this.dialect=d,this.config={set:b,table:a,withList:e,joins:[]},this.tableName=ay(a),this.joinsNotNullableMap="string"==typeof this.tableName?{[this.tableName]:!0}:{}}static [y]="PgUpdate";config;tableName;joinsNotNullableMap;from(a){let b=ay(a);return"string"==typeof b&&(this.joinsNotNullableMap[b]=!0),this.config.from=a,this}getTableLikeFields(a){return z(a,co)?a[ae.Symbol.Columns]:z(a,U)?a._.selectedFields:a[X].selectedFields}createJoin(a){return(b,c)=>{let d=ay(b);if("string"==typeof d&&this.config.joins.some(a=>a.alias===d))throw Error(`Alias "${d}" is already used in this query`);if("function"==typeof c){let a=this.config.from&&!z(this.config.from,ak)?this.getTableLikeFields(this.config.from):void 0;c=c(new Proxy(this.config.table[ae.Symbol.Columns],new hc({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})),a&&new Proxy(a,new hc({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))}if(this.config.joins.push({on:c,table:b,joinType:a,alias:d}),"string"==typeof d)switch(a){case"left":this.joinsNotNullableMap[d]=!1;break;case"right":this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([a])=>[a,!1])),this.joinsNotNullableMap[d]=!0;break;case"inner":this.joinsNotNullableMap[d]=!0;break;case"full":this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([a])=>[a,!1])),this.joinsNotNullableMap[d]=!1}return this}}leftJoin=this.createJoin("left");rightJoin=this.createJoin("right");innerJoin=this.createJoin("inner");fullJoin=this.createJoin("full");where(a){return this.config.where=a,this}returning(a){if(!a&&(a=Object.assign({},this.config.table[ae.Symbol.Columns]),this.config.from)){let b=ay(this.config.from);if("string"==typeof b&&this.config.from&&!z(this.config.from,ak)){let c=this.getTableLikeFields(this.config.from);a[b]=c}for(let b of this.config.joins){let c=ay(b.table);if("string"==typeof c&&!z(b.table,ak)){let d=this.getTableLikeFields(b.table);a[c]=d}}}return this.config.returningFields=a,this.config.returning=au(a),this}getSQL(){return this.dialect.buildUpdateQuery(this.config)}toSQL(){let{typings:a,...b}=this.dialect.sqlToQuery(this.getSQL());return b}_prepare(a){let b=this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,a,!0);return b.joinsNotNullableMap=this.joinsNotNullableMap,b}prepare(a){return this._prepare(a)}authToken;setToken(a){return this.authToken=a,this}execute=a=>this._prepare().execute(a,this.authToken);getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new hc({alias:this.config.table[C],sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}}class ht{constructor(a,b,c,d,e){this.table=a,this.session=b,this.dialect=c,this.withList=d,this.overridingSystemValue_=e}static [y]="PgInsertBuilder";authToken;setToken(a){return this.authToken=a,this}overridingSystemValue(){return this.overridingSystemValue_=!0,this}values(a){if(0===(a=Array.isArray(a)?a:[a]).length)throw Error("values() must be called with at least one value");let b=a.map(a=>{let b={},c=this.table[ae.Symbol.Columns];for(let d of Object.keys(a)){let e=a[d];b[d]=z(e,ak)?e:new ao(e,c[d])}return b});return new hu(this.table,b,this.session,this.dialect,this.withList,!1,this.overridingSystemValue_).setToken(this.authToken)}select(a){let b="function"==typeof a?a(new hq):a;if(!z(b,ak)&&!av(this.table[Z],b._.selectedFields))throw Error("Insert select error: selected fields are not the same or are in a different order compared to the table definition");return new hu(this.table,b,this.session,this.dialect,this.withList,!0)}}class hu extends he{constructor(a,b,c,d,e,f,g){super(),this.session=c,this.dialect=d,this.config={table:a,values:b,withList:e,select:f,overridingSystemValue_:g}}static [y]="PgInsert";config;returning(a=this.config.table[ae.Symbol.Columns]){return this.config.returningFields=a,this.config.returning=au(a),this}onConflictDoNothing(a={}){if(void 0===a.target)this.config.onConflict=ap`do nothing`;else{let b="";b=Array.isArray(a.target)?a.target.map(a=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(a))).join(","):this.dialect.escapeName(this.dialect.casing.getColumnCasing(a.target));let c=a.where?ap` where ${a.where}`:void 0;this.config.onConflict=ap`(${ap.raw(b)})${c} do nothing`}return this}onConflictDoUpdate(a){if(a.where&&(a.targetWhere||a.setWhere))throw Error('You cannot use both "where" and "targetWhere"/"setWhere" at the same time - "where" is deprecated, use "targetWhere" or "setWhere" instead.');let b=a.where?ap` where ${a.where}`:void 0,c=a.targetWhere?ap` where ${a.targetWhere}`:void 0,d=a.setWhere?ap` where ${a.setWhere}`:void 0,e=this.dialect.buildUpdateSet(this.config.table,aw(this.config.table,a.set)),f="";return f=Array.isArray(a.target)?a.target.map(a=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(a))).join(","):this.dialect.escapeName(this.dialect.casing.getColumnCasing(a.target)),this.config.onConflict=ap`(${ap.raw(f)})${c} do update set ${e}${b}${d}`,this}getSQL(){return this.dialect.buildInsertQuery(this.config)}toSQL(){let{typings:a,...b}=this.dialect.sqlToQuery(this.getSQL());return b}_prepare(a){return W.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,a,!0))}prepare(a){return this._prepare(a)}authToken;setToken(a){return this.authToken=a,this}execute=a=>W.startActiveSpan("drizzle.operation",()=>this._prepare().execute(a,this.authToken));getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new hc({alias:this.config.table[C],sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}}class hv extends he{constructor(a,b,c,d){super(),this.session=b,this.dialect=c,this.config={table:a,withList:d}}static [y]="PgDelete";config;where(a){return this.config.where=a,this}returning(a=this.config.table[ae.Symbol.Columns]){return this.config.returningFields=a,this.config.returning=au(a),this}getSQL(){return this.dialect.buildDeleteQuery(this.config)}toSQL(){let{typings:a,...b}=this.dialect.sqlToQuery(this.getSQL());return b}_prepare(a){return W.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,a,!0))}prepare(a){return this._prepare(a)}authToken;setToken(a){return this.authToken=a,this}execute=a=>W.startActiveSpan("drizzle.operation",()=>this._prepare().execute(a,this.authToken));getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new hc({alias:this.config.table[C],sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}}class hw extends ak{constructor(a){super(hw.buildEmbeddedCount(a.source,a.filters).queryChunks),this.params=a,this.mapWith(Number),this.session=a.session,this.sql=hw.buildCount(a.source,a.filters)}sql;token;static [y]="PgCountBuilder";[Symbol.toStringTag]="PgCountBuilder";session;static buildEmbeddedCount(a,b){return ap`(select count(*) from ${a}${ap.raw(" where ").if(b)}${b})`}static buildCount(a,b){return ap`select count(*) as count from ${a}${ap.raw(" where ").if(b)}${b};`}setToken(a){return this.token=a,this}then(a,b){return Promise.resolve(this.session.count(this.sql,this.token)).then(a,b)}catch(a){return this.then(void 0,a)}finally(a){return this.then(b=>(a?.(),b),b=>{throw a?.(),b})}}class hx{constructor(a,b,c,d,e,f,g){this.fullSchema=a,this.schema=b,this.tableNamesMap=c,this.table=d,this.tableConfig=e,this.dialect=f,this.session=g}static [y]="PgRelationalQueryBuilder";findMany(a){return new hy(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,a||{},"many")}findFirst(a){return new hy(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,a?{...a,limit:1}:{limit:1},"first")}}class hy extends he{constructor(a,b,c,d,e,f,g,h,i){super(),this.fullSchema=a,this.schema=b,this.tableNamesMap=c,this.table=d,this.tableConfig=e,this.dialect=f,this.session=g,this.config=h,this.mode=i}static [y]="PgRelationalQuery";_prepare(a){return W.startActiveSpan("drizzle.prepareQuery",()=>{let{query:b,builtQuery:c}=this._toSQL();return this.session.prepareQuery(c,void 0,a,!0,(a,c)=>{let d=a.map(a=>(function a(b,c,d,e,f=a=>a){let g={};for(let[h,i]of e.entries())if(i.isJson){let e=c.relations[i.tsKey],j=d[h],k="string"==typeof j?JSON.parse(j):j;g[i.tsKey]=z(e,g7)?k&&a(b,b[i.relationTableTsKey],k,i.selection,f):k.map(c=>a(b,b[i.relationTableTsKey],c,i.selection,f))}else{let a,b=f(d[h]),c=i.field;a=z(c,B)?c:z(c,ak)?c.decoder:c.sql.decoder,g[i.tsKey]=null===b?null:a.mapFromDriverValue(b)}return g})(this.schema,this.tableConfig,a,b.selection,c));return"first"===this.mode?d[0]:d})})}prepare(a){return this._prepare(a)}_getQuery(){return this.dialect.buildRelationalQueryWithoutPK({fullSchema:this.fullSchema,schema:this.schema,tableNamesMap:this.tableNamesMap,table:this.table,tableConfig:this.tableConfig,queryConfig:this.config,tableAlias:this.tableConfig.tsName})}getSQL(){return this._getQuery().sql}_toSQL(){let a=this._getQuery(),b=this.dialect.sqlToQuery(a.sql);return{query:a,builtQuery:b}}toSQL(){return this._toSQL().builtQuery}authToken;setToken(a){return this.authToken=a,this}execute(){return W.startActiveSpan("drizzle.operation",()=>this._prepare().execute(void 0,this.authToken))}}class hz extends he{constructor(a,b,c,d){super(),this.execute=a,this.sql=b,this.query=c,this.mapBatchResult=d}static [y]="PgRaw";getSQL(){return this.sql}getQuery(){return this.query}mapResult(a,b){return b?this.mapBatchResult(a):a}_prepare(){return this}isResponseInArrayMode(){return!1}}class hA extends he{constructor(a,b,c){super(),this.session=b,this.dialect=c,this.config={view:a}}static [y]="PgRefreshMaterializedView";config;concurrently(){if(void 0!==this.config.withNoData)throw Error("Cannot use concurrently and withNoData together");return this.config.concurrently=!0,this}withNoData(){if(void 0!==this.config.concurrently)throw Error("Cannot use concurrently and withNoData together");return this.config.withNoData=!0,this}getSQL(){return this.dialect.buildRefreshMaterializedViewQuery(this.config)}toSQL(){let{typings:a,...b}=this.dialect.sqlToQuery(this.getSQL());return b}_prepare(a){return W.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),void 0,a,!0))}prepare(a){return this._prepare(a)}authToken;setToken(a){return this.authToken=a,this}execute=a=>W.startActiveSpan("drizzle.operation",()=>this._prepare().execute(a,this.authToken))}class hB{constructor(a,b,c){if(this.dialect=a,this.session=b,this._=c?{schema:c.schema,fullSchema:c.fullSchema,tableNamesMap:c.tableNamesMap,session:b}:{schema:void 0,fullSchema:{},tableNamesMap:{},session:b},this.query={},this._.schema)for(let[d,e]of Object.entries(this._.schema))this.query[d]=new hx(c.fullSchema,this._.schema,this._.tableNamesMap,c.fullSchema[d],e,a,b)}static [y]="PgDatabase";query;$with=(a,b)=>{let c=this;return{as:d=>("function"==typeof d&&(d=d(new hq(c.dialect))),new Proxy(new V(d.getSQL(),b??("getSelectedFields"in d?d.getSelectedFields()??{}:{}),a,!0),new hc({alias:a,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}};$count(a,b){return new hw({source:a,filters:b,session:this.session})}with(...a){let b=this;return{select:function(c){return new hf({fields:c??void 0,session:b.session,dialect:b.dialect,withList:a})},selectDistinct:function(c){return new hf({fields:c??void 0,session:b.session,dialect:b.dialect,withList:a,distinct:!0})},selectDistinctOn:function(c,d){return new hf({fields:d??void 0,session:b.session,dialect:b.dialect,withList:a,distinct:{on:c}})},update:function(c){return new hr(c,b.session,b.dialect,a)},insert:function(c){return new ht(c,b.session,b.dialect,a)},delete:function(c){return new hv(c,b.session,b.dialect,a)}}}select(a){return new hf({fields:a??void 0,session:this.session,dialect:this.dialect})}selectDistinct(a){return new hf({fields:a??void 0,session:this.session,dialect:this.dialect,distinct:!0})}selectDistinctOn(a,b){return new hf({fields:b??void 0,session:this.session,dialect:this.dialect,distinct:{on:a}})}update(a){return new hr(a,this.session,this.dialect)}insert(a){return new ht(a,this.session,this.dialect)}delete(a){return new hv(a,this.session,this.dialect)}refreshMaterializedView(a){return new hA(a,this.session,this.dialect)}authToken;execute(a){let b="string"==typeof a?ap.raw(a):a.getSQL(),c=this.dialect.sqlToQuery(b),d=this.session.prepareQuery(c,void 0,void 0,!1);return new hz(()=>d.execute(void 0,this.authToken),b,c,a=>d.mapResult(a,!0))}transaction(a,b){return this.session.transaction(a,b)}}class hC{constructor(a){this.query=a}authToken;getQuery(){return this.query}mapResult(a,b){return a}setToken(a){return this.authToken=a,this}static [y]="PgPreparedQuery";joinsNotNullableMap}class hD{constructor(a){this.dialect=a}static [y]="PgSession";execute(a,b){return W.startActiveSpan("drizzle.operation",()=>W.startActiveSpan("drizzle.prepareQuery",()=>this.prepareQuery(this.dialect.sqlToQuery(a),void 0,void 0,!1)).setToken(b).execute(void 0,b))}all(a){return this.prepareQuery(this.dialect.sqlToQuery(a),void 0,void 0,!1).all()}async count(a,b){return Number((await this.execute(a,b))[0].count)}}class hE extends hB{constructor(a,b,c,d=0){super(a,b,c),this.schema=c,this.nestedIndex=d}static [y]="PgTransaction";rollback(){throw new gG}getTransactionConfigSQL(a){let b=[];return a.isolationLevel&&b.push(`isolation level ${a.isolationLevel}`),a.accessMode&&b.push(a.accessMode),"boolean"==typeof a.deferrable&&b.push(a.deferrable?"deferrable":"not deferrable"),ap.raw(b.join(" "))}setTransaction(a){return this.session.execute(ap`set transaction ${this.getTransactionConfigSQL(a)}`)}}let hF={arrayMode:!1,fullResults:!0},hG={arrayMode:!0,fullResults:!0};class hH extends hC{constructor(a,b,c,d,e,f){super(b),this.client=a,this.logger=c,this.fields=d,this._isResponseInArrayMode=e,this.customResultMapper=f}static [y]="NeonHttpPreparedQuery";async execute(a={},b=this.authToken){let c=ar(this.query.params,a);this.logger.logQuery(this.query.sql,c);let{fields:d,client:e,query:f,customResultMapper:g}=this;if(!d&&!g)return e(f.sql,c,void 0===b?hF:{...hF,authToken:b});let h=await e(f.sql,c,void 0===b?hG:{...hG,authToken:b});return this.mapResult(h)}mapResult(a){if(!this.fields&&!this.customResultMapper)return a;let b=a.rows;return this.customResultMapper?this.customResultMapper(b):b.map(a=>(function(a,b,c){let d={},e=a.reduce((a,{path:e,field:f},g)=>{let h;h=z(f,B)?f:z(f,ak)?f.decoder:f.sql.decoder;let i=a;for(let[a,j]of e.entries())if(a<e.length-1)j in i||(i[j]={}),i=i[j];else{let a=b[g],k=i[j]=null===a?null:h.mapFromDriverValue(a);if(c&&z(f,B)&&2===e.length){let a=e[0];a in d?"string"==typeof d[a]&&d[a]!==f.table[C]&&(d[a]=!1):d[a]=null===k&&f.table[C]}}return a},{});if(c&&Object.keys(d).length>0)for(let[a,b]of Object.entries(d))"string"!=typeof b||c[b]||(e[a]=null);return e})(this.fields,a,this.joinsNotNullableMap))}all(a={}){let b=ar(this.query.params,a);return this.logger.logQuery(this.query.sql,b),this.client(this.query.sql,b,void 0===this.authToken?hF:{...hF,authToken:this.authToken}).then(a=>a.rows)}values(a={},b){let c=ar(this.query.params,a);return this.logger.logQuery(this.query.sql,c),this.client(this.query.sql,c,{arrayMode:!0,fullResults:!0,authToken:b}).then(a=>a.rows)}isResponseInArrayMode(){return this._isResponseInArrayMode}}class hI extends hD{constructor(a,b,c,d={}){super(b),this.client=a,this.schema=c,this.options=d,this.logger=d.logger??new gt}static [y]="NeonHttpSession";logger;prepareQuery(a,b,c,d,e){return new hH(this.client,a,this.logger,b,d,e)}async batch(a){let b=[],c=[];for(let d of a){let a=d._prepare(),e=a.getQuery();b.push(a),c.push(this.client(e.sql,e.params,{fullResults:!0,arrayMode:a.isResponseInArrayMode()}))}return(await this.client.transaction(c,hG)).map((a,c)=>b[c].mapResult(a,!0))}async query(a,b){return this.logger.logQuery(a,b),await this.client(a,b,{arrayMode:!0,fullResults:!0})}async queryObjects(a,b){return this.client(a,b,{arrayMode:!1,fullResults:!0})}async count(a,b){return Number((await this.execute(a,b)).rows[0].count)}async transaction(a,b={}){throw Error("No transactions support in neon-http driver")}}class hJ extends null{static [y]=null;async transaction(a){throw Error("No transactions support in neon-http driver")}}class hK{constructor(a,b,c={}){this.client=a,this.dialect=b,this.options=c,this.initMappers()}static [y]="NeonHttpDriver";createSession(a){return new hI(this.client,this.dialect,a,{logger:this.options.logger})}initMappers(){gq.setTypeParser(gq.builtins.TIMESTAMPTZ,a=>a),gq.setTypeParser(gq.builtins.TIMESTAMP,a=>a),gq.setTypeParser(gq.builtins.DATE,a=>a),gq.setTypeParser(gq.builtins.INTERVAL,a=>a)}}function hL(a,b,c,d){return new Proxy(a,{get(a,e){let f=a[e];return"function"!=typeof f&&("object"!=typeof f||null===f)?f:d?hL(f,b,c):"query"===e?hL(f,b,c,!0):new Proxy(f,{apply(a,d,f){let g=a.call(d,...f);return"object"==typeof g&&null!==g&&"setToken"in g&&"function"==typeof g.setToken&&g.setToken(b),c(a,e,g)}})}})}class hM extends hB{static [y]="NeonHttpDatabase";$withAuth(a){return this.authToken=a,hL(this,a,(b,c,d)=>"with"===c?hL(d,a,(a,b,c)=>c):d)}async batch(a){return this.session.batch(a)}}function hN(a,b={}){let c,d,e=new hb({casing:b.casing});if(!0===b.logger?c=new gs:!1!==b.logger&&(c=b.logger),b.schema){let a=function(a,b){1===Object.keys(a).length&&"default"in a&&!z(a.default,ae)&&(a=a.default);let c={},d={},e={};for(let[f,g]of Object.entries(a))if(z(g,ae)){let a=ag(g),b=d[a];for(let d of(c[a]=f,e[f]={tsName:f,dbName:g[ae.Symbol.Name],schema:g[ae.Symbol.Schema],columns:g[ae.Symbol.Columns],relations:b?.relations??{},primaryKey:b?.primaryKey??[]},Object.values(g[ae.Symbol.Columns])))d.primary&&e[f].primaryKey.push(d);let h=g[ae.Symbol.ExtraConfigBuilder]?.(g[ae.Symbol.ExtraConfigColumns]);if(h)for(let a of Object.values(h))z(a,gH)&&e[f].primaryKey.push(...a.columns)}else if(z(g,g6)){let a,f=ag(g.table),h=c[f];for(let[c,i]of Object.entries(g.config(b(g.table))))if(h){let b=e[h];b.relations[c]=i,a&&b.primaryKey.push(...a)}else f in d||(d[f]={relations:{},primaryKey:a}),d[f].relations[c]=i}return{tables:e,tableNamesMap:c}}(b.schema,g9);d={fullSchema:b.schema,schema:a.tables,tableNamesMap:a.tableNamesMap}}let f=new hK(a,e,{logger:c}).createSession(d),g=new hM(e,f,d);return g.$client=a,g}function hO(...a){if("string"==typeof a[0])return hN(gi(a[0]),a[1]);if(function(a){if("object"!=typeof a||null===a||"Object"!==a.constructor.name)return!1;if("logger"in a){let b=typeof a.logger;return"boolean"===b||"object"===b&&"function"==typeof a.logger.logQuery||"undefined"===b}if("schema"in a){let b=typeof a.logger;return"object"===b||"undefined"===b}if("casing"in a){let b=typeof a.logger;return"string"===b||"undefined"===b}if("mode"in a)return"default"===a.mode&&"planetscale"===a.mode&&void 0===a.mode;if("connection"in a){let b=typeof a.connection;return"string"===b||"object"===b||"undefined"===b}if("client"in a){let b=typeof a.client;return"object"===b||"function"===b||"undefined"===b}return 0===Object.keys(a).length}(a[0])){let{connection:b,client:c,...d}=a[0];if(c)return hN(c,d);if("object"==typeof b){let{connectionString:a,...c}=b;return hN(gi(a,c),d)}return hN(gi(b),d)}return hN(a[0],a[1])}(hO||(hO={})).mock=function(a){return hN({},a)};let hP=hO(gi(process.env.DATABASE_URL||"postgresql://user:pass@localhost/db"));class hQ{async createGeneration(a){let[b]=await hP.insert(eq).values(a).returning();return b}async updateGeneration(a,b){let[c]=await hP.update(eq).set(b).where(gK(eq.id,a)).returning();return c}async getGeneration(a){let[b]=await hP.select().from(eq).where(gK(eq.id,a));return b||null}async listGenerations(a=50){return await hP.select().from(eq).orderBy(eq.createdAt).limit(a)}}class hR{async createGeneration(a){let b={id:`gen_${this.nextId++}`,userId:null,createdAt:new Date,prompt:a.prompt,originalImageUrl:a.originalImageUrl||null,generatedImageUrl:a.generatedImageUrl,model:a.model||"nano-banana",dimensions:a.dimensions||"1024x1024",style:a.style||"realistic",status:a.status,metadata:a.metadata||null};return this.generations.set(b.id,b),b}async updateGeneration(a,b){let c=this.generations.get(a);if(!c)throw Error("Generation not found");let d={...c,...b};return this.generations.set(a,d),d}async getGeneration(a){return this.generations.get(a)||null}async listGenerations(a=50){return Array.from(this.generations.values()).slice(0,a)}constructor(){this.generations=new Map,this.nextId=1}}let hS=process.env.DATABASE_URL&&"postgresql://user:pass@localhost/db"!==process.env.DATABASE_URL?new hQ:new hR;async function hT(a){try{let b=await a.json(),c=er.parse(b),d=await hS.createGeneration({prompt:c.prompt,originalImageUrl:c.originalImageUrl||null,model:"hidream",dimensions:c.dimensions||"1024x1024",style:c.style||"realistic",status:"pending",generatedImageUrl:"",metadata:{}}),e=await fetch("https://nano-gpt.com/v1/images/generations",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${process.env.NANO_GPT_API_KEY||"demo-key"}`},body:JSON.stringify({model:"hidream",prompt:c.prompt,image:c.originalImageUrl,width:parseInt(c.dimensions?.split("x")[0]||"1024"),height:parseInt(c.dimensions?.split("x")[1]||"1024"),style:c.style,n:1})});if(!e.ok)throw await hS.updateGeneration(d.id,{status:"failed",metadata:{error:`API request failed: ${e.status}`}}),Error(`API request failed: ${e.status}`);let f=await e.json(),g=f.data?.[0]?.url||"",h=await hS.updateGeneration(d.id,{status:"completed",generatedImageUrl:g,metadata:{apiResponse:f,cost:f.usage?.total_cost||"0.01"}});return x.NextResponse.json(h)}catch(b){let a=b instanceof Error?b.message:"Unknown error";return x.NextResponse.json({error:"Generation failed",message:a},{status:500})}}let hU=new h.AppRouteRouteModule({definition:{kind:i.RouteKind.APP_ROUTE,page:"/api/generate-image/route",pathname:"/api/generate-image",filename:"route",bundlePath:"app/api/generate-image/route"},distDir:".next",projectDir:"",resolvedPagePath:"/home/runner/workspace/app/api/generate-image/route.ts",nextConfigOutput:"standalone",userland:g}),{workAsyncStorage:hV,workUnitAsyncStorage:hW,serverHooks:hX}=hU;function hY(){return(0,j.patchFetch)({workAsyncStorage:hV,workUnitAsyncStorage:hW})}async function hZ(a,b,c){var d;let e="/api/generate-image/route";"/index"===e&&(e="/");let f=await hU.prepare(a,b,{srcPage:e,multiZoneDraftMode:"false"});if(!f)return b.statusCode=400,b.end("Bad Request"),null==c.waitUntil||c.waitUntil.call(c,Promise.resolve()),null;let{buildId:g,params:h,nextConfig:j,isDraftMode:x,prerenderManifest:y,routerServerContext:z,isOnDemandRevalidate:A,revalidateOnlyGenerated:B,resolvedPathname:C}=f,D=(0,m.normalizeAppPath)(e),E=!!(y.dynamicRoutes[D]||y.routes[C]);if(E&&!x){let a=!!y.routes[C],b=y.dynamicRoutes[D];if(b&&!1===b.fallback&&!a)throw new v.NoFallbackError}let F=null;!E||hU.isDev||x||(F="/index"===(F=C)?"/":F);let G=!0===hU.isDev||!E,H=E&&!G,I=a.method||"GET",J=(0,l.getTracer)(),K=J.getActiveScopeSpan(),L={params:h,prerenderManifest:y,renderOpts:{experimental:{dynamicIO:!!j.experimental.dynamicIO,authInterrupts:!!j.experimental.authInterrupts},supportsDynamicResponse:G,incrementalCache:(0,k.getRequestMeta)(a,"incrementalCache"),cacheLifeProfiles:null==(d=j.experimental)?void 0:d.cacheLife,isRevalidate:H,waitUntil:c.waitUntil,onClose:a=>{b.on("close",a)},onAfterTaskError:void 0,onInstrumentationRequestError:(b,c,d)=>hU.onRequestError(a,b,d,z)},sharedContext:{buildId:g}},M=new n.NodeNextRequest(a),N=new n.NodeNextResponse(b),O=o.NextRequestAdapter.fromNodeNextRequest(M,(0,o.signalFromNodeResponse)(b));try{let d=async c=>hU.handle(O,L).finally(()=>{if(!c)return;c.setAttributes({"http.status_code":b.statusCode,"next.rsc":!1});let d=J.getRootSpanAttributes();if(!d)return;if(d.get("next.span_type")!==p.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${d.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let e=d.get("next.route");if(e){let a=`${I} ${e}`;c.setAttributes({"next.route":e,"http.route":e,"next.span_name":a}),c.updateName(a)}else c.updateName(`${I} ${a.url}`)}),f=async f=>{var g,h;let l=async({previousCacheEntry:g})=>{try{if(!(0,k.getRequestMeta)(a,"minimalMode")&&A&&B&&!g)return b.statusCode=404,b.setHeader("x-nextjs-cache","REVALIDATED"),b.end("This page could not be found"),null;let e=await d(f);a.fetchMetrics=L.renderOpts.fetchMetrics;let h=L.renderOpts.pendingWaitUntil;h&&c.waitUntil&&(c.waitUntil(h),h=void 0);let i=L.renderOpts.collectedTags;if(!E)return await (0,r.I)(M,N,e,L.renderOpts.pendingWaitUntil),null;{let a=await e.blob(),b=(0,s.toNodeOutgoingHttpHeaders)(e.headers);i&&(b[u.NEXT_CACHE_TAGS_HEADER]=i),!b["content-type"]&&a.type&&(b["content-type"]=a.type);let c=void 0!==L.renderOpts.collectedRevalidate&&!(L.renderOpts.collectedRevalidate>=u.INFINITE_CACHE)&&L.renderOpts.collectedRevalidate,d=void 0===L.renderOpts.collectedExpire||L.renderOpts.collectedExpire>=u.INFINITE_CACHE?void 0:L.renderOpts.collectedExpire;return{value:{kind:w.CachedRouteKind.APP_ROUTE,status:e.status,body:Buffer.from(await a.arrayBuffer()),headers:b},cacheControl:{revalidate:c,expire:d}}}}catch(b){throw(null==g?void 0:g.isStale)&&await hU.onRequestError(a,b,{routerKind:"App Router",routePath:e,routeType:"route",revalidateReason:(0,q.c)({isRevalidate:H,isOnDemandRevalidate:A})},z),b}},m=await hU.handleResponse({req:a,nextConfig:j,cacheKey:F,routeKind:i.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:y,isRoutePPREnabled:!1,isOnDemandRevalidate:A,revalidateOnlyGenerated:B,responseGenerator:l,waitUntil:c.waitUntil});if(!E)return null;if((null==m||null==(g=m.value)?void 0:g.kind)!==w.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==m||null==(h=m.value)?void 0:h.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});(0,k.getRequestMeta)(a,"minimalMode")||b.setHeader("x-nextjs-cache",A?"REVALIDATED":m.isMiss?"MISS":m.isStale?"STALE":"HIT"),x&&b.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let n=(0,s.fromNodeOutgoingHttpHeaders)(m.value.headers);return(0,k.getRequestMeta)(a,"minimalMode")&&E||n.delete(u.NEXT_CACHE_TAGS_HEADER),!m.cacheControl||b.getHeader("Cache-Control")||n.get("Cache-Control")||n.set("Cache-Control",(0,t.getCacheControlHeader)(m.cacheControl)),await (0,r.I)(M,N,new Response(m.value.body,{headers:n,status:m.value.status||200})),null};K?await f(K):await J.withPropagatedContext(a.headers,()=>J.trace(p.BaseServerSpan.handleRequest,{spanName:`${I} ${a.url}`,kind:l.SpanKind.SERVER,attributes:{"http.method":I,"http.target":a.url}},f))}catch(b){if(K||b instanceof v.NoFallbackError||await hU.onRequestError(a,b,{routerKind:"App Router",routePath:D,routeType:"route",revalidateReason:(0,q.c)({isRevalidate:H,isOnDemandRevalidate:A})}),E)throw b;return await (0,r.I)(M,N,new Response(null,{status:500})),null}}},4870:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6439:a=>{"use strict";a.exports=require("next/dist/shared/lib/no-fallback-error.external")},6487:()=>{},8335:()=>{},9294:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-async-storage.external.js")}};var b=require("../../../webpack-runtime.js");b.C(a);var c=b.X(0,[985,55],()=>b(b.s=3578));module.exports=c})();